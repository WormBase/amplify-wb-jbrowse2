"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[9790,3990],{89790:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var o=r(41867),n=r(3762),s=r(35421),i=r(90872),a=r(47192),l=r(97202),c=r(68367),d=r(56762),m=r(2885),u=r(13536),h=r(62158),x=r(51388),g=r(70728),p=r(90947),f=r(10034),b=r(30340),j=r(24728),v=r(23990),Z=r(80838);const k=(0,a.ZL)()((e=>({controls:{position:"absolute",borderRight:"1px solid ".concat(e.palette.divider),borderBottom:"1px solid ".concat(e.palette.divider),left:0,top:0}}))),C=(0,n.observer)((function(e){let{model:t}=e;const{classes:r}=k(),[n,s]=(0,o.useState)(null);return(0,Z.jsxs)("div",{className:r.controls,children:[(0,Z.jsx)(c.Z,{onClick:t.zoomOutButton,title:t.lockedFitToWindow?"unlock to zoom out":"zoom out",disabled:t.atMaxBpPerPx||t.lockedFitToWindow,children:(0,Z.jsx)(m.Z,{})}),(0,Z.jsx)(c.Z,{onClick:t.zoomInButton,disabled:t.atMinBpPerPx,title:"zoom in",children:(0,Z.jsx)(u.Z,{})}),(0,Z.jsx)(c.Z,{onClick:t.rotateCounterClockwiseButton,title:"rotate counter-clockwise",children:(0,Z.jsx)(h.Z,{})}),(0,Z.jsx)(c.Z,{onClick:t.rotateClockwiseButton,title:"rotate clockwise",children:(0,Z.jsx)(x.Z,{})}),(0,Z.jsx)(c.Z,{onClick:t.toggleFitToWindowLock,title:t.lockedFitToWindow?"locked model to window size":"unlocked model to zoom further",disabled:t.tooSmallToLock,children:t.lockedFitToWindow?(0,Z.jsx)(p.Z,{}):(0,Z.jsx)(g.Z,{})}),(0,Z.jsx)(c.Z,{onClick:e=>s(e.currentTarget),children:(0,Z.jsx)(b.Z,{})}),t.hideTrackSelectorButton?null:(0,Z.jsx)(c.Z,{onClick:t.activateTrackSelector,title:"Open track selector","data-testid":"circular_track_select",children:(0,Z.jsx)(j.GD,{})}),n?(0,Z.jsx)(d.Z,{anchorEl:n,menuItems:[{label:"Export SVG",icon:f.Z,onClick:()=>{(0,i.getSession)(t).queueDialog((e=>[v.default,{model:t,handleClose:e}]))}}],onMenuItemClick:(e,t)=>{t(),s(null)},open:Boolean(n),onClose:()=>s(null)}):null]})}));var y=r(47500),S=r(45294),w=r(23801);const z=(0,a.ZL)()((e=>({importFormContainer:{padding:e.spacing(6)}}))),W=(0,n.observer)((e=>{let{model:t}=e;const{classes:r}=z(),n=(0,i.getSession)(t),{error:a}=t,{assemblyNames:l,assemblyManager:c}=n,[d,m]=(0,o.useState)(l[0]),u=c.get(d),h=l.length?null===u||void 0===u?void 0:u.error:"No configured assemblies",x=(null===u||void 0===u?void 0:u.regions)||[],g=h||a;return(0,Z.jsxs)(y.Z,{className:r.importFormContainer,children:[g?(0,Z.jsx)(S.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:(0,Z.jsx)(S.ZP,{item:!0,children:(0,Z.jsx)(s.ErrorMessage,{error:g})})}):null,(0,Z.jsxs)(S.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,Z.jsx)(S.ZP,{item:!0,children:(0,Z.jsx)(s.AssemblySelector,{onChange:e=>{t.setError(void 0),m(e)},session:n,selected:d})}),(0,Z.jsx)(S.ZP,{item:!0,children:(0,Z.jsx)(w.Z,{disabled:!(null!==x&&void 0!==x&&x.length),onClick:()=>{t.setError(void 0),t.setDisplayedRegions(x)},variant:"contained",color:"primary",children:x.length||g?"Open":"Loading..."})})]})]})})),M=(0,a.ZL)()((e=>({root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},scroller:{overflow:"auto"}}))),R=(0,n.observer)((e=>{let{model:t}=e;return(0,Z.jsxs)(Z.Fragment,{children:[t.staticSlices.map((e=>(0,Z.jsx)(l.Z,{model:t,slice:e},(0,i.assembleLocString)(e.region.elided?e.region.regions[0]:e.region)))),t.tracks.map((e=>{const r=e.displays[0];return(0,Z.jsx)(r.RenderingComponent,{display:r,view:t},r.id)}))]})})),T=(0,n.observer)((e=>{let{model:t}=e;const r=!!t.displayedRegions.length&&!!t.figureWidth&&!!t.figureHeight&&t.initialized,o=!r&&!t.disableImportForm,n=r&&!o;return(0,Z.jsx)(Z.Fragment,{children:o||t.error?(0,Z.jsx)(W,{model:t}):n?(0,Z.jsx)(L,{model:t}):null})})),L=(0,n.observer)((function(e){let{model:t}=e;const{width:r,height:o,id:n,offsetRadians:i,centerXY:a,figureWidth:l,figureHeight:c,hideVerticalResizeHandle:d}=t,{classes:m}=M();return(0,Z.jsxs)("div",{className:m.root,style:{width:r,height:o},"data-testid":n,children:[(0,Z.jsx)("div",{className:m.scroller,style:{width:r,height:o},children:(0,Z.jsx)("svg",{style:{transform:"rotate(".concat(i,"rad)"),transition:"transform 0.5s",transformOrigin:a.map((e=>"".concat(e,"px"))).join(" "),position:"absolute",left:0,top:0},width:l,height:c,children:(0,Z.jsx)("g",{transform:"translate(".concat(a,")"),children:(0,Z.jsx)(R,{model:t})})})}),(0,Z.jsx)(C,{model:t}),d?null:(0,Z.jsx)(s.ResizeHandle,{onDrag:t.resizeHeight,style:{height:3,position:"absolute",bottom:0,left:0,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})]})})),P=T},23990:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var o=r(41867),n=r(93764),s=r(51590),i=r(47409),a=r(49133),l=r(59231),c=r(96614),d=r(83171),m=r(27768),u=r(23801),h=r(35421),x=r(90872),g=r(80838);function p(){return(0,g.jsxs)("div",{children:[(0,g.jsx)(n.Z,{size:20,style:{marginRight:20}}),(0,g.jsx)(s.Z,{display:"inline",children:"Creating SVG"})]})}function f(e,t){return(0,x.useLocalStorage)("svg-"+e,t)}function b(e){let{model:t,handleClose:r}=e;const n=(0,x.getSession)(t),b="undefined"!==typeof OffscreenCanvas,[j,v]=(0,o.useState)(b),[Z,k]=(0,o.useState)(!1),[C,y]=(0,o.useState)(),[S,w]=f("file","jbrowse.svg"),[z,W]=f("theme",n.themeName||"default");return(0,g.jsxs)(h.Dialog,{open:!0,onClose:r,title:"Export SVG",children:[(0,g.jsxs)(i.Z,{children:[C?(0,g.jsx)(h.ErrorMessage,{error:C}):Z?(0,g.jsx)(p,{}):null,(0,g.jsx)(a.Z,{helperText:"filename",value:S,onChange:e=>w(e.target.value)}),(0,g.jsx)("br",{}),n.allThemes?(0,g.jsx)(a.Z,{select:!0,label:"Theme",value:z,onChange:e=>W(e.target.value),children:Object.entries(n.allThemes()).map((e=>{let[t,r]=e;return(0,g.jsx)(l.Z,{value:t,children:r.name||"(Unknown name)"},t)}))}):null,b?(0,g.jsx)(c.Z,{control:(0,g.jsx)(d.Z,{checked:j,onChange:()=>v((e=>!e))}),label:"Rasterize canvas based tracks? File may be much larger if this is turned off"}):(0,g.jsx)(s.Z,{children:"Note: rasterizing layers not yet supported in this browser, so SVG size may be large"})]}),(0,g.jsxs)(m.Z,{children:[(0,g.jsx)(u.Z,{variant:"contained",color:"secondary",onClick:()=>r(),children:"Cancel"}),(0,g.jsx)(u.Z,{variant:"contained",color:"primary",type:"submit",onClick:async()=>{k(!0),y(void 0);try{await t.exportSvg({rasterizeLayers:j,filename:S,themeName:z}),r()}catch(e){console.error(e),y(e),k(!1)}},children:"Submit"})]})]})}},97202:(e,t,r)=>{r.d(t,{Z:()=>x});r(41867);var o=r(3762),n=r(90872),s=r(71472),i=r(17280),a=r(47192),l=r(80838);const c=(0,a.ZL)()({rulerLabel:{fontSize:"0.8rem",fontWeight:500,lineHeight:1.6,letterSpacing:"0.0075em"}});function d(e,t,r,o){e.flipped&&([r,o]=[o,r]);const n=e.bpToXY(r,t),s=e.bpToXY(o,t);return["M",...n,"A",t,t,"0",Math.abs(o-r)/e.bpPerRadian>Math.PI?"1":"0","1",...s].join(" ")}const m=(0,o.observer)((function(e){let{model:t,slice:r,region:o}=e;const s=(0,i.Z)(),{radiusPx:a}=t,c=a+1,{endRadians:d,startRadians:m}=r,h=(0,n.polarToCartesian)(c,m),x=(0,n.polarToCartesian)(c,d),g=(d-m)*c,p=d-m>Math.PI?"1":"0",f=(d+m)/2,b="[".concat(Number(o.regions.length).toLocaleString(),"]");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{text:b,view:t,maxWidthPx:g,radians:f,radiusPx:c,title:"".concat(b," more regions"),color:s.palette.text.primary}),(0,l.jsx)("path",{d:["M",...h,"A",c,c,"0",p,"1",...x].join(" "),stroke:s.palette.text.secondary,strokeWidth:2,strokeDasharray:"2,2",fill:"none"})]})})),u=(0,o.observer)((function(e){let{view:t,text:r,maxWidthPx:o,radians:s,radiusPx:i,title:a,color:d}=e;const{classes:m}=c(),u=(0,n.polarToCartesian)(i+5,s);if(!r)return null;if(6.5*r.length<o)return(0,l.jsxs)("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"middle",dominantBaseline:"baseline",transform:"translate(".concat(u,") rotate(").concat((0,n.radToDeg)(s)+90,")"),style:{fill:d},children:[r,(0,l.jsx)("title",{children:a||r})]});if(o>4){return(0,n.radToDeg)(s+t.offsetRadians-Math.PI/2)>=180?(0,l.jsxs)("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"start",dominantBaseline:"middle",transform:"translate(".concat(u,") rotate(").concat((0,n.radToDeg)(s),")"),style:{fill:d},children:[r,(0,l.jsx)("title",{children:a||r})]}):(0,l.jsxs)("text",{x:0,y:0,className:m.rulerLabel,textAnchor:"end",dominantBaseline:"middle",transform:"translate(".concat(u,") rotate(").concat((0,n.radToDeg)(s)+180,")"),style:{fill:d},children:[r,(0,l.jsx)("title",{children:a||r})]})}return null})),h=(0,o.observer)((function(e){let{model:t,slice:r,region:o}=e;const a=(0,i.Z)(),{radiusPx:c}=t,{endRadians:m,startRadians:h}=r,x=(m+h)/2,g=(m-h)*c;let p;const f=(0,n.getSession)(t).assemblyManager.get(o.assemblyName);if(f&&(p=f.getRefNameColor(o.refName)),p)try{p=(0,s.makeContrasting)(p,a.palette.background.paper)}catch(b){p=a.palette.text.primary}else p=a.palette.text.primary;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{text:o.refName,view:t,maxWidthPx:g,radians:x,radiusPx:c,color:p}),(0,l.jsx)("path",{d:d(r,c+1,o.start,o.end),stroke:p,strokeWidth:2,fill:"none"})]})})),x=(0,o.observer)((function(e){let{model:t,slice:r}=e;return r.region.elided?(0,l.jsx)(m,{model:t,region:r.region,slice:r},(0,n.assembleLocString)(r.region.regions[0])):(0,l.jsx)(h,{region:r.region,model:t,slice:r},(0,n.assembleLocString)(r.region))}))},90947:(e,t,r)=>{var o=r(71600);t.Z=void 0;var n=o(r(80337)),s=r(80838),i=(0,n.default)((0,s.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");t.Z=i},70728:(e,t,r)=>{var o=r(71600);t.Z=void 0;var n=o(r(80337)),s=r(80838),i=(0,n.default)((0,s.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");t.Z=i},62158:(e,t,r)=>{var o=r(71600);t.Z=void 0;var n=o(r(80337)),s=r(80838),i=(0,n.default)((0,s.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"}),"RotateLeft");t.Z=i},51388:(e,t,r)=>{var o=r(71600);t.Z=void 0;var n=o(r(80337)),s=r(80838),i=(0,n.default)((0,s.jsx)("path",{d:"M15.55 5.55 11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10l4.55-4.45zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47h2.02zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03zm3.89-2.42 1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48z"}),"RotateRight");t.Z=i},47500:(e,t,r)=>{r.d(t,{Z:()=>k});var o=r(31461),n=r(7896),s=r(41867),i=r(66184),a=r(19092),l=r(88498),c=r(92705),d=r(8380),m=r(35283),u=r(15453),h=r(80838);const x=["className","component","disableGutters","fixed","maxWidth","classes"],g=(0,u.Z)(),p=(0,m.Z)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["maxWidth".concat((0,a.Z)(String(r.maxWidth)))],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),f=e=>(0,d.Z)({props:e,name:"MuiContainer",defaultTheme:g});var b=r(9931),j=r(75693),v=r(90293);const Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=p,useThemeProps:r=f,componentName:d="MuiContainer"}=e,m=t((e=>{let{theme:t,ownerState:r}=e;return(0,n.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!r.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:r}=e;return r.fixed&&Object.keys(t.breakpoints.values).reduce(((e,r)=>{const o=r,n=t.breakpoints.values[o];return 0!==n&&(e[t.breakpoints.up(o)]={maxWidth:"".concat(n).concat(t.breakpoints.unit)}),e}),{})}),(e=>{let{theme:t,ownerState:r}=e;return(0,n.Z)({},"xs"===r.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},r.maxWidth&&"xs"!==r.maxWidth&&{[t.breakpoints.up(r.maxWidth)]:{maxWidth:"".concat(t.breakpoints.values[r.maxWidth]).concat(t.breakpoints.unit)}})})),u=s.forwardRef((function(e,t){const s=r(e),{className:u,component:g="div",disableGutters:p=!1,fixed:f=!1,maxWidth:b="lg"}=s,j=(0,o.Z)(s,x),v=(0,n.Z)({},s,{component:g,disableGutters:p,fixed:f,maxWidth:b}),Z=((e,t)=>{const{classes:r,fixed:o,disableGutters:n,maxWidth:s}=e,i={root:["root",s&&"maxWidth".concat((0,a.Z)(String(s))),o&&"fixed",n&&"disableGutters"]};return(0,c.Z)(i,(e=>(0,l.Z)(t,e)),r)})(v,d);return(0,h.jsx)(m,(0,n.Z)({as:g,ownerState:v,className:(0,i.Z)(Z.root,u),ref:t},j))}));return u}({createStyledComponent:(0,j.ZP)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t["maxWidth".concat((0,b.Z)(String(r.maxWidth)))],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,v.Z)({props:e,name:"MuiContainer"})}),k=Z}}]);
//# sourceMappingURL=9790.515ea4c5.chunk.js.map