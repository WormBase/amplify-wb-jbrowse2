{"version":3,"file":"static/js/9723.ebbe3dec.chunk.js","mappings":"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","sources":["../../../plugins/config/src/FromConfigAdapter/FromConfigAdapter.ts","../../../plugins/config/src/FromConfigRegionsAdapter/FromConfigRegionsAdapter.ts"],"sourcesContent":["import { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport SimpleFeature, {\n  Feature,\n  SimpleFeatureSerialized,\n} from '@jbrowse/core/util/simpleFeature'\nimport { ObservableCreate } from '@jbrowse/core/util/rxjs'\nimport { NoAssemblyRegion } from '@jbrowse/core/util/types'\nimport {\n  AnyConfigurationModel,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { getSubAdapterType } from '@jbrowse/core/data_adapters/dataAdapterCache'\n\n/**\n * Adapter that just returns the features defined in its `features` configuration\n * key, like:\n *   `\"features\": [ { \"refName\": \"ctgA\", \"start\":1, \"end\":20 }, ... ]`\n */\n\nexport default class FromConfigAdapter extends BaseFeatureDataAdapter {\n  protected features: Map<string, Feature[]>\n\n  constructor(\n    conf: AnyConfigurationModel,\n    getSubAdapter?: getSubAdapterType,\n    pluginManager?: PluginManager,\n  ) {\n    super(conf, getSubAdapter, pluginManager)\n    const feats = readConfObject(conf, 'features') as SimpleFeatureSerialized[]\n    this.features = FromConfigAdapter.makeFeatures(feats || [])\n  }\n\n  static makeFeatures(fdata: SimpleFeatureSerialized[]) {\n    const features = new Map<string, Feature[]>()\n    for (const entry of fdata) {\n      if (entry) {\n        const f = this.makeFeature(entry)\n        const refName = f.get('refName') as string\n        let bucket = features.get(refName)\n        if (!bucket) {\n          bucket = []\n          features.set(refName, bucket)\n        }\n\n        bucket.push(f)\n      }\n    }\n\n    // sort the features on each reference sequence by start coordinate\n    for (const refFeatures of features.values()) {\n      refFeatures.sort((a, b) => a.get('start') - b.get('start'))\n    }\n\n    return features\n  }\n\n  static makeFeature(data: SimpleFeatureSerialized) {\n    return new SimpleFeature(data)\n  }\n\n  async getRefNames() {\n    return [...this.features.keys()]\n  }\n\n  async getRefNameAliases() {\n    return [...this.features.values()].map(featureArray => ({\n      refName: featureArray[0].get('refName'),\n      aliases: featureArray[0].get('aliases'),\n    }))\n  }\n\n  getFeatures(region: NoAssemblyRegion) {\n    const { refName, start, end } = region\n\n    return ObservableCreate<Feature>(async observer => {\n      const features = this.features.get(refName) || []\n      for (const f of features) {\n        if (f.get('end') > start && f.get('start') < end) {\n          observer.next(f)\n        }\n      }\n      observer.complete()\n    })\n  }\n\n  freeResources(/* { region } */): void {}\n}\n","import {\n  BaseAdapter,\n  RegionsAdapter,\n} from '@jbrowse/core/data_adapters/BaseAdapter'\nimport {\n  Feature,\n  SimpleFeatureSerialized,\n} from '@jbrowse/core/util/simpleFeature'\nimport {\n  AnyConfigurationModel,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport PluginManager from '@jbrowse/core/PluginManager'\nimport { getSubAdapterType } from '@jbrowse/core/data_adapters/dataAdapterCache'\n\nimport FromConfigAdapter from '../FromConfigAdapter/FromConfigAdapter'\n\n/**\n * Adapter that just returns the features defined in its `features` configuration\n * key, like:\n *   `\"features\": [ { \"refName\": \"ctgA\", \"start\":1, \"end\":20 }, ... ]`\n */\nexport default class FromConfigRegionsAdapter\n  extends BaseAdapter\n  implements RegionsAdapter\n{\n  private features: Map<string, Feature[]>\n\n  constructor(\n    config: AnyConfigurationModel,\n    getSubAdapter?: getSubAdapterType,\n    pluginManager?: PluginManager,\n  ) {\n    super(config, getSubAdapter, pluginManager)\n    const features = readConfObject(\n      config,\n      'features',\n    ) as SimpleFeatureSerialized[]\n    this.features = FromConfigAdapter.makeFeatures(features || [])\n  }\n\n  /**\n   * Get refName, start, and end for all features after collapsing any overlaps\n   */\n  async getRegions() {\n    const regions = []\n\n    // recall: features are stored in this object sorted by start coordinate\n    for (const [refName, features] of this.features) {\n      let currentRegion\n      for (const feature of features) {\n        if (\n          currentRegion &&\n          currentRegion.end >= feature.get('start') &&\n          currentRegion.start <= feature.get('end')\n        ) {\n          currentRegion.end = feature.get('end')\n        } else {\n          if (currentRegion) {\n            regions.push(currentRegion)\n          }\n          currentRegion = {\n            refName,\n            start: feature.get('start'),\n            end: feature.get('end'),\n          }\n        }\n      }\n      if (currentRegion) {\n        regions.push(currentRegion)\n      }\n    }\n\n    // sort the regions by refName\n    regions.sort((a, b) => a.refName.localeCompare(b.refName))\n\n    return regions\n  }\n\n  freeResources(/* { region } */): void {}\n}\n"],"names":["FromConfigAdapter","_BaseFeatureDataAdapt","_getRefNames","_getRefNameAliases","_inherits","_super","_createSuper","conf","getSubAdapter","pluginManager","_this","_classCallCheck","call","features","feats","readConfObject","makeFeatures","_createClass","key","value","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","abrupt","_toConsumableArray","this","keys","stop","apply","arguments","_callee2","_context2","values","map","featureArray","refName","get","aliases","region","_ref","_this2","start","end","ObservableCreate","_x","_callee3","observer","_iterator","_step","f","_context3","_createForOfIteratorHelper","s","n","done","err","e","complete","fdata","_step2","Map","_iterator2","entry","makeFeature","bucket","set","push","_step3","_iterator3","sort","a","b","data","SimpleFeature","BaseFeatureDataAdapter","FromConfigRegionsAdapter","_BaseAdapter","_getRegions","config","regions","_step$value","currentRegion","feature","_slicedToArray","localeCompare","BaseAdapter"],"sourceRoot":""}