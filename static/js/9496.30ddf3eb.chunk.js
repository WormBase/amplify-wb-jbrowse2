"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[9496],{93384:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(68079),a=t(96234),s=t(30969),o=t(53276),l=t(26737),i=t(37574),c=(0,o.ZL)()((function(e){return{resizeBar:{background:e.palette.action.disabledBackground,height:12,position:"relative",overflow:"hidden"},tick:{position:"absolute",height:"100%",pointerEvents:"none",background:e.palette.action.disabled,width:1},hiddenTick:{position:"absolute",height:"100%",width:5}}}));function u(e){var n=e.left,t=e.scrollLeft,r=e.idx,a=e.onDrag,o=e.onMouseDown,u=c().classes,d=(0,s.useCallback)((function(e,n){return a(e,n,r)}),[r,a]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{onDrag:d,onMouseDown:o,vertical:!0,className:u.hiddenTick,style:{left:n-t-2.5}}),(0,i.jsx)("div",{style:{left:n-t},className:u.tick})]})}function d(e){for(var n=e.widths,t=e.setWidths,o=e.checkbox,l=e.scrollLeft,d=void 0===l?0:l,f=c().classes,m=[],h=(0,s.useState)(),b=(0,a.Z)(h,2),x=b[0],p=b[1],v=o?52:0,k=0;k<n.length;k++){var j=n[k];m[k]=j+v,v+=j}return(0,i.jsx)("div",{className:f.resizeBar,children:m.map((function(e,a){return(0,i.jsx)(u,{onMouseDown:function(){p((0,r.Z)(n))},left:a===m.length-1?e-3:e,onDrag:function(e,a,s){var o=(0,r.Z)(n);o[s]=Math.max(x[s]-a,50),t(o)},idx:a,scrollLeft:d},a)}))})}},34298:function(e,n,t){t.d(n,{x:function(){return s}});var r=t(96234),a=t(30969);function s(){var e=(0,a.useRef)(null),n=(0,a.useState)(0),t=(0,r.Z)(n,2),s=t[0],o=t[1];return(0,a.useEffect)((function(){var n=setInterval((function(){var n,t=null===(n=e.current)||void 0===n?void 0:n.querySelector(".MuiDataGrid-virtualScroller");t&&o(t.scrollLeft)}),100);return function(){clearInterval(n)}}),[]),{ref:e,scrollLeft:s}}},69496:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var r=t(30969),a=t(90550),s=t(76149),o=t(53276),l=t(32723),i=t(34795),c=t(33028),u=t(59740),d=t(96234),f=t(622),m=t(59563),h=t(46188),b=t(81073),x=t(38935),p=t(34298),v=t(93384),k=t(37574),j=["assemblyName"],Z=(0,r.lazy)((function(){return t.e(9969).then(t.bind(t,79969))})),w=(0,o.ZL)()((function(){return{link:{cursor:"pointer"}}})),g=(0,a.observer)((function(e){var n=e.model,t=w().classes,a=(0,r.useState)(),s=(0,d.Z)(a,2),o=s[0],g=s[1],y=(0,p.x)(),S=y.ref,N=y.scrollLeft,C=n.bookmarkedRegions,A=n.bookmarksWithValidAssemblies,L=n.selectedAssemblies,D=n.selectedBookmarks,_=(0,b.getSession)(n),B=new Set(L),F=C.filter((function(e){return B.has(e.assemblyName)})).map((function(e,n){var t=e.assemblyName,r=(0,u.Z)(e,j);return(0,c.Z)((0,c.Z)({},e),{},{id:n,assemblyName:t,locString:(0,b.assembleLocString)(r),correspondingObj:e})})),M=(0,r.useState)([40,Math.max((0,b.measureText)("Bookmark link"),(0,b.measureGridWidth)(F.map((function(e){return e.locString})))),Math.max((0,b.measureText)("Label"),(0,b.measureGridWidth)(F.map((function(e){return e.label})))),Math.max((0,b.measureText)("Assembly"),(0,b.measureGridWidth)(F.map((function(e){return e.assemblyName}))))]),T=(0,d.Z)(M,2),z=T[0],E=T[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{ref:S,children:[(0,k.jsx)(v.Z,{widths:z,setWidths:E,scrollLeft:N}),(0,k.jsx)(m._$,{autoHeight:!0,density:"compact",rows:F,columns:[(0,c.Z)((0,c.Z)({},h.n),{},{width:z[0]}),{field:"locString",headerName:"Bookmark link",width:z[1],renderCell:function(e){var r=e.value,a=e.row;return(0,k.jsx)(f.Z,{className:t.link,href:"#",onClick:function(){var e=(0,i.Z)((0,l.Z)().mark((function e(t){var s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s=_.views,e.next=4,(0,x.D6)(r,a.assemblyName,s,n);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),children:r})}},{field:"label",headerName:"Label",width:z[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:z[3]}],onCellDoubleClick:function(e){var n=e.row;return g(n)},processRowUpdate:function(e){var t=F[e.id];return n.updateBookmarkLabel(t,e.label),e},onProcessRowUpdateError:function(e){return _.notify(e.message,"error")},checkboxSelection:!0,onRowSelectionModelChange:function(e){A.length>0&&n.setSelectedBookmarks(e.map((function(e){return(0,c.Z)({},F[e])})))},rowSelectionModel:D.map((function(e){return e.id})),disableRowSelectionOnClick:!0})]}),o?(0,k.jsx)(r.Suspense,{fallback:(0,k.jsx)(r.Fragment,{}),children:(0,k.jsx)(Z,{onClose:function(){return g(void 0)},model:n,dialogRow:o})}):null]})})),y=g,S=t(72097),N=t(10814),C=(0,r.lazy)((function(){return t.e(2047).then(t.bind(t,82047))}));var A=function(e){var n=e.model,t=(0,r.useState)(!1),a=(0,d.Z)(t,2),s=a[0],o=a[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S.Z,{startIcon:(0,k.jsx)(N.Z,{}),"aria-label":"clear bookmarks",onClick:function(){return o(!0)},children:"Delete"}),s?(0,k.jsx)(r.Suspense,{fallback:(0,k.jsx)(r.Fragment,{}),children:(0,k.jsx)(C,{model:n,onClose:function(){return o(!1)}})}):null]})},L=t(89364),D=(0,r.lazy)((function(){return t.e(8856).then(t.bind(t,68856))})),_=(0,a.observer)((function(e){var n=e.model,t=(0,r.useState)(!1),a=(0,d.Z)(t,2),s=a[0],o=a[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S.Z,{startIcon:(0,k.jsx)(L.Z,{}),onClick:function(){return o(!0)},"data-testid":"export_button",children:"Export"}),s?(0,k.jsx)(r.Suspense,{fallback:(0,k.jsx)(r.Fragment,{}),children:(0,k.jsx)(D,{onClose:function(){return o(!1)},model:n})}):null]})})),B=t(32207),F=(0,r.lazy)((function(){return Promise.all([t.e(9313),t.e(2419)]).then(t.bind(t,12419))})),M=(0,a.observer)((function(e){var n=e.model,t=(0,r.useState)(!1),a=(0,d.Z)(t,2),s=a[0],o=a[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S.Z,{startIcon:(0,k.jsx)(B.Z,{}),onClick:function(){return o(!0)},children:"Import"}),s?(0,k.jsx)(r.Suspense,{fallback:(0,k.jsx)(r.Fragment,{}),children:(0,k.jsx)(F,{onClose:function(){return o(!1)},model:n})}):null]})})),T=t(68079),z=t(87535),E=t(16631),I=t(70983),W=t(33656),R=t(2689),V=t(88876),G=t(86008),P=(0,a.observer)((function(e){var n=e.model,t=n.validAssemblies,r=n.selectedAssemblies,a=0===t.size,s="Select assemblies",o="select-assemblies-label",l=new Set(r),i=(0,T.Z)(t).every((function(e){return l.has(e)}));return(0,k.jsxs)(z.Z,{disabled:a,fullWidth:!0,children:[(0,k.jsx)(E.Z,{id:o,children:s}),(0,k.jsxs)(I.Z,{labelId:o,multiple:!0,value:r,onChange:function(e){return n.setSelectedAssemblies((0,T.Z)(e.target.value))},input:(0,k.jsx)(W.Z,{label:s}),renderValue:function(e){return e.join(", ")},children:[(0,k.jsxs)(R.Z,{value:"all",children:[(0,k.jsx)(V.Z,{checked:i,indeterminate:!i&&r.length>0,onChange:function(e){n.setSelectedAssemblies(e.target.checked?void 0:[]),e.stopPropagation()}}),(0,k.jsx)(G.Z,{primary:"Select all"})]}),(0,T.Z)(t).map((function(e){return(0,k.jsxs)(R.Z,{value:e,children:[(0,k.jsx)(V.Z,{checked:r.includes(e)}),(0,k.jsx)(G.Z,{primary:e})]},e)}))]})]})})),O=t(22417),U=(0,r.lazy)((function(){return t.e(4271).then(t.bind(t,94271))}));var q=function(e){var n=e.model,t=(0,r.useState)(!1),a=(0,d.Z)(t,2),s=a[0],o=a[1];return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S.Z,{startIcon:(0,k.jsx)(O.pt,{}),onClick:function(){return o(!0)},children:"Share"}),s?(0,k.jsx)(r.Suspense,{fallback:(0,k.jsx)(r.Fragment,{}),children:(0,k.jsx)(U,{onClose:function(){return o(!1)},model:n})}):null]})},H=(0,o.ZL)()({card:{marginTop:5}}),J=(0,a.observer)((function(e){var n=e.model,t=H().classes;return n?(0,k.jsxs)("div",{className:t.card,children:[(0,k.jsxs)("div",{children:[(0,k.jsx)(_,{model:n}),(0,k.jsx)(M,{model:n}),(0,k.jsx)(q,{model:n}),(0,k.jsx)(A,{model:n})]}),(0,k.jsxs)(s.Z,{severity:"info",children:["Click and type within the ",(0,k.jsx)("strong",{children:"label"})," field to annotate your bookmark. Double click the ",(0,k.jsx)("strong",{children:"label"})," field to do so within a dialog."]}),(0,k.jsx)(P,{model:n}),(0,k.jsx)(y,{model:n})]}):null}))},38935:function(e,n,t){t.d(n,{C3:function(){return c},D6:function(){return l},JY:function(){return m},cD:function(){return d}});var r=t(32723),a=t(34795),s=t(21918),o=t(81073);function l(e,n,t,r){return i.apply(this,arguments)}function i(){return(i=(0,a.Z)((0,r.Z)().mark((function e(n,t,a,s){var l,i,c,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,o.getSession)(s),e.prev=1,c=a.find((function(e){return e===l.focusedView})),(null===(i=c)||void 0===i?void 0:i.assemblyNames[0])!==t&&(c=a.find((function(e){return"LinearGenomeView"===e.type&&e.assemblyNames[0]===t}))),c||(u="".concat(s.id,"_").concat(t),c=l.addView("LinearGenomeView",{id:u})),e.next=7,c.navToLocString(n,t);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),l.notify("".concat(e.t0),"error");case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function c(e,n){var t=n.selectedBookmarks,r=n.bookmarksWithValidAssemblies,a=0===t.length?r:t;if("BED"===e){var l={};for(var i in a.forEach((function(e){var n=e.label,t=""===n?".":n,r="".concat(e.refName,"\t").concat(e.start,"\t").concat(e.end,"\t").concat(t,"\n");l[e.assemblyName]?l[e.assemblyName].push(r):l[e.assemblyName]=[r]})),l){var c=l[i].reduce((function(e,n){return e+n}),""),u=new Blob([c||""],{type:"text/x-bed;charset=utf-8"}),d="jbrowse_bookmarks_".concat(i,".bed");(0,s.saveAs)(u,d)}}else{var f=a.map((function(e){var n=e.label,t=""===n?".":n,r=(0,o.assembleLocString)(e);return"".concat(e.refName,"\t").concat(e.start+1,"\t").concat(e.end,"\t").concat(t,"\t").concat(e.assemblyName,"\t").concat(r,"\n")})).reduce((function(e,n){return e+n}),"chrom\tstart\tend\tlabel\tassembly_name\tcoord_range\n"),m=new Blob([f||""],{type:"text/tab-separated-values;charset=utf-8"});(0,s.saveAs)(m,"jbrowse_bookmarks.tsv")}}function u(e){var n=0;switch(e.length%4){case 3:n=1;break;case 2:n=2;break;case 0:n=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(n)}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,a.Z)((0,r.Z)().mark((function e(n){var a,s,o,l,i,c,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u(n.replaceAll("-","+").replaceAll("_","/")),e.next=3,Promise.resolve().then(t.t.bind(t,63019,19));case 3:return s=e.sent,o=s.toByteArray,e.next=7,t.e(6700).then(t.t.bind(t,26700,23));case 7:return l=e.sent,i=l.inflate,c=o(a),d=i(c),e.abrupt("return",(new TextDecoder).decode(d));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)((0,r.Z)().mark((function e(n){var a,s,o,l,i,c,u,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(new TextEncoder).encode(n),e.next=3,t.e(6700).then(t.t.bind(t,26700,23));case 3:return s=e.sent,o=s.deflate,e.next=7,Promise.resolve().then(t.t.bind(t,63019,19));case 7:return l=e.sent,i=l.fromByteArray,c=o(a),u=i(c),d=u.indexOf("="),e.abrupt("return",d>0?u.slice(0,d).replaceAll("+","-").replaceAll("/","_"):u.replaceAll("+","-").replaceAll("/","_"));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=9496.30ddf3eb.chunk.js.map