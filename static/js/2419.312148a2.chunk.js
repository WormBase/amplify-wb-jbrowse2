"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[2419],{12419:function(e,n,t){t.r(n);var r,a,o=t(96234),s=t(32723),i=t(34795),c=t(30969),u=t(90550),d=t(81073),l=t(59767),p=t(59071),f=t(59313),m=t(80928),x=t(33359),h=t(50501),Z=t(87006),v=t(96074),b=t(72097),w=t(33528),k=t(84291),g=t(53276),y=t(32207),j=t(23038),S=t(38935),C=t(54299),I=t(37574),N=(0,g.ZL)()((function(e){var n;return{flexItem:{margin:5},expandIcon:{color:(null===(n=e.palette.tertiary)||void 0===n?void 0:n.contrastText)||"#fff"}}}));function A(e,n){return(r=r||(0,i.Z)((0,s.Z)().mark((function e(n,t){var r,a,o,i,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://share.jbrowse.org/api/v1/",r=new URL(n),a=r.searchParams.get("bookmarks"),o=r.searchParams.get("password"),e.next=6,(0,C.h)("".concat(null!==t&&void 0!==t?t:"https://share.jbrowse.org/api/v1/","load"),a||"",o||"");case 6:return i=e.sent,e.t0=JSON,e.next=10,(0,S.cD)(i);case 10:return e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),e.abrupt("return",c.sharedBookmarks);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,n){return(a=a||(0,i.Z)((0,s.Z)().mark((function e(n,t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.openLocation)(n).readFile("utf8");case 2:return r=e.sent,e.abrupt("return",r.split(/\n|\r\n|\r/).filter((function(e){return!!e.trim()})).filter((function(e){return!e.startsWith("#")&&!e.startsWith("track")&&!e.startsWith("browser")})).map((function(e){var n=e.split("\t"),r=(0,o.Z)(n,5),a=r[0],s=r[1],i=r[2],c=r[3],u=r[4];return{assemblyName:null!==u&&void 0!==u?u:t,refName:a,start:+s,end:+i,label:"."===c?void 0:c}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=(0,u.observer)((function(e){var n=e.onClose,t=e.model,r=N().classes,a=(0,c.useState)(),u=(0,o.Z)(a,2),w=u[0],g=u[1],S=(0,c.useState)(),C=(0,o.Z)(S,2),M=C[0],V=C[1],D=(0,c.useState)(""),W=(0,o.Z)(D,2),L=W[0],P=W[1],G=(0,d.getSession)(t),E=(0,d.getSession)(t),B=E.assemblyNames,O=E.shareURL,T=(0,c.useState)(B[0]),U=(0,o.Z)(T,2),F=U[0],J=U[1],_=(0,c.useState)("shareLinkAccordion"),H=(0,o.Z)(_,2),z=H[0],Y=H[1];return(0,I.jsxs)(l.Dialog,{open:!0,onClose:n,maxWidth:"xl",title:"Import bookmarks",children:[(0,I.jsxs)(p.Z,{children:[(0,I.jsxs)(f.Z,{expanded:"shareLinkAccordion"===z,onChange:function(){return Y("shareLinkAccordion")},children:[(0,I.jsx)(m.Z,{expandIcon:(0,I.jsx)(j.Z,{className:r.expandIcon}),children:(0,I.jsx)(x.Z,{children:"Import from share link"})}),(0,I.jsx)(h.Z,{children:(0,I.jsx)(Z.Z,{label:"Enter URL",variant:"outlined",style:{width:"100%"},value:L,onChange:function(e){return P(e.target.value)}})})]}),(0,I.jsxs)(f.Z,{expanded:"fileAccordion"===z,onChange:function(){return Y("fileAccordion")},children:[(0,I.jsx)(m.Z,{expandIcon:(0,I.jsx)(j.Z,{className:r.expandIcon}),children:(0,I.jsx)(x.Z,{children:"Import from file"})}),(0,I.jsxs)(h.Z,{children:[(0,I.jsx)(l.FileSelector,{location:w,setLocation:g,name:"File",description:"Choose a BED or TSV format file to import."}),(0,I.jsx)(k.Z,{onChange:function(e){return J(e)},helperText:"Select the assembly your bookmarks belong to (BED or TSV without assembly column).",session:G,selected:F})]})]}),M?(0,I.jsx)(x.Z,{color:"error",variant:"h6",children:"".concat(M)}):null]}),(0,I.jsxs)(v.Z,{children:[(0,I.jsx)(b.Z,{variant:"contained",color:"secondary",onClick:n,children:"Cancel"}),(0,I.jsx)(b.Z,{className:r.flexItem,"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!w&&!L,startIcon:(0,I.jsx)(y.Z,{}),onClick:(0,i.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!w){e.next=9;break}return e.t0=t,e.next=5,R(w,F);case 5:e.t1=e.sent,e.t0.importBookmarks.call(e.t0,e.t1),e.next=15;break;case 9:if(!L){e.next=15;break}return e.t2=t,e.next=13,A(L,O);case 13:e.t3=e.sent,e.t2.importBookmarks.call(e.t2,e.t3);case 15:n(),e.next=22;break;case 18:e.prev=18,e.t4=e.catch(0),console.error(e.t4),V(e.t4);case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),children:"Import"})]})]})}));n.default=M},54299:function(e,n,t){t.d(n,{h:function(){return x},p:function(){return m}});var r,a,o,s,i=t(32723),c=t(34795),u=t(68079),d=t(38935);var l=function(e,n){return(r=r||(0,c.Z)((0,i.Z)().mark((function e(n,r){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(7923),t.e(6277)]).then(t.t.bind(t,46277,23));case 2:return a=e.sent,e.abrupt("return",a.encrypt(n,r).toString());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},p=function(e,n){return(a=a||(0,c.Z)((0,i.Z)().mark((function e(n,r){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(7923),t.e(6277)]).then(t.t.bind(t,46277,23));case 2:return a=e.sent,e.next=5,t.e(3136).then(t.t.bind(t,33136,23));case 5:return o=e.sent,s=a.decrypt(n,r),e.abrupt("return",s.toString(o));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)};function f(e){try{return JSON.parse(e).message}catch(n){return e}}function m(e,n,t){return(o=o||(0,c.Z)((0,i.Z)().mark((function e(n,t,r){var a,o,s,c,p,m,x;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.JY)(JSON.stringify(n));case 2:return a=e.sent,i=5,o=window.btoa((0,u.Z)(window.crypto.getRandomValues(new Uint8Array(2*i))).map((function(e){return String.fromCharCode(e)})).join("")).replaceAll(/[+/]/g,"").slice(0,i),e.next=6,l(a,o);case 6:return s=e.sent,(c=new FormData).append("session",s),c.append("dateShared","".concat(Date.now())),c.append("referer",r),e.next=13,fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:c});case 13:if((p=e.sent).ok){e.next=19;break}return e.next=17,p.text();case 17:throw m=e.sent,new Error(f(m));case 19:return e.next=21,p.json();case 21:return x=e.sent,e.abrupt("return",{json:x,encryptedSession:s,password:o});case 23:case"end":return e.stop()}var i}),e)})))).apply(this,arguments)}function x(e,n,t,r){return(s=s||(0,c.Z)((0,i.Z)().mark((function e(n,t,r,a){var o,s,c,u,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.split("share-")[1],s="".concat(n,"?sessionId=").concat(encodeURIComponent(o)),e.next=4,fetch(s,{signal:a});case 4:if((c=e.sent).ok){e.next=10;break}return e.next=8,c.text();case 8:throw u=e.sent,new Error(f(u));case 10:return e.next=12,c.json();case 12:return d=e.sent,e.abrupt("return",p(d.session,r));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},23038:function(e,n,t){var r=t(71600);n.Z=void 0;var a=r(t(48035)),o=t(37574),s=(0,a.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");n.Z=s},50501:function(e,n,t){var r=t(7896),a=t(31461),o=t(30969),s=t(87023),i=t(26540),c=t(45971),u=t(17363),d=t(34096),l=t(37574),p=["className"],f=(0,c.ZP)("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(e){return{padding:e.theme.spacing(1,2,2)}})),m=o.forwardRef((function(e,n){var t=(0,u.Z)({props:e,name:"MuiAccordionDetails"}),o=t.className,c=(0,a.Z)(t,p),m=t,x=function(e){var n=e.classes;return(0,i.Z)({root:["root"]},d.s,n)}(m);return(0,l.jsx)(f,(0,r.Z)({className:(0,s.Z)(x.root,o),ref:n,ownerState:m},c))}));n.Z=m},34096:function(e,n,t){t.d(n,{s:function(){return o}});var r=t(62746),a=t(2975);function o(e){return(0,a.Z)("MuiAccordionDetails",e)}var s=(0,r.Z)("MuiAccordionDetails",["root"]);n.Z=s},80928:function(e,n,t){t.d(n,{Z:function(){return g}});var r=t(56666),a=t(31461),o=t(7896),s=t(30969),i=t(87023),c=t(26540),u=t(45971),d=t(17363),l=t(6596),p=t(56325),f=t(62746),m=t(2975);function x(e){return(0,m.Z)("MuiAccordionSummary",e)}var h=(0,f.Z)("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Z=t(37574),v=["children","className","expandIcon","focusVisibleClassName","onClick"],b=(0,u.ZP)(l.Z,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(e){var n,t=e.theme,a=e.ownerState,s={duration:t.transitions.duration.shortest};return(0,o.Z)((n={display:"flex",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],s)},(0,r.Z)(n,"&.".concat(h.focusVisible),{backgroundColor:(t.vars||t).palette.action.focus}),(0,r.Z)(n,"&.".concat(h.disabled),{opacity:(t.vars||t).palette.action.disabledOpacity}),(0,r.Z)(n,"&:hover:not(.".concat(h.disabled,")"),{cursor:"pointer"}),n),!a.disableGutters&&(0,r.Z)({},"&.".concat(h.expanded),{minHeight:64}))})),w=(0,u.ZP)("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:function(e,n){return n.content}})((function(e){var n=e.theme,t=e.ownerState;return(0,o.Z)({display:"flex",flexGrow:1,margin:"12px 0"},!t.disableGutters&&(0,r.Z)({transition:n.transitions.create(["margin"],{duration:n.transitions.duration.shortest})},"&.".concat(h.expanded),{margin:"20px 0"}))})),k=(0,u.ZP)("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:function(e,n){return n.expandIconWrapper}})((function(e){var n=e.theme;return(0,r.Z)({display:"flex",color:(n.vars||n).palette.action.active,transform:"rotate(0deg)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})},"&.".concat(h.expanded),{transform:"rotate(180deg)"})})),g=s.forwardRef((function(e,n){var t=(0,d.Z)({props:e,name:"MuiAccordionSummary"}),r=t.children,u=t.className,l=t.expandIcon,f=t.focusVisibleClassName,m=t.onClick,h=(0,a.Z)(t,v),g=s.useContext(p.Z),y=g.disabled,j=void 0!==y&&y,S=g.disableGutters,C=g.expanded,I=g.toggle,N=(0,o.Z)({},t,{expanded:C,disabled:j,disableGutters:S}),A=function(e){var n=e.classes,t=e.expanded,r=e.disabled,a=e.disableGutters,o={root:["root",t&&"expanded",r&&"disabled",!a&&"gutters"],focusVisible:["focusVisible"],content:["content",t&&"expanded",!a&&"contentGutters"],expandIconWrapper:["expandIconWrapper",t&&"expanded"]};return(0,c.Z)(o,x,n)}(N);return(0,Z.jsxs)(b,(0,o.Z)({focusRipple:!1,disableRipple:!0,disabled:j,component:"div","aria-expanded":C,className:(0,i.Z)(A.root,u),focusVisibleClassName:(0,i.Z)(A.focusVisible,f),onClick:function(e){I&&I(e),m&&m(e)},ref:n,ownerState:N},h,{children:[(0,Z.jsx)(w,{className:A.content,ownerState:N,children:r}),l&&(0,Z.jsx)(k,{className:A.expandIconWrapper,ownerState:N,children:l})]}))}))}}]);
//# sourceMappingURL=2419.312148a2.chunk.js.map