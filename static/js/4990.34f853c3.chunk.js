"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[4990,8177],{17560:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var r=n(41867),s=n(3762),i=n(7229),o=n(72176),a=n(44047),l=n(98303),c=n(51590),d=n(49133),u=n(96614),f=n(83171),h=n(97102),p=n(71512),v=n(90872),m=n(90375),g=n(13577),x=n(80838);function j(e){let{columns:t,filter:n,setFilter:r}=e;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(c.Z,{children:"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"}),t.map((e=>{let{field:t}=e;return(0,x.jsx)(d.Z,{placeholder:"Filter ".concat(t),value:n[t]||"",onChange:e=>r({...n,[t]:e.target.value})},"filter-".concat(t))}))]})}function w(e){var t;const{feature:n,descriptions:s={}}=e,{ref:i,scrollLeft:o}=(0,g.x)(),[l,d]=(0,r.useState)({}),w=n.samples||{},b=Object.entries(w);let Z,k=[];const y=Object.keys(l);try{k=b.map((e=>({...Object.fromEntries(Object.entries(e[1]).map((e=>[e[0],"".concat(e[1])]))),sample:e[0],id:e[0]}))).filter((e=>!y.length||y.every((t=>{const n=l[t];return!n||e[t].match(new RegExp(n,"i"))}))))}catch(F){Z=F}const S=["sample",...Object.keys((null===(t=b[0])||void 0===t?void 0:t[1])||{})],[C,N]=(0,r.useState)(!1),[E,L]=(0,r.useState)(S.map((e=>(0,v.measureGridWidth)(k.map((t=>t[e])))))),O=S.map(((e,t)=>{var n,r;return{field:e,description:null===s||void 0===s||null===(n=s.FORMAT)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.Description,width:E[t]}}));return b.length?(0,x.jsxs)(a.BaseCard,{...e,title:"Samples",children:[Z?(0,x.jsx)(c.Z,{color:"error",children:"".concat(Z)}):null,(0,x.jsx)(u.Z,{control:(0,x.jsx)(f.Z,{checked:C,onChange:e=>N(e.target.checked)}),label:(0,x.jsx)(c.Z,{variant:"body2",children:"Show options"})}),C?(0,x.jsx)(j,{setFilter:d,columns:O,filter:l}):null,(0,x.jsxs)("div",{ref:i,children:[(0,x.jsx)(m.Z,{widths:E,setWidths:L,scrollLeft:o}),(0,x.jsx)(h._$,{rows:k,hideFooter:k.length<100,columns:O,disableRowSelectionOnClick:!0,rowHeight:25,columnHeaderHeight:35,disableColumnMenu:!0,slots:{toolbar:C?p.n:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}}})]})]}):null}var b=n(93989),Z=n(85291),k=n(47409),y=n(27768),S=n(23801),C=n(47192),N=n(31625),E=n(35421);const L=(0,C.ZL)()({block:{display:"block"}}),O=(0,s.observer)((function(e){let{model:t,handleClose:n,feature:s,viewType:i}=e;const{classes:o}=L(),[a,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!0);return(0,x.jsxs)(E.Dialog,{open:!0,onClose:n,title:"Breakpoint split view options",children:[(0,x.jsxs)(k.Z,{children:[(0,x.jsx)(u.Z,{className:o.block,control:(0,x.jsx)(f.Z,{checked:a,onChange:e=>l(e.target.checked)}),label:"Copy tracks into the new view"}),(0,x.jsx)(u.Z,{className:o.block,control:(0,x.jsx)(f.Z,{checked:c,onChange:e=>d(e.target.checked)}),label:"Mirror tracks vertically in vertically stacked view"})]}),(0,x.jsxs)(y.Z,{children:[(0,x.jsx)(S.Z,{onClick:()=>{const{view:e}=t,r=(0,v.getSession)(t);try{const a=i.snapshotFromBreakendFeature(s,e);function l(e){return e.map((e=>({...e,id:"".concat(e.trackId,"-").concat(Math.random())})))}a.views[0].offsetPx-=e.width/2+100,a.views[1].offsetPx-=e.width/2+100,a.featureData=s;const d=(0,N.getSnapshot)(e.tracks);a.views[0].tracks=l(d),a.views[1].tracks=l(c?[...d].reverse():d),r.addView("BreakpointSplitView",a)}catch(o){console.error(o),r.notify("".concat(o))}n()},variant:"contained",color:"primary",autoFocus:!0,children:"OK"}),(0,x.jsx)(S.Z,{onClick:()=>n(),color:"secondary",variant:"contained",children:"Cancel"})]})]})}));function F(e){const{model:t,locStrings:n,feature:s}=e,i=(0,v.getSession)(t),{pluginManager:o}=(0,v.getEnv)(i),[l,d]=(0,r.useState)(!1);let u;try{u=o.getViewType("BreakpointSplitView")}catch(h){}const f=new Z.Z(s);return(0,x.jsxs)(a.BaseCard,{...e,title:"Breakends",children:[(0,x.jsx)(c.Z,{children:"Link to linear view of breakend endpoints"}),(0,x.jsx)("ul",{children:n.map((e=>(0,x.jsx)("li",{children:(0,x.jsx)(b.Z,{href:"#",onClick:n=>{n.preventDefault();const{view:r}=t;try{if(!r)throw new Error("No view associated with this feature detail panel anymore");var s;null===(s=r.navToLocString)||void 0===s||s.call(r,e)}catch(h){console.error(h),i.notify("".concat(h))}},children:"LGV - ".concat(e)})},"".concat(JSON.stringify(e)))))}),u?(0,x.jsxs)("div",{children:[(0,x.jsx)(c.Z,{children:"Launch split views with breakend source and target"}),(0,x.jsx)("ul",{children:n.map((e=>(0,x.jsx)("li",{children:(0,x.jsx)(b.Z,{href:"#",onClick:e=>{e.preventDefault(),d(!0)},children:"".concat(s.refName,":").concat(s.start," // ").concat(e," (split view)")})},"".concat(JSON.stringify(e)))))}),l?(0,x.jsx)(O,{model:t,feature:f,viewType:u,handleClose:()=>{d(!1)}}):null]}):null]})}function T(e){let{rows:t,columns:n}=e;const{ref:s,scrollLeft:i}=(0,g.x)(),[o,a]=(0,r.useState)(!1),[l,d]=(0,r.useState)(n.map((e=>(0,v.measureGridWidth)(t.map((t=>t[e.field]))))));return t.length?(0,x.jsxs)("div",{ref:s,children:[(0,x.jsx)(u.Z,{control:(0,x.jsx)(f.Z,{checked:o,onChange:e=>a(e.target.checked)}),label:(0,x.jsx)(c.Z,{variant:"body2",children:"Show options"})}),(0,x.jsxs)("div",{ref:s,children:[(0,x.jsx)(m.Z,{widths:l,setWidths:d,scrollLeft:i}),(0,x.jsx)(h._$,{rowHeight:25,rows:t,columns:n.map(((e,t)=>({...e,width:l[t]}))),slots:{toolbar:o?p.n:null}})]})]}):null}function R(e){let{data:t,fields:n,title:r}=e;return t.length?(0,x.jsx)(a.BaseCard,{title:r,children:(0,x.jsx)(T,{rows:t.map(((e,t)=>({id:t,...Object.fromEntries(e.split("|").map(((e,t)=>[n[t],e])))})))||[],columns:n.map((e=>({field:e})))})}):null}const A={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"};function D(e){var t,n,r,s;let{descriptions:i,feature:o}=e;const a=null===i||void 0===i||null===(t=i.INFO)||void 0===t||null===(n=t.ANN)||void 0===n?void 0:n.Description,l=(null===a||void 0===a||null===(r=a.match(/.*Functional annotations:'(.*)'$/))||void 0===r?void 0:r[1].split("|"))||[],c=(null===(s=o.INFO)||void 0===s?void 0:s.ANN)||[];return(0,x.jsx)(R,{fields:l,data:c,title:"Variant ANN field"})}function I(e){var t,n,r,s;let{descriptions:i,feature:o}=e;const a=null===i||void 0===i||null===(t=i.INFO)||void 0===t||null===(n=t.CSQ)||void 0===n?void 0:n.Description,l=(null===a||void 0===a||null===(r=a.match(/.*Format: (.*)/))||void 0===r?void 0:r[1].split("|"))||[],c=(null===(s=o.INFO)||void 0===s?void 0:s.CSQ)||[];return(0,x.jsx)(R,{fields:l,data:c,title:"Variant CSQ field"})}const M=(0,s.observer)((function(e){const{model:t}=e,{featureData:n,descriptions:r}=t,s=JSON.parse(JSON.stringify(n)),{samples:c,...d}=s;return(0,x.jsxs)(i.Z,{"data-testid":"variant-side-drawer",children:[(0,x.jsx)(a.FeatureDetails,{feature:d,descriptions:{...A,...r},...e}),(0,x.jsx)(o.Z,{}),(0,x.jsx)(I,{feature:d,descriptions:r}),(0,x.jsx)(o.Z,{}),(0,x.jsx)(D,{feature:d,descriptions:r}),(0,x.jsx)(o.Z,{}),"breakend"===s.type?(0,x.jsx)(F,{feature:s,locStrings:s.ALT.map((e=>{var t;return(null===(t=(0,l.I)(e))||void 0===t?void 0:t.MatePosition)||""})),model:t}):null,"translocation"===s.type?(0,x.jsx)(F,{feature:s,model:t,locStrings:["".concat(s.INFO.CHR2[0],":").concat(s.INFO.END)]}):null,(0,x.jsx)(w,{feature:s,...e,descriptions:r})]})}))},20875:(e,t,n)=>{n.d(t,{d:()=>c});var r=n(41867),s=n(32407),i=n(95809),o=n(89293),a=n(80838);function l(e){return e.substring(2).toLowerCase()}function c(e){const{children:t,disableReactTree:n=!1,mouseEvent:c="onClick",onClickAway:d,touchEvent:u="onTouchEnd"}=e,f=r.useRef(!1),h=r.useRef(null),p=r.useRef(!1),v=r.useRef(!1);r.useEffect((()=>(setTimeout((()=>{p.current=!0}),0),()=>{p.current=!1})),[]);const m=(0,s.Z)(t.ref,h),g=(0,i.Z)((e=>{const t=v.current;v.current=!1;const r=(0,o.Z)(h.current);if(!p.current||!h.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,r))return;if(f.current)return void(f.current=!1);let s;s=e.composedPath?e.composedPath().indexOf(h.current)>-1:!r.documentElement.contains(e.target)||h.current.contains(e.target),s||!n&&t||d(e)})),x=e=>n=>{v.current=!0;const r=t.props[e];r&&r(n)},j={ref:m};return!1!==u&&(j[u]=x(u)),r.useEffect((()=>{if(!1!==u){const e=l(u),t=(0,o.Z)(h.current),n=()=>{f.current=!0};return t.addEventListener(e,g),t.addEventListener("touchmove",n),()=>{t.removeEventListener(e,g),t.removeEventListener("touchmove",n)}}}),[g,u]),!1!==c&&(j[c]=x(c)),r.useEffect((()=>{if(!1!==c){const e=l(c),t=(0,o.Z)(h.current);return t.addEventListener(e,g),()=>{t.removeEventListener(e,g)}}}),[g,c]),(0,a.jsx)(r.Fragment,{children:r.cloneElement(t,j)})}},69625:(e,t,n)=>{n.d(t,{Z:()=>p});var r=n(31461),s=n(7896),i=n(41867),o=n(66184),a=n(92705),l=n(90293),c=n(75693),d=n(59968),u=n(80838);const f=["className","component","disableGutters","variant"],h=(0,c.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((e=>{let{theme:t,ownerState:n}=e;return(0,s.Z)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},"dense"===n.variant&&{minHeight:48})}),(e=>{let{theme:t,ownerState:n}=e;return"regular"===n.variant&&t.mixins.toolbar})),p=i.forwardRef((function(e,t){const n=(0,l.Z)({props:e,name:"MuiToolbar"}),{className:i,component:c="div",disableGutters:p=!1,variant:v="regular"}=n,m=(0,r.Z)(n,f),g=(0,s.Z)({},n,{component:c,disableGutters:p,variant:v}),x=(e=>{const{classes:t,disableGutters:n,variant:r}=e,s={root:["root",!n&&"gutters",r]};return(0,a.Z)(s,d.N,t)})(g);return(0,u.jsx)(h,(0,s.Z)({as:c,className:(0,o.Z)(x.root,i),ref:t,ownerState:g},m))}))},59968:(e,t,n)=>{n.d(t,{N:()=>i,Z:()=>o});var r=n(70101),s=n(88498);function i(e){return(0,s.Z)("MuiToolbar",e)}const o=(0,r.Z)("MuiToolbar",["root","gutters","regular","dense"])}}]);
//# sourceMappingURL=4990.34f853c3.chunk.js.map