"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[9810,2291],{52291:(e,t,o)=>{o.r(t),o.d(t,{ColorPicker:()=>G,ColorPopover:()=>q,PopoverPicker:()=>Y,default:()=>X});var n=o(41867),r=o(622),l=o(64980),a=o(36669),c=o(59231),s=o(49133),i=o(47192),u=o(39092),d=o(90872);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var o,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)t.indexOf(o=l[n])>=0||(r[o]=e[o]);return r}function g(e){const t=(0,n.useRef)(e),o=(0,n.useRef)((e=>{t.current&&t.current(e)}));return t.current=e,o.current}const m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e>o?o:e<t?t:e},p=e=>"touches"in e,v=e=>e&&e.ownerDocument.defaultView||self,x=(e,t,o)=>{const n=e.getBoundingClientRect(),r=p(t)?((e,t)=>{for(let o=0;o<e.length;o++)if(e[o].identifier===t)return e[o];return e[0]})(t.touches,o):t;return{left:m((r.pageX-(n.left+v(e).pageXOffset))/n.width),top:m((r.pageY-(n.top+v(e).pageYOffset))/n.height)}},b=e=>{!p(e)&&e.preventDefault()},C=n.memo((e=>{let{onMove:t,onKey:o}=e,r=f(e,["onMove","onKey"]);const l=(0,n.useRef)(null),a=g(t),c=g(o),s=(0,n.useRef)(null),i=(0,n.useRef)(!1),[u,d,m]=(0,n.useMemo)((()=>{const e=e=>{b(e),(p(e)?e.touches.length>0:e.buttons>0)&&l.current?a(x(l.current,e,s.current)):o(!1)},t=()=>o(!1);function o(o){const n=i.current,r=v(l.current),a=o?r.addEventListener:r.removeEventListener;a(n?"touchmove":"mousemove",e),a(n?"touchend":"mouseup",t)}return[e=>{let{nativeEvent:t}=e;const n=l.current;if(n&&(b(t),!((e,t)=>t&&!p(e))(t,i.current)&&n)){if(p(t)){i.current=!0;const e=t.changedTouches||[];e.length&&(s.current=e[0].identifier)}n.focus(),a(x(n,t,s.current)),o(!0)}},e=>{const t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),c({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},o]}),[c,a]);return(0,n.useEffect)((()=>m),[m]),n.createElement("div",h({},r,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:l,onKeyDown:d,tabIndex:0,role:"slider"}))})),j=e=>e.filter(Boolean).join(" "),w=e=>{let{className:t,color:o,left:r,top:l=.5}=e;const a=j(["react-colorful__pointer",t]);return n.createElement("div",{className:a,style:{top:100*l+"%",left:100*r+"%"}},n.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:o}}))},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.pow(10,t);return Math.round(o*e)/o},k=(Math.PI,e=>{let{h:t,s:o,v:n,a:r}=e;const l=(200-o)*n/100;return{h:_(t),s:_(l>0&&l<200?o*n/100/(l<=100?l:200-l)*100:0),l:_(l/2),a:_(r,2)}}),y=e=>{const{h:t,s:o,l:n}=k(e);return"hsl(".concat(t,", ").concat(o,"%, ").concat(n,"%)")},M=e=>{const{h:t,s:o,l:n,a:r}=k(e);return"hsla(".concat(t,", ").concat(o,"%, ").concat(n,"%, ").concat(r,")")},E=e=>{let{h:t,s:o,v:n,a:r}=e;t=t/360*6,o/=100,n/=100;const l=Math.floor(t),a=n*(1-o),c=n*(1-(t-l)*o),s=n*(1-(1-t+l)*o),i=l%6;return{r:_(255*[n,c,a,a,s,n][i]),g:_(255*[s,n,n,c,a,a][i]),b:_(255*[a,a,s,n,n,c][i]),a:_(r,2)}},N=e=>{const t=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(e);return t?Z({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):{h:0,s:0,v:0,a:1}},Z=e=>{let{r:t,g:o,b:n,a:r}=e;const l=Math.max(t,o,n),a=l-Math.min(t,o,n),c=a?l===t?(o-n)/a:l===o?2+(n-t)/a:4+(t-o)/a:0;return{h:_(60*(c<0?c+6:c)),s:_(l?a/l*100:0),v:_(l/255*100),a:r}},S=n.memo((e=>{let{className:t,hue:o,onChange:r}=e;const l=j(["react-colorful__hue",t]);return n.createElement("div",{className:l},n.createElement(C,{onMove:e=>{r({h:360*e.left})},onKey:e=>{r({h:m(o+360*e.left,0,360)})},"aria-label":"Hue","aria-valuetext":_(o)},n.createElement(w,{className:"react-colorful__hue-pointer",left:o/360,color:y({h:o,s:100,v:100,a:1})})))})),O=n.memo((e=>{let{hsva:t,onChange:o}=e;const r={backgroundColor:y({h:t.h,s:100,v:100,a:1})};return n.createElement("div",{className:"react-colorful__saturation",style:r},n.createElement(C,{onMove:e=>{o({s:100*e.left,v:100-100*e.top})},onKey:e=>{o({s:m(t.s+100*e.left,0,100),v:m(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation ".concat(_(t.s),"%, Brightness ").concat(_(t.v),"%")},n.createElement(w,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:y(t)})))})),H=(e,t)=>{if(e===t)return!0;for(const o in e)if(e[o]!==t[o])return!1;return!0},L=(e,t)=>e.replace(/\s/g,"")===t.replace(/\s/g,"");function R(e,t,o){const r=g(o),[l,a]=(0,n.useState)((()=>e.toHsva(t))),c=(0,n.useRef)({color:t,hsva:l});(0,n.useEffect)((()=>{if(!e.equal(t,c.current.color)){const o=e.toHsva(t);c.current={hsva:o,color:t},a(o)}}),[t,e]),(0,n.useEffect)((()=>{let t;H(l,c.current.hsva)||e.equal(t=e.fromHsva(l),c.current.color)||(c.current={hsva:l,color:t},r(t))}),[l,e,r]);const s=(0,n.useCallback)((e=>{a((t=>Object.assign({},t,e)))}),[]);return[l,s]}const T="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;let P;const z=new Map,D=e=>{T((()=>{const t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!z.has(t)){const e=t.createElement("style");e.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',z.set(t,e);const n=P||o.nc;n&&e.setAttribute("nonce",n),t.head.appendChild(e)}}),[])},I=e=>{let{className:t,hsva:o,onChange:r}=e;const l={backgroundImage:"linear-gradient(90deg, ".concat(M(Object.assign({},o,{a:0})),", ").concat(M(Object.assign({},o,{a:1})),")")},a=j(["react-colorful__alpha",t]);return n.createElement("div",{className:a},n.createElement("div",{className:"react-colorful__alpha-gradient",style:l}),n.createElement(C,{onMove:e=>{r({a:e.left})},onKey:e=>{r({a:m(o.a+e.left)})},"aria-label":"Alpha","aria-valuetext":"".concat(_(100*o.a),"%")},n.createElement(w,{className:"react-colorful__alpha-pointer",left:o.a,color:M(o)})))},K=e=>{let{className:t,colorModel:o,color:r=o.defaultColor,onChange:l}=e,a=f(e,["className","colorModel","color","onChange"]);const c=(0,n.useRef)(null);D(c);const[s,i]=R(o,r,l),u=j(["react-colorful",t]);return n.createElement("div",h({},a,{ref:c,className:u}),n.createElement(O,{hsva:s,onChange:i}),n.createElement(S,{hue:s.h,onChange:i}),n.createElement(I,{hsva:s,onChange:i,className:"react-colorful__last-control"}))},A={defaultColor:"rgba(0, 0, 0, 1)",toHsva:N,fromHsva:e=>{const{r:t,g:o,b:n,a:r}=E(e);return"rgba(".concat(t,", ").concat(o,", ").concat(n,", ").concat(r,")")},equal:L},B=e=>n.createElement(K,h({},e,{colorModel:A}));var W=o(80838);const V=(0,i.ZL)()({picker:{position:"relative"},swatches:{display:"flex",padding:12,flexWrap:"wrap"},swatch:{width:24,height:24,margin:4,border:"none",padding:0,cursor:"pointer",outline:"none"}}),Y=e=>{let{color:t,onChange:o}=e;const[r,l]=(0,n.useState)(null),{classes:a}=V();return(0,W.jsxs)("div",{className:a.picker,children:[(0,W.jsx)("div",{className:a.swatch,style:{backgroundColor:t},onClick:e=>l(e.currentTarget)}),(0,W.jsx)(q,{anchorEl:r,onClose:()=>l(null),color:t,onChange:o})]})};function q(e){let{anchorEl:t,onChange:o,onClose:n,color:r}=e;return(0,W.jsx)(l.ZP,{open:!!t,anchorEl:t,onClose:n,children:(0,W.jsx)(G,{color:r,onChange:o})})}function G(e){let{onChange:t,color:o}=e;const{classes:l}=V(),[i,h]=(0,d.useLocalStorage)("colorPickerPalette","set1"),f=u[i],g=Object.keys(u),[m,p]=(0,n.useState)(o),v=(0,r.V)(o).toRgbString(),x=(0,d.useDebounce)(v,1e3),b=e=>{p(e);try{t((0,r.V)(e).toRgbString())}catch(o){}};return(0,W.jsxs)("div",{style:{display:"flex",padding:10},children:[(0,W.jsx)("div",{style:{width:200,margin:5},children:(0,W.jsx)(B,{color:x,onChange:b})}),(0,W.jsxs)("div",{style:{width:200,margin:5},children:[(0,W.jsx)(a.Z,{value:i,onChange:e=>{const t=e.target.value;h(t)},children:g.map((e=>(0,W.jsx)(c.Z,{value:e,children:e},e)))}),(0,W.jsx)("div",{className:l.swatches,children:f.map(((e,t)=>(0,W.jsx)("button",{className:l.swatch,style:{background:e},onClick:()=>b(e)},"".concat(e,"-").concat(t))))}),(0,W.jsx)(s.Z,{helperText:"Manually set color (hex, rgb, or css color name)",value:m,onChange:e=>b(e.target.value)})]})]})}const X=Y},39810:(e,t,o)=>{o.r(t),o.d(t,{default:()=>P});var n=o(41867),r=o(47409),l=o(23801),a=o(27768),c=o(47192),s=o(90872),i=o(25217),u=o.n(i),d=o(7229),h=o(27341),f=o(51825),g=o(87984),m=o(68367),p=o(72176),v=o(3762),x=o(21941),b=o.n(x),C=o(22177),j=o(80838);const w=(0,c.ZL)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function _(e){return(0,j.jsx)(b(),{handle:"#draggable-dialog-title",cancel:'[class*="MuiDialogContent-root"]',children:(0,j.jsx)(d.Z,{...e})})}const k=(0,v.observer)((function(e){const{classes:t}=w(),{title:o,children:n,onClose:r}=e;return(0,j.jsx)(h.Z,{...e,PaperComponent:_,"aria-labelledby":"draggable-dialog-title",children:(0,j.jsxs)(f.Z,{children:[(0,j.jsxs)(g.Z,{style:{cursor:"move"},id:"draggable-dialog-title",children:[o,r?(0,j.jsx)(m.Z,{className:t.closeButton,onClick:()=>{r()},children:(0,j.jsx)(C.Z,{})}):null]}),(0,j.jsx)(p.Z,{}),n]})})}));var y=o(97102),M=o(52291),E=o(14846),N=o(99641),Z=o(70532),S=o(2829),O=o(81184),H=o(35421);const L=(0,c.ZL)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});const R=function(e){let{rows:t,onChange:o,showTips:r}=e;const{classes:a}=L(),[c,i]=(0,n.useState)(null),[u,d]=(0,n.useState)([]),{name:h,color:f,baseUri:g,...m}=t[0],[p,v]=(0,n.useState)("blue"),[x,b]=(0,n.useState)({idx:0,field:null});return(0,j.jsxs)("div",{children:[(0,j.jsx)(l.Z,{disabled:!u.length,onClick:e=>i(e.currentTarget),children:"Change color of selected items"}),(0,j.jsxs)(l.Z,{onClick:()=>o((0,E.A1)([...t],u)),disabled:!u.length,children:[(0,j.jsx)(O.Z,{}),r?"Move selected items up":null]}),(0,j.jsxs)(l.Z,{onClick:()=>o((0,E.vi)([...t],u)),disabled:!u.length,children:[(0,j.jsx)(S.Z,{}),r?"Move selected items down":null]}),(0,j.jsxs)(l.Z,{onClick:()=>o((0,E.A1)([...t],u,t.length)),disabled:!u.length,children:[(0,j.jsx)(N.Z,{}),r?"Move selected items to top":null]}),(0,j.jsxs)(l.Z,{onClick:()=>o((0,E.vi)([...t],u,t.length)),disabled:!u.length,children:[(0,j.jsx)(Z.Z,{}),r?"Move selected items to bottom":null]}),(0,j.jsx)(M.ColorPopover,{anchorEl:c,color:p,onChange:e=>{v(e),u.forEach((o=>{const n=t.find((e=>e.name===o));n&&(n.color=e)})),o([...t])},onClose:()=>i(null)}),(0,j.jsx)("div",{style:{height:400,width:"100%"},children:(0,j.jsx)(y._$,{getRowId:e=>e.name,checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>d(e),rows:t,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:e=>{const{value:n,id:r}=e;return(0,j.jsx)(M.default,{color:n||"blue",onChange:e=>{const n=t.find((e=>e.name===r));n&&(n.color=e),o([...t])}})}},{field:"name",sortingOrder:[null],headerName:"Name",width:(0,s.measureGridWidth)(t.map((e=>e.name)))},...Object.keys(m).map((e=>({field:e,sortingOrder:[null],renderCell:e=>{const{value:t}=e;return(0,j.jsx)("div",{className:a.cell,children:(0,j.jsx)(H.SanitizedHTML,{html:(0,s.getStr)(t)})})},width:(0,s.measureGridWidth)(t.map((t=>t[e])))})))],sortModel:[],onSortModelChange:e=>{const n=e[0],r=(x.idx+1)%2,l=(null===n||void 0===n?void 0:n.field)||x.field;b({idx:r,field:l}),o(l?[...t].sort(((e,t)=>{const o=(0,s.getStr)(e[l]),n=(0,s.getStr)(t[l]);return 1===r?o.localeCompare(n):n.localeCompare(o)})):t)}})})]})},T=(0,c.ZL)()({content:{minWidth:800}});function P(e){let{model:t,handleClose:o}=e;const{classes:c}=T(),{sources:i}=t,[d,h]=(0,n.useState)(u()(i||[])),[f,g]=(0,s.useLocalStorage)("multiwiggle-showTips",!0);return(0,j.jsxs)(k,{open:!0,onClose:o,maxWidth:"xl",title:"Multi-wiggle color/arrangement editor",children:[(0,j.jsxs)(r.Z,{className:c.content,children:[(0,j.jsx)(l.Z,{variant:"contained",style:{float:"right"},onClick:()=>g(!f),children:f?"Hide tips":"Show tips"}),(0,j.jsx)("br",{}),f?(0,j.jsxs)(j.Fragment,{children:["Helpful tips",(0,j.jsxs)("ul",{children:[(0,j.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,j.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,j.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,j.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,j.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,j.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,j.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]}):null,(0,j.jsx)(R,{rows:d,onChange:h,showTips:f})]}),(0,j.jsxs)(a.Z,{children:[(0,j.jsx)(l.Z,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),h(t.sources||[])},children:"Clear custom settings"}),(0,j.jsx)(l.Z,{variant:"contained",color:"secondary",onClick:()=>{o(),h([...t.sources||[]])},children:"Cancel"}),(0,j.jsx)(l.Z,{variant:"contained",color:"primary",type:"submit",onClick:()=>{t.setLayout(d),o()},children:"Submit"})]})]})}},14846:(e,t,o)=>{o.d(t,{A1:()=>l,os:()=>s,vi:()=>a});var n=o(90872),r=o(43800);function l(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=t.map((t=>e.findIndex((e=>e.name===t)))).sort(((e,t)=>e-t));let r=0;for(const l of n){const t=Math.max(r,l-o);t>=r&&e.splice(t,0,e.splice(l,1)[0]),r+=1}return e}function a(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=t.map((t=>e.findIndex((e=>e.name===t)))).sort(((e,t)=>t-e));let r=e.length-1;for(const l of n){const t=Math.min(r,l+o);t<=r&&e.splice(t,0,e.splice(l,1)[0]),r-=1}return e}const c=12.8;function s(e){const{prefersOffset:t}=e,{trackLabels:o}=(0,n.getContainingView)(e),l=(0,n.getContainingTrack)(e),a=(0,r.getConf)(l,"name");return"overlapping"!==o||t?10:(0,n.measureText)(a,c)+100}}}]);
//# sourceMappingURL=9810.922ef4dc.chunk.js.map