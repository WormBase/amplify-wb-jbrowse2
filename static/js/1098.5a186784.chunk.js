"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[1098],{67765:(e,t,n)=>{n.d(t,{UL:()=>x,WK:()=>m,i1:()=>p,u_:()=>u});n(41867);var s=n(47192),o=n(3762),r=n(31625),i=n(90872),l=n(56726),a=n(17280),c=n(63008),d=n(80838);const h=(0,s.ZL)()((()=>({vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}}))),u=(0,o.observer)((function(e){let{model:t}=e;const{viewWidth:n,borderY:s}=t,{classes:o}=h();return(0,d.jsx)("svg",{width:n,height:s,className:o.htext,children:(0,d.jsx)(m,{model:t})})})),m=(0,o.observer)((function(e){let{model:t}=e;const{viewWidth:n,borderX:s,borderY:o,hview:h,htextRotation:u,hticks:m}=t,{offsetPx:x,width:p,dynamicBlocks:f,bpPerPx:v}=h,y=f.contentBlocks,b=(0,c.F$)(y,n,x),j=(0,a.Z)(),g={...(0,r.getSnapshot)(h),width:p,staticBlocks:h.staticBlocks},w=m.map((e=>{var t;return[e,null===(t=(0,l.R)({refName:e.refName,coord:e.base,self:g}))||void 0===t?void 0:t.offsetPx]})).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-x]));return(0,d.jsxs)(d.Fragment,{children:[y.filter((e=>!b.has(e.key))).map((e=>{const t=e.offsetPx,n=Math.floor(t-h.offsetPx);return(0,d.jsx)("text",{transform:"rotate(".concat(u,",").concat(n,",").concat(0,")"),x:n,y:1,fill:j.palette.text.primary,fontSize:11,dominantBaseline:"hanging",textAnchor:"end",children:e.refName},JSON.stringify(e))})),w.map((e=>{let[t,n]=e;return(0,d.jsx)("line",{x1:n,x2:n,y1:0,y2:"major"===t.type?6:4,strokeWidth:1,stroke:j.palette.grey[400]},"line-".concat(JSON.stringify(t)))})),w.filter((e=>"major"===e[0].type)).map((e=>{let[t,n]=e;return n>10?(0,d.jsx)("text",{x:n-7,y:0,transform:"rotate(".concat(u,",").concat(n,",").concat(0,")"),fill:j.palette.text.primary,fontSize:11,dominantBaseline:"middle",textAnchor:"end",children:(0,i.getTickDisplayStr)(t.base+1,v)},"text-".concat(JSON.stringify(t))):null})),(0,d.jsx)("text",{y:o-12,x:(n-s)/2,fill:j.palette.text.primary,textAnchor:"middle",fontSize:11,dominantBaseline:"hanging",children:h.assemblyNames.join(",")})]})})),x=(0,o.observer)((function(e){let{model:t}=e;const{borderX:n,viewHeight:s}=t,{classes:o}=h();return(0,d.jsx)("svg",{className:o.vtext,width:n,height:s,children:(0,d.jsx)(p,{model:t})})})),p=(0,o.observer)((function(e){let{model:t}=e;const{viewHeight:n,borderX:s,borderY:o,vview:h,vtextRotation:u,vticks:m}=t,{offsetPx:x,width:p,dynamicBlocks:f,bpPerPx:v}=h,y=f.contentBlocks,b=(0,c.F$)(y,n,x),j=(0,a.Z)(),g={...(0,r.getSnapshot)(h),width:p,staticBlocks:h.staticBlocks},w=m.map((e=>{var t;return[e,null===(t=(0,l.R)({refName:e.refName,coord:e.base,self:g}))||void 0===t?void 0:t.offsetPx]})).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-x]));return(0,d.jsxs)(d.Fragment,{children:[y.filter((e=>!b.has(e.key))).map((e=>{const t=e.offsetPx,o=s,r=Math.floor(n-t+x);return(0,d.jsx)("text",{transform:"rotate(".concat(u,",").concat(o,",").concat(t,")"),x:o,y:r,fill:j.palette.text.primary,fontSize:11,textAnchor:"end",children:e.refName},JSON.stringify(e))})),w.map((e=>{let[t,o]=e;return(0,d.jsx)("line",{y1:n-o,y2:n-o,x1:s,x2:s-("major"===t.type?6:4),strokeWidth:1,stroke:j.palette.grey[400]},"line-".concat(JSON.stringify(t)))})),w.filter((e=>"major"===e[0].type)).map((e=>{let[t,o]=e;return o>10?(0,d.jsx)("text",{y:n-o-3,x:s-7,textAnchor:"end",fill:j.palette.text.primary,dominantBaseline:"hanging",fontSize:11,children:(0,i.getTickDisplayStr)(t.base+1,v)},"text-".concat(JSON.stringify(t))):null})),(0,d.jsx)("text",{y:(n-o)/2,x:12,fill:j.palette.text.primary,transform:"rotate(-90,12,".concat((n-o)/2,")"),textAnchor:"middle",fontSize:11,children:h.assemblyNames.join(",")})]})}))},41098:(e,t,n)=>{n.r(t),n.d(t,{default:()=>xe});var s=n(41867),o=n(35421),r=n(3762),i=n(85815),l=n(47192),a=n(92937),c=n.n(a),d=n(90552),h=n(98484),u=n(21126),m=n(96614),x=n(23738),p=n(47500),f=n(45294),v=n(7229),y=n(51590),b=n(23801),j=n(90872);var g=n(80838);function w(e){let{radioOption:t,assembly1:n,assembly2:s,fileLocation:o,bed1Location:r,bed2Location:i}=e;if(".paf"===t)return{type:"PAFAdapter",pafLocation:o,queryAssembly:n,targetAssembly:s};if(".out"===t)return{type:"MashMapAdapter",outLocation:o,queryAssembly:n,targetAssembly:s};if(".delta"===t)return{type:"DeltaAdapter",deltaLocation:o,queryAssembly:n,targetAssembly:s};if(".chain"===t)return{type:"ChainAdapter",chainLocation:o,queryAssembly:n,targetAssembly:s};if(".anchors"===t)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:o,bed1Location:r,bed2Location:i,assemblyNames:[n,s]};if(".anchors.simple"===t)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:o,bed1Location:r,bed2Location:i,assemblyNames:[n,s]};throw new Error("Unknown to detect type ".concat(t," from filename (select radio button to clarify)"))}const k=(0,r.observer)((e=>{let{assembly1:t,assembly2:n,setSessionTrackData:r}=e;const[i,l]=(0,s.useState)(),[a,c]=(0,s.useState)(),[d,h]=(0,s.useState)(),[p,b]=(0,s.useState)(""),[j,k]=(0,s.useState)(),Z=(S=d)?S.uri||S.localPath||S.name:void 0;var S;const C=p||(Z?function(e){const t=e.split(".").pop();return t?".".concat(t):""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(Z)):"");return(0,s.useEffect)((()=>{try{if(d){const e=Z?Z.split("#")[0].split("?")[0].split("/").pop():"MyTrack",s="".concat(e,"-").concat(Date.now());k(void 0),r({trackId:s,name:e,assemblyNames:[n,t],type:"SyntenyTrack",adapter:w({radioOption:C,assembly1:t,assembly2:n,fileLocation:d,bed1Location:a,bed2Location:i})})}}catch(e){console.error(e),k(e)}}),[Z,t,n,a,i,d,C,r]),(0,g.jsxs)(v.Z,{style:{padding:12},children:[j?(0,g.jsx)(o.ErrorMessage,{error:j}):null,(0,g.jsx)(y.Z,{style:{textAlign:"center"},children:"Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view in the dotplot. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"}),(0,g.jsx)(u.Z,{value:C,onChange:e=>b(e.target.value),children:(0,g.jsxs)(f.ZP,{container:!0,justifyContent:"center",children:[(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".paf",control:(0,g.jsx)(x.Z,{}),label:".paf"})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".out",control:(0,g.jsx)(x.Z,{}),label:".out"})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".delta",control:(0,g.jsx)(x.Z,{}),label:".delta"})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".chain",control:(0,g.jsx)(x.Z,{}),label:".chain"})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".anchors",control:(0,g.jsx)(x.Z,{}),label:".anchors"})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(m.Z,{value:".anchors.simple",control:(0,g.jsx)(x.Z,{}),label:".anchors.simple"})})]})}),(0,g.jsx)(f.ZP,{container:!0,justifyContent:"center",children:(0,g.jsx)(f.ZP,{item:!0,children:".anchors"===p||".anchors.simple"===p?(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{style:{margin:20},children:["Open the ",p," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,g.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)("div",{children:(0,g.jsx)(o.FileSelector,{name:".anchors file",description:"",location:d,setLocation:e=>h(e)})}),(0,g.jsx)("div",{children:(0,g.jsx)(o.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:a,setLocation:e=>c(e)})}),(0,g.jsx)("div",{children:(0,g.jsx)(o.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:i,setLocation:e=>l(e)})})]})]}):(0,g.jsx)(o.FileSelector,{name:p?p+" location":"",description:"",location:d,setLocation:e=>h(e)})})})]})}));var Z=n(36669),S=n(59231),C=n(99512),P=n(43800),L=n(24728);const M=(0,r.observer)((e=>{var t;let{model:n,assembly1:r,assembly2:i,setShowTrackId:l}=e;const a=(0,j.getSession)(n),{tracks:c,sessionTracks:d}=a,h=[...c,...d||[]].filter((e=>function(e,t,n){const s=(0,P.readConfObject)(e,"assemblyNames");return s.includes(t)&&s.includes(n)&&e.type.includes("Synteny")}(e,i,r))),u=(null===(t=h[0])||void 0===t?void 0:t.trackId)||"",[m,x]=(0,s.useState)(u);return(0,s.useEffect)((()=>{x(u)}),[u]),(0,s.useEffect)((()=>{l(m)}),[m,l]),(0,g.jsxs)(v.Z,{style:{padding:12},children:[(0,g.jsx)(y.Z,{paragraph:!0,children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),(0,g.jsxs)(y.Z,{paragraph:!0,children:["Note: there is a track selector ",(0,g.jsx)("i",{children:"inside"})," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon ",(0,g.jsx)(L.GD,{})]}),h.length?(0,g.jsx)(Z.Z,{value:m,onChange:e=>x(e.target.value),children:h.map((e=>(0,g.jsx)(S.Z,{value:e.trackId,children:(0,C.getTrackName)(e,a)},e.trackId)))}):(0,g.jsx)(o.ErrorMessage,{error:"No synteny tracks found for ".concat(r,",").concat(i)})]})})),N=(0,l.ZL)()((e=>({importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}})));function A(e){let{setSessionTrackData:t,setShowTrackId:n,sessionTrackData:o,assembly1:r,assembly2:i,model:l}=e;const[a,c]=(0,s.useState)("none");return(0,s.useEffect)((()=>{"none"===a&&(t(void 0),n(void 0))}),[a,t,n]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(d.Z,{children:[(0,g.jsx)(h.Z,{id:"group-label",children:"(Optional) Select or add a synteny track"}),(0,g.jsxs)(u.Z,{row:!0,value:a,onChange:e=>c(e.target.value),"aria-labelledby":"group-label",children:[(0,g.jsx)(m.Z,{value:"none",control:(0,g.jsx)(x.Z,{}),label:"None"}),(0,g.jsx)(m.Z,{value:"tracklist",control:(0,g.jsx)(x.Z,{}),label:"Existing track"}),(0,g.jsx)(m.Z,{value:"custom",control:(0,g.jsx)(x.Z,{}),label:"New track"})]})]}),"custom"===a?(0,g.jsx)(k,{setSessionTrackData:t,sessionTrackData:o,assembly2:i,assembly1:r}):null,"tracklist"===a?(0,g.jsx)(M,{model:l,assembly1:r,assembly2:i,setShowTrackId:n}):null]})}const B=(0,r.observer)((e=>{let{model:t}=e;const{classes:n}=N(),r=(0,j.getSession)(t),{assemblyNames:l}=r,[a,c]=(0,s.useState)(l[0]||""),[h,u]=(0,s.useState)(l[0]||""),[m,x]=(0,s.useState)(),[w,k]=(0,s.useState)(),[Z,S]=(0,s.useState)();const C=m||t.error;return(0,g.jsxs)(p.Z,{className:n.importFormContainer,children:[C?(0,g.jsx)(o.ErrorMessage,{error:C}):null,(0,g.jsx)(f.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:n.assemblySelector,children:(0,g.jsxs)(f.ZP,{item:!0,children:[(0,g.jsxs)(v.Z,{style:{padding:12},children:[(0,g.jsx)(y.Z,{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,g.jsxs)(f.ZP,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(o.AssemblySelector,{selected:h,onChange:e=>u(e),session:r})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(o.AssemblySelector,{selected:a,onChange:e=>c(e),session:r})}),(0,g.jsx)(f.ZP,{item:!0,children:(0,g.jsx)(d.Z,{children:(0,g.jsx)(b.Z,{onClick:function(){try{if(!(0,j.isSessionWithAddTracks)(r))return;x(void 0),t.setError(void 0),(0,i.transaction)((()=>{w?(r.addTrackConf(w),t.toggleTrack(w.trackId)):Z&&t.showTrack(Z),t.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),t.setAssemblyNames(a,h)}))}catch(e){console.error(e),x(e)}},variant:"contained",color:"primary",children:"Launch"})})})]})]}),(0,g.jsx)(A,{setShowTrackId:S,assembly2:a,assembly1:h,setSessionTrackData:k,sessionTrackData:w,model:t})]})})]})}));var z=n(77327);const T=(0,s.lazy)((()=>Promise.all([n.e(3650),n.e(7102),n.e(3954)]).then(n.bind(n,46836)))),R=(0,r.observer)((function(e){let{model:t}=e;const n=t.tracks.filter((e=>{var t;return null===(t=e.displays[0].warnings)||void 0===t?void 0:t.length})),[o,r]=(0,s.useState)(!1);return n.length?(0,g.jsxs)(z.Z,{severity:"warning",children:["Warnings during render"," ",(0,g.jsx)(b.Z,{onClick:()=>r(!0),children:"More info"}),o?(0,g.jsx)(T,{trackWarnings:n,handleClose:()=>r(!1)}):null]}):null}));var D=n(68367),I=n(41064),E=n(27577),F=n(83177),O=n(83329),H=n(13536),W=n(2885);const V=(0,l.ZL)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:1e3,top:50},icon:{padding:0,margin:0}}),q=(0,r.observer)((function(e){let{model:t}=e;const{classes:n}=V();return(0,g.jsxs)(v.Z,{className:n.dpad,elevation:6,children:[(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>t.vview.scroll(100),children:(0,g.jsx)(E.Z,{})}),(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>t.hview.scroll(-100),children:(0,g.jsx)(F.Z,{})}),(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>t.hview.scroll(100),children:(0,g.jsx)(O.Z,{})}),(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>t.vview.scroll(-100),children:(0,g.jsx)(I.Z,{})}),(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>{t.hview.zoomIn(),t.vview.zoomIn()},children:(0,g.jsx)(H.Z,{})}),(0,g.jsx)("div",{}),(0,g.jsx)(D.Z,{className:n.icon,onClick:()=>{t.hview.zoomOut(),t.vview.zoomOut()},children:(0,g.jsx)(W.Z,{})})]})}));var J=n(69282),X=n(30340),Y=n(77081);function _(e){return(0,g.jsx)(Y.Z,{...e,children:(0,g.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"})})}function G(e){return(0,g.jsx)(Y.Z,{...e,children:(0,g.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"})})}const U=(0,r.observer)((function(e){let{model:t}=e;return(0,g.jsxs)("div",{children:[(0,g.jsx)(D.Z,{onClick:t.zoomOutButton,children:(0,g.jsx)(W.Z,{})}),(0,g.jsx)(D.Z,{onClick:t.zoomInButton,children:(0,g.jsx)(H.Z,{})}),(0,g.jsx)(D.Z,{onClick:()=>t.activateTrackSelector(),title:"Open track selector",children:(0,g.jsx)(L.GD,{})}),(0,g.jsx)(J.Z,{menuItems:[{onClick:()=>t.squareView(),label:"Square view - same base pairs per pixel"},{onClick:()=>t.squareViewProportional(),label:"Rectanglularize view - same total bp"},{onClick:()=>t.showAllRegions(),label:"Show all regions"},{onClick:()=>t.setDrawCigar(!t.drawCigar),type:"checkbox",label:"Draw CIGAR",checked:t.drawCigar},{onClick:()=>t.setShowPanButtons(!t.showPanButtons),label:"Show pan buttons",type:"checkbox",checked:t.showPanButtons},{label:"Click and drag mode",subMenu:[{onClick:()=>t.setCursorMode("move"),label:"Pan by default, select region when ctrl key is held",icon:_,type:"radio",checked:"move"===t.cursorMode},{onClick:()=>t.setCursorMode("crosshair"),label:"Select region by default, pan when ctrl key is held",icon:G,type:"radio",checked:"crosshair"===t.cursorMode}]},{label:"Wheel scroll mode",subMenu:[{onClick:()=>t.setWheelMode("pan"),label:"Pans view",type:"radio",checked:"pan"===t.wheelMode},{onClick:()=>t.setWheelMode("zoom"),label:"Zooms view",type:"radio",checked:"zoom"===t.wheelMode},{onClick:()=>t.setWheelMode("none"),label:"Disable",type:"radio",checked:"none"===t.wheelMode}]}],children:(0,g.jsx)(X.Z,{})})]})})),K=(0,l.ZL)()({bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),$=(0,r.observer)((function(e){let{model:t,selection:n}=e;const{classes:s}=K(),{hview:o,vview:r,showPanButtons:i}=t;return(0,g.jsxs)("div",{className:s.headerBar,children:[(0,g.jsx)(U,{model:t}),(0,g.jsxs)(y.Z,{className:s.bp,variant:"body2",color:"textSecondary",children:["x: ",o.assemblyNames.join(",")," ",(0,j.getBpDisplayStr)(o.currBp),(0,g.jsx)("br",{}),"y: ",r.assemblyNames.join(",")," ",(0,j.getBpDisplayStr)(r.currBp)]}),n?(0,g.jsxs)(y.Z,{className:s.bp,variant:"body2",color:"textSecondary",children:["width:".concat((0,j.getBpDisplayStr)(o.bpPerPx*n.width))," ",(0,g.jsx)("br",{}),"height:".concat((0,j.getBpDisplayStr)(r.bpPerPx*n.height))]}):null,(0,g.jsx)("div",{className:s.spacer}),(0,g.jsx)(R,{model:t}),i?(0,g.jsx)(q,{model:t}):null]})}));var Q=n(90903),ee=n(67765),te=n(63008),ne=n(71939),se=n(14564),oe=n(71579);const re=(0,l.ZL)()((e=>{return{tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,ne.Fq)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(12),lineHeight:"".concat((t=1.4,Math.round(1e5*t)/1e5),"em"),maxWidth:300,wordWrap:"break-word"}};var t})),ie={left:0,top:0,width:0,height:0},le=(0,r.observer)((function(e){var t;let{model:n,mouserect:o,mouserectClient:r,xdistance:i,ydistance:l}=e;const{classes:a}=re(),{hview:c,vview:d,viewHeight:h}=n,[u,m]=(0,s.useState)(null),x=(null===(t=(0,s.useRef)(null).current)||void 0===t?void 0:t.getBoundingClientRect())||ie,p=x.height+12,f=(0,s.useMemo)((()=>({getBoundingClientRect:()=>{const e=6+((null===r||void 0===r?void 0:r[0])||0)-(i<0?p:0),t=6+((null===r||void 0===r?void 0:r[1])||0)-(l<0?p:0);return{top:t,left:e,bottom:t,right:e,width:0,height:0,x:e,y:t,toJSON(){}}}})),[r,i,l,p]),{styles:v,attributes:y}=(0,oe.D)(f,u,{placement:i<0?"left":"right"});return(0,g.jsx)(g.Fragment,{children:o?(0,g.jsx)(se.h,{children:(0,g.jsxs)("div",{ref:m,className:a.tooltip,style:{...v.popper,zIndex:1e5},...y.popper,children:["x - ".concat((0,te.c4)(o[0],c)),(0,g.jsx)("br",{}),"y - ".concat((0,te.c4)(h-o[1],d)),(0,g.jsx)("br",{})]})}):null})})),ae=(0,r.observer)((function(e){let{model:t,mousedown:n,mousedownClient:o,xdistance:r,ydistance:i}=e;const{classes:l}=re(),{hview:a,vview:c,viewHeight:d}=t,[h,u]=(0,s.useState)(null),m=(0,s.useMemo)((()=>({getBoundingClientRect:()=>{const e=((null===o||void 0===o?void 0:o[0])||0)-0,t=((null===o||void 0===o?void 0:o[1])||0)-0;return{top:t,left:e,bottom:t,right:e,width:0,height:0,x:e,y:t,toJSON(){}}}})),[o,r,i]),{styles:x,attributes:p}=(0,oe.D)(m,h,{placement:r<0?"right":"left"});return(0,g.jsx)(g.Fragment,{children:n&&Math.abs(r)>3&&Math.abs(i)>3?(0,g.jsx)(se.h,{children:(0,g.jsxs)("div",{ref:u,className:l.tooltip,style:{...x.popper,zIndex:1e5},...p.popper,children:["x - ".concat((0,te.c4)(n[0],a)),(0,g.jsx)("br",{}),"y - ".concat((0,te.c4)(d-n[1],c)),(0,g.jsx)("br",{})]})}):null})})),ce={left:0,top:0,width:0,height:0},de=(0,l.ZL)()((e=>({spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})));function he(e,t){return e&&[e[0]-t.left,e[1]-t.top]}const ue=(0,r.observer)((e=>{let{model:t}=e;const{classes:n}=de();return(0,g.jsx)("div",{className:n.overlay,children:t.tracks.map((e=>{const[t]=e.displays,{RenderingComponent:n}=t;return n?(0,g.jsx)(n,{model:t},e.configuration.trackId):null}))})})),me=(0,r.observer)((function(e){var t,n;let{model:r}=e;const{classes:l}=de(),[a,d]=(0,s.useState)(),[h,u]=(0,s.useState)(),[m,x]=(0,s.useState)(!1),[p,f]=(0,s.useState)(),v=(0,s.useRef)(null),y=(0,s.useRef)(null),b=(0,s.useRef)(0),j=(0,s.useRef)(0),w=(0,s.useRef)(!1),[k,Z]=(0,s.useState)(!1),S=(null===(t=v.current)||void 0===t?void 0:t.getBoundingClientRect())||ce,C=(null===(n=v.current)||void 0===n?void 0:n.getBoundingClientRect())||ce,P=he(h,S),L=he(a,S),M=he(p,S),N=p||a,A=M||L,B=P&&A?A[0]-P[0]:0,z=P&&A?A[1]-P[1]:0,{hview:T,vview:R,wheelMode:D,cursorMode:I}=r,E="move"===I&&!k||"crosshair"===I&&k,F="move"===I&&k||"crosshair"===I&&!k;return(0,s.useEffect)((()=>{function e(e){const t=c()(e);e.preventDefault(),b.current+=t.pixelX,j.current-=t.pixelY,w.current||(w.current=!0,window.requestAnimationFrame((()=>{(0,i.transaction)((()=>{if("pan"===D)T.scroll(b.current/3),R.scroll(j.current/10);else if("zoom"===D&&Math.abs(j.current)>2*Math.abs(b.current)&&L){const e=j.current<0?1.1:.9;T.zoomTo(T.bpPerPx*e,L[0]),R.zoomTo(R.bpPerPx*e,C.height-L[1])}})),w.current=!1,b.current=0,j.current=0})))}if(v.current){const t=v.current;return t.addEventListener("wheel",e),()=>t.removeEventListener("wheel",e)}return()=>{}}),[T,R,D,L,C.height]),(0,s.useEffect)((()=>{function e(e){d([e.clientX,e.clientY]),a&&h&&E&&!p&&(T.scroll(-e.clientX+a[0]),R.scroll(e.clientY-a[1]))}return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)}),[E,a,h,I,k,p,T,R]),(0,s.useEffect)((()=>{function e(e){Math.abs(B)>3&&Math.abs(z)>3&&F?f([e.clientX,e.clientY]):u(void 0)}return P&&!M?(window.addEventListener("mouseup",e,!0),()=>window.removeEventListener("mouseup",e,!0)):()=>{}}),[F,P,L,M,B,z,k,I]),(0,g.jsxs)("div",{children:[(0,g.jsx)($,{model:r,selection:F&&P&&A?{width:Math.abs(B),height:Math.abs(z)}:void 0}),(0,g.jsxs)("div",{ref:y,className:l.root,onMouseLeave:()=>x(!1),onMouseEnter:()=>x(!0),children:[(0,g.jsxs)("div",{className:l.container,children:[(0,g.jsx)(ee.UL,{model:r}),(0,g.jsx)(ee.u_,{model:r}),(0,g.jsxs)("div",{ref:v,className:l.content,children:[m&&F?(0,g.jsx)(le,{model:r,mouserect:A,mouserectClient:N,xdistance:B,ydistance:z}):null,F?(0,g.jsx)(ae,{model:r,mousedown:P,mousedownClient:h,xdistance:B,ydistance:z}):null,(0,g.jsx)("div",{style:{cursor:k?"pointer":I},onMouseDown:e=>{if(0===e.button){const{clientX:t,clientY:n}=e;u([t,n]),d([t,n]),Z(e.ctrlKey)}},children:(0,g.jsx)(Q.Z,{model:r,children:F&&P&&A?(0,g.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(A[0],P[0]),y:Math.min(A[1],P[1]),width:Math.abs(B),height:Math.abs(z)}):null})}),(0,g.jsx)("div",{className:l.spacer})]}),(0,g.jsx)(ue,{model:r}),(0,g.jsx)(o.Menu,{open:Boolean(M),onMenuItemClick:(e,t)=>{t(),f(void 0),u(void 0)},onClose:()=>{f(void 0),u(void 0)},anchorReference:"anchorPosition",anchorPosition:p?{top:p[1]+50,left:p[0]+50}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:()=>{P&&M&&r.zoomIn(P,M),x(!1)}},{label:"Open linear synteny view",onClick:()=>{P&&M&&r.onDotplotView(P,M),x(!1)}}]})]}),(0,g.jsx)(o.ResizeHandle,{onDrag:e=>r.setHeight(r.height+e),className:l.resizeHandle})]})]})})),xe=(0,r.observer)((e=>{let{model:t}=e;const{initialized:n,loading:s,error:r}=t;return!n&&!s||r?(0,g.jsx)(B,{model:t}):s?(0,g.jsx)(o.LoadingEllipses,{variant:"h6"}):(0,g.jsx)(me,{model:t})}))},90903:(e,t,n)=>{n.d(t,{B:()=>i,Z:()=>l});n(41867);var s=n(3762),o=n(17280),r=n(80838);const i=(0,s.observer)((function(e){let{model:t,children:n}=e;const{viewWidth:s,viewHeight:i,hview:l,vview:a}=t,c=l.dynamicBlocks.contentBlocks,d=a.dynamicBlocks.contentBlocks;if(!c.length||!d.length)return null;const h=l.displayedRegionsTotalPx-l.offsetPx,u=a.displayedRegionsTotalPx-a.offsetPx,m=c[0].offsetPx-l.offsetPx,x=d[0].offsetPx-a.offsetPx,p=(0,o.Z)(),f=p.palette.divider,v=Math.max(m,0),y=Math.max(i-u,0),b=Math.min(h-m,s),j=Math.min(i-x-y,i);let g=1/0,w=1/0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:v,y:y,width:b,height:j,fill:p.palette.background.default}),(0,r.jsxs)("g",{children:[c.map((e=>{const t=e.offsetPx-l.offsetPx,n=Math.floor(t)!==Math.floor(g);return n&&(g=t),n?(0,r.jsx)("line",{x1:t,y1:0,x2:t,y2:i,stroke:f},JSON.stringify(e)):null})),d.map((e=>{const t=i-(e.offsetPx-a.offsetPx),n=Math.floor(t)!==Math.floor(w);return n&&(w=t),n?(0,r.jsx)("line",{x1:0,y1:t,x2:s,y2:t,stroke:f},JSON.stringify(e)):null})),(0,r.jsx)("line",{x1:h,y1:0,x2:h,y2:i,stroke:f}),(0,r.jsx)("line",{x1:0,y1:i-u,x2:s,y2:i-u,stroke:f})]}),n]})}));function l(e){let{model:t,children:n}=e;const{viewWidth:s,viewHeight:o}=t;return(0,r.jsx)("svg",{width:s,height:o,style:{background:"rgba(0,0,0,0.12)"},children:(0,r.jsx)(i,{model:t,children:n})})}}}]);
//# sourceMappingURL=1098.5a186784.chunk.js.map