"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8078],{78078:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var r=a(66204),n=a(80846),o=a(94926),s=a(32339),l=a(78781),c=a(35861),i=a(31211),d=a(80013),u=a(59602),m=a(63315),p=a(65404),g=a(64864),f=a(7146),h=a(32831),k=a(38684),b=a(88196),y=a(36349),Z=a(66159),E=a(46338),v=a(39780),w=a(70539),N=a(5930),x=a(43902),S=a(86636),C=a(60962),T=a(2331),A=a(75174),D=a(86600),M=a(74780),P=a(81799),I=a(49140),W=a(15971),R=a(97916);const j=(0,k.ZL)()((e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}}))),B=(0,n.observer)((function({model:e}){const{classes:t}=j(),[a,n]=(0,r.useState)(""),[o,s]=(0,r.useState)(""),[l,c]=(0,r.useState)(["Name","ID"]),[i,d]=(0,r.useState)(["CDS","exon"]),u=[{label:"Indexing attributes",values:l},{label:"Feature types to exclude",values:i}];return(0,r.useEffect)((()=>{e.setTextIndexingConf({attributes:l,exclude:i})}),[e,l,i]),r.createElement(S.Z,{className:t.paper},r.createElement(C.Z,null,"Indexing configuration"),u.map(((e,u)=>r.createElement(T.Z,{raised:!0,key:e.label,className:t.card},r.createElement(A.Z,null,r.createElement(C.Z,null,e.label),r.createElement(D.Z,{disablePadding:!0},e.values.map(((t,a)=>r.createElement(M.ZP,{key:a,disableGutters:!0},r.createElement(E.Z,{value:t,InputProps:{endAdornment:r.createElement(P.Z,{position:"end"},r.createElement(I.Z,{onClick:()=>{const t=e.values.filter(((e,t)=>t!==a));0===u?c(t):d(t)}},r.createElement(W.Z,null)))}})))),r.createElement(M.ZP,{disableGutters:!0},r.createElement(E.Z,{value:0===u?a:o,placeholder:"add new",onChange:e=>{0===u?n(e.target.value):s(e.target.value)},InputProps:{endAdornment:r.createElement(P.Z,{position:"end"},r.createElement(I.Z,{onClick:()=>{0===u?(c([...l,a]),n("")):(d([...i,o]),s(""))},disabled:0===u?""===a:""===o,"data-testid":"stringArrayAdd-Feat"},r.createElement(R.Z,null)))}}))))))))})),L=(0,k.ZL)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),O=(0,n.observer)((({model:e})=>{const{classes:t}=L(),{pluginManager:a}=(0,i.getEnv)(e),{trackType:n}=e,o=a.getTrackElements();return r.createElement(E.Z,{className:t.spacing,value:n,variant:"outlined",label:"Track type",helperText:"Select track type",select:!0,fullWidth:!0,onChange:t=>e.setTrackType(t.target.value),SelectProps:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}},o.map((({name:e,displayName:t})=>r.createElement(l.Z,{key:e,value:e},t))))}));var F=a(84644);const U=(0,k.ZL)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),$=(0,n.observer)((({model:e})=>{const{classes:t}=U(),{trackAdapter:a}=e,{pluginManager:n}=(0,i.getEnv)(e);return r.createElement(E.Z,{className:t.spacing,value:"UNKNOWN"!==a?.type?a?.type:"",label:"Adapter type",variant:"outlined",helperText:"Select an adapter type",select:!0,fullWidth:!0,onChange:t=>e.setAdapterHint(t.target.value),SelectProps:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}},Object.entries(function(e){const t={};return e.forEach((e=>{const a=e.adapterMetadata?.category||"Default";t[a]||(t[a]=[]),t[a].push(e)})),t}(n.getAdapterElements().filter((e=>!e.adapterMetadata?.hiddenFromGUI)))).map((([e,t])=>[r.createElement(F.Z,{key:e},e),t.map((e=>r.createElement(l.Z,{key:e.name,value:e.name},e.displayName)))])))})),J=(0,k.ZL)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function _({trackAdapter:e,trackType:t}){const{classes:a}=J(),{type:n,subadapter:o}=e;return"SNPCoverageAdapter"===n?r.createElement(d.Z,{className:a.spacing},"Selected ",r.createElement("code",null,t),". Using adapter ",r.createElement("code",null,n)," with subadapter ",r.createElement("code",null,o?.type),". Please enter a track name and, if necessary, update the track type."):r.createElement(d.Z,{className:a.spacing},"Using adapter ",r.createElement("code",null,n)," and guessing track type"," ",r.createElement("code",null,t),". Please enter a track name and, if necessary, update the track type.")}function G({model:e}){const{classes:t}=J();return r.createElement(r.Fragment,null,r.createElement(d.Z,{className:t.spacing},"JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",r.createElement(Z.Z,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse to see if they support this data type or"," ",r.createElement(Z.Z,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type."),r.createElement($,{model:e}))}const H=(0,n.observer)((function({model:e}){const{classes:t}=J(),[a,n]=(0,r.useState)(!0),s=(0,i.getSession)(e),{trackName:l,trackAdapter:c,trackType:u,warningMessage:m,adapterHint:p}=e;if((0,r.useEffect)((()=>{""===p&&c&&e.setAdapterHint(c.type)}),[p,c,c?.type,e]),e.unsupported)return r.createElement(d.Z,{className:t.spacing},"This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",r.createElement(Z.Z,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse or"," ",r.createElement(Z.Z,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type.");if(c?.type===N.UNKNOWN)return r.createElement(G,{model:e});if(!c?.type)return r.createElement(d.Z,null,"Could not recognize this data type.");const g=(0,i.isSupportedIndexingAdapter)(c?.type);return r.createElement("div",null,c?r.createElement(_,{trackAdapter:c,trackType:u}):null,m?r.createElement(d.Z,{style:{color:"orange"}},m):null,r.createElement(E.Z,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:l,onChange:t=>e.setTrackName(t.target.value),inputProps:{"data-testid":"trackNameInput"}}),r.createElement($,{model:e}),r.createElement(O,{model:e}),r.createElement(x.AssemblySelector,{session:s,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>e.setAssembly(t),TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),i.isElectron&&g&&r.createElement(o.Z,null,r.createElement(v.Z,{label:"Index track for text searching?",control:r.createElement(w.Z,{checked:a,onChange:t=>{n(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})),i.isElectron&&a&&g?r.createElement(B,{model:e}):null)})),V=(0,k.ZL)()((e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}}))),q=(0,n.observer)((function({model:e}){const{classes:t}=V(),a=(0,b.getRoot)(e);return r.createElement(S.Z,{className:t.paper},r.createElement(x.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),r.createElement("div",{className:t.spacer}),r.createElement(x.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a}))})),z=(0,k.ZL)()((e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}}))),K=["Enter track data","Confirm track type"],Y=(0,n.observer)((function({model:e}){const[t,a]=(0,r.useState)(0),{classes:n}=z(),{jobsManager:o}=(0,b.getRoot)(e),s=(0,i.getSession)(e),{assembly:l,trackAdapter:c,trackData:k,trackName:Z,trackType:E,textIndexTrack:v,textIndexingConf:w}=e,[N,x]=(0,r.useState)();async function S(){if(t!==K.length-1)return void a(t+1);const r=[`${Z.toLowerCase().replaceAll(" ","_")}-${Date.now()}`,s.adminMode?"":"-sessionTrack"].join(""),n=s.assemblyManager.get(l);if((0,i.isSessionWithAddTracks)(s))if(n&&c&&"UNKNOWN"!==c.type){if(s.addTrackConf({trackId:r,type:E,name:Z,assemblyNames:[l],adapter:{...c,sequenceAdapter:(0,y.getConf)(n,["sequence","adapter"])}}),e.view.showTrack?.(r),i.isElectron&&v&&(0,i.isSupportedIndexingAdapter)(c.type)){const e=Z+"-index",t={indexingParams:{...w||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[l],tracks:[r],indexType:"perTrack",name:e,timestamp:(new Date).toISOString()},name:e,cancelCallback:()=>o.abortJob()};o.queueJob(t)}e.clearData(),(0,i.isSessionModelWithWidgets)(s)&&s.hideWidget(e)}else x("Failed to add track.\nThe configuration of this file is not currently supported.");else x("Unable to add tracks to this model")}function C(){switch(t){case 0:return!k;case 1:return!(Z&&E&&c?.type&&l);default:return!0}}return r.createElement("div",{className:n.root},r.createElement(u.Z,{className:n.stepper,activeStep:t,orientation:"vertical"},K.map(((o,s)=>r.createElement(m.Z,{key:o},r.createElement(p.Z,null,o),r.createElement(g.Z,null,function(t){switch(t){case 0:return r.createElement(q,{model:e});case 1:return r.createElement(H,{model:e});default:return r.createElement(d.Z,null,"Unknown step")}}(s),r.createElement("div",{className:n.actionsContainer},r.createElement(f.Z,{disabled:0===t,onClick:()=>{x(void 0),a(t-1)},className:n.button},"Back"),r.createElement(f.Z,{disabled:C(),variant:"contained",color:"primary",onClick:S,className:n.button,"data-testid":"addTrackNextButton"},t===K.length-1?"Add":"Next")),N?r.createElement("div",{className:n.alertContainer},r.createElement(h.Z,{severity:"error"},N)):null))))))})),Q=(0,k.ZL)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),X=(0,n.observer)((function({model:e}){const{classes:t}=Q(),[a,n]=(0,r.useState)(""),[o,s]=(0,r.useState)();return r.createElement("div",null,o?r.createElement(x.ErrorMessage,{error:o}):null,r.createElement(E.Z,{multiline:!0,rows:10,value:a,onChange:e=>n(e.target.value),placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox}),r.createElement(f.Z,{variant:"contained",className:t.submit,onClick:()=>{try{s(void 0);const t=(0,i.getSession)(e),r=JSON.parse(a),n=Array.isArray(r)?r:[r];(0,i.isSessionWithAddTracks)(t)&&(0,i.isSessionModelWithWidgets)(t)&&(n.forEach((e=>t.addTrackConf(e))),n.forEach((t=>e.view.showTrack(t.trackId))),e.clearData(),t.hideWidget(e))}catch(e){console.error(e),s(e)}}},"Submit"))})),ee=(0,n.observer)((function({model:e}){const[t,a]=(0,r.useState)("Default add track workflow"),{pluginManager:n}=(0,i.getEnv)(e),d=n.getAddTrackWorkflowElements(),u={"Default add track workflow":Y,"Add track JSON":X,...Object.fromEntries(d.map((e=>[e.name,e.ReactComponent])))},m=u[t]?t:"Default add track workflow",p=u[m];return r.createElement(r.Fragment,null,r.createElement(o.Z,null,r.createElement(s.Z,{value:m,onChange:e=>a(e.target.value)},Object.keys(u).map((e=>r.createElement(l.Z,{key:e,value:e},e)))),r.createElement(c.Z,null,"Type of add track workflow")),r.createElement("br",null),r.createElement(p,{model:e}))}))},15971:(e,t,a)=>{var r=a(57739);t.Z=void 0;var n=r(a(53948)),o=a(43188);t.Z=(0,n.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},2331:(e,t,a)=>{a.d(t,{Z:()=>f});var r=a(30984),n=a(55559),o=a(66204),s=a(56317),l=a(58029),c=a(61125),i=a(57369),d=a(86636),u=a(17352),m=a(43188);const p=["className","raised"],g=(0,c.ZP)(d.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),f=o.forwardRef((function(e,t){const a=(0,i.Z)({props:e,name:"MuiCard"}),{className:o,raised:c=!1}=a,d=(0,n.Z)(a,p),f=(0,r.Z)({},a,{raised:c}),h=(e=>{const{classes:t}=e;return(0,l.Z)({root:["root"]},u.y,t)})(f);return(0,m.jsx)(g,(0,r.Z)({className:(0,s.Z)(h.root,o),elevation:c?8:void 0,ref:t,ownerState:f},d))}))},17352:(e,t,a)=>{a.d(t,{Z:()=>s,y:()=>o});var r=a(58109),n=a(95201);function o(e){return(0,n.ZP)("MuiCard",e)}const s=(0,r.Z)("MuiCard",["root"])},75174:(e,t,a)=>{a.d(t,{Z:()=>g});var r=a(30984),n=a(55559),o=a(66204),s=a(56317),l=a(58029),c=a(61125),i=a(57369),d=a(65160),u=a(43188);const m=["className","component"],p=(0,c.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),g=o.forwardRef((function(e,t){const a=(0,i.Z)({props:e,name:"MuiCardContent"}),{className:o,component:c="div"}=a,g=(0,n.Z)(a,m),f=(0,r.Z)({},a,{component:c}),h=(e=>{const{classes:t}=e;return(0,l.Z)({root:["root"]},d.N,t)})(f);return(0,u.jsx)(p,(0,r.Z)({as:c,className:(0,s.Z)(h.root,o),ownerState:f,ref:t},g))}))},65160:(e,t,a)=>{a.d(t,{N:()=>o,Z:()=>s});var r=a(58109),n=a(95201);function o(e){return(0,n.ZP)("MuiCardContent",e)}const s=(0,r.Z)("MuiCardContent",["root"])},66159:(e,t,a)=>{a.d(t,{Z:()=>v});var r=a(55559),n=a(30984),o=a(66204),s=a(56317),l=a(58029),c=a(40118),i=a(61125),d=a(57369),u=a(71948),m=a(81597),p=a(80013),g=a(29110),f=a(4860),h=a(73330);const k={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},b=({theme:e,ownerState:t})=>{const a=(e=>k[e]||e)(t.color),r=(0,f.DW)(e,`palette.${a}`,!1)||t.color,n=(0,f.DW)(e,`palette.${a}Channel`);return"vars"in e&&n?`rgba(${n} / 0.4)`:(0,h.Fq)(r,.4)};var y=a(43188);const Z=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],E=(0,i.ZP)(p.Z,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[`underline${(0,c.Z)(a.underline)}`],"button"===a.component&&t.button]}})((({theme:e,ownerState:t})=>(0,n.Z)({},"none"===t.underline&&{textDecoration:"none"},"hover"===t.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===t.underline&&(0,n.Z)({textDecoration:"underline"},"inherit"!==t.color&&{textDecorationColor:b({theme:e,ownerState:t})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===t.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${g.Z.focusVisible}`]:{outline:"auto"}}))),v=o.forwardRef((function(e,t){const a=(0,d.Z)({props:e,name:"MuiLink"}),{className:i,color:p="primary",component:f="a",onBlur:h,onFocus:b,TypographyClasses:v,underline:w="always",variant:N="inherit",sx:x}=a,S=(0,r.Z)(a,Z),{isFocusVisibleRef:C,onBlur:T,onFocus:A,ref:D}=(0,u.Z)(),[M,P]=o.useState(!1),I=(0,m.Z)(t,D),W=(0,n.Z)({},a,{color:p,component:f,focusVisible:M,underline:w,variant:N}),R=(e=>{const{classes:t,component:a,focusVisible:r,underline:n}=e,o={root:["root",`underline${(0,c.Z)(n)}`,"button"===a&&"button",r&&"focusVisible"]};return(0,l.Z)(o,g.w,t)})(W);return(0,y.jsx)(E,(0,n.Z)({color:p,className:(0,s.Z)(R.root,i),classes:v,component:f,onBlur:e=>{T(e),!1===C.current&&P(!1),h&&h(e)},onFocus:e=>{A(e),!0===C.current&&P(!0),b&&b(e)},ref:I,ownerState:W,variant:N,sx:[...Object.keys(k).includes(p)?[]:[{color:p}],...Array.isArray(x)?x:[x]]},S))}))},29110:(e,t,a)=>{a.d(t,{Z:()=>s,w:()=>o});var r=a(58109),n=a(95201);function o(e){return(0,n.ZP)("MuiLink",e)}const s=(0,r.Z)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"])}}]);
//# sourceMappingURL=8078.34d1c947.chunk.js.map