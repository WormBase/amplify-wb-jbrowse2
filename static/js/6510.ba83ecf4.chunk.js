"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6510,8422],{93384:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(68079),i=t(96234),o=t(30969),a=t(53276),u=t(26737),c=t(37574),s=(0,a.ZL)()((function(e){return{resizeBar:{background:e.palette.action.disabledBackground,height:12,position:"relative",overflow:"hidden"},tick:{position:"absolute",height:"100%",pointerEvents:"none",background:e.palette.action.disabled,width:1},hiddenTick:{position:"absolute",height:"100%",width:5}}}));function l(e){var n=e.left,t=e.scrollLeft,r=e.idx,i=e.onDrag,a=e.onMouseDown,l=s().classes,d=(0,o.useCallback)((function(e,n){return i(e,n,r)}),[r,i]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(u.Z,{onDrag:d,onMouseDown:a,vertical:!0,className:l.hiddenTick,style:{left:n-t-2.5}}),(0,c.jsx)("div",{style:{left:n-t},className:l.tick})]})}function d(e){for(var n=e.widths,t=e.setWidths,a=e.checkbox,u=e.scrollLeft,d=void 0===u?0:u,f=s().classes,h=[],m=(0,o.useState)(),v=(0,i.Z)(m,2),p=v[0],g=v[1],Z=a?52:0,x=0;x<n.length;x++){var j=n[x];h[x]=j+Z,Z+=j}return(0,c.jsx)("div",{className:f.resizeBar,children:h.map((function(e,i){return(0,c.jsx)(l,{onMouseDown:function(){g((0,r.Z)(n))},left:i===h.length-1?e-3:e,onDrag:function(e,i,o){var a=(0,r.Z)(n);a[o]=Math.max(p[o]-i,50),t(a)},idx:i,scrollLeft:d},i)}))})}},34298:function(e,n,t){t.d(n,{x:function(){return o}});var r=t(96234),i=t(30969);function o(){var e=(0,i.useRef)(null),n=(0,i.useState)(0),t=(0,r.Z)(n,2),o=t[0],a=t[1];return(0,i.useEffect)((function(){var n=setInterval((function(){var n,t=null===(n=e.current)||void 0===n?void 0:n.querySelector(".MuiDataGrid-virtualScroller");t&&a(t.scrollLeft)}),100);return function(){clearInterval(n)}}),[]),{ref:e,scrollLeft:o}}},56988:function(e,n,t){t.r(n),t.d(n,{default:function(){return V}});var r=t(33028),i=t(30969),o=t(59071),a=t(59767),u=t(90550),c=t(68079),s=t(56666),l=t(96234),d=t(94551),f=t(90689),h=t(40909),m=t(59563),v=t(88399),p=t(97891),g=t(36174),Z=t(76770),x=t(93384),j=t(81073),b=t(9077),w=t(28722),k=t(94957),C=t(3994),S=t(87006),y=t(4953),E=t(44181),M=t(37973),T=t(68187),L=t(37574);function O(e){var n=e.setFilterText,t=e.setUseShoppingCart,r=e.setHideSparse,o=e.setShowOptions,u=e.showOptions,c=e.hideSparse,s=e.useShoppingCart,f=e.filterText,h=e.model,m=(0,i.useState)(null),v=(0,l.Z)(m,2),p=v[0],g=v[1];return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(C.ZP,{container:!0,spacing:4,alignItems:"center",children:[(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(S.Z,{label:"Search...",value:f,onChange:function(e){return n(e.target.value)},InputProps:{endAdornment:(0,L.jsx)(y.Z,{position:"end",children:(0,L.jsx)(d.Z,{onClick:function(){return n("")},children:(0,L.jsx)(E.Z,{})})})}})}),(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(d.Z,{onClick:function(e){return g(e.currentTarget)},children:(0,L.jsx)(M.Z,{})})}),(0,L.jsx)(C.ZP,{item:!0,children:(0,L.jsx)(T.Z,{model:h})})]}),(0,L.jsx)(a.Menu,{anchorEl:p,open:!!p,onClose:function(){return g(null)},onMenuItemClick:function(e,n){n(),g(null)},menuItems:[{label:"Add tracks to selection instead of turning them on/off",onClick:function(){return t(!s)},type:"checkbox",checked:s},{label:"Hide sparse metadata columns",onClick:function(){return r(!c)},checked:c,type:"checkbox"},{label:"Show extra table options",onClick:function(){return o(!u)},checked:u,type:"checkbox"}]})]})}var R=t(41361),H=t(87535),W=t(33359),I=t(6779),G=t(70983),N=t(53276),D=t(20331),P=t(3715),F=(0,N.ZL)()((function(e){return{facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}}}));function z(e){var n=e.column,t=e.vals,r=e.width,o=e.dispatch,a=e.filters,u=F().classes,c=(0,i.useState)(!0),s=(0,l.Z)(c,2),f=s[0],h=s[1];return(0,L.jsxs)(H.Z,{className:u.facet,style:{width:r},children:[(0,L.jsxs)("div",{style:{display:"flex"},children:[(0,L.jsx)(W.Z,{children:n.field}),(0,L.jsx)(I.Z,{title:"Clear selection on this facet filter",children:(0,L.jsx)(d.Z,{onClick:function(){o({key:n.field,val:[]})},size:"small",children:(0,L.jsx)(E.Z,{})})}),(0,L.jsx)(I.Z,{title:"Minimize/expand this facet filter",children:(0,L.jsx)(d.Z,{onClick:function(){return h(!f)},size:"small",children:f?(0,L.jsx)(D.Z,{}):(0,L.jsx)(P.Z,{})})})]}),f?(0,L.jsx)(G.Z,{multiple:!0,native:!0,className:u.select,value:a[n.field],onChange:function(e){for(var t=e.target.options,r=[],i=t.length,a=0;a<i;a++)t[a].selected&&r.push(t[a].value);o({key:n.field,val:r})},children:t.sort((function(e,n){return e[0].localeCompare(n[0])})).map((function(e){var n=(0,l.Z)(e,2),t=n[0],r=n[1];return(0,L.jsxs)("option",{value:t,children:[t," (",r,")"]},t)}))}):null]},n.field)}function B(e){var n,t=e.rows,r=e.columns,i=e.dispatch,o=e.filters,a=e.width,u=r.slice(1),s=u.map((function(){return new Map})),d=(0,R.Z)(t);try{for(d.s();!(n=d.n()).done;){var f,h=n.value,m=(0,R.Z)(u.entries());try{for(m.s();!(f=m.n()).done;){var v=(0,l.Z)(f.value,2),p=v[0],g=v[1],Z=s[p],x="".concat(h[g.field]||""),j=Z.get(x);x&&(void 0===j?Z.set(x,1):Z.set(x,j+1))}}catch(b){m.e(b)}finally{m.f()}}}catch(b){d.e(b)}finally{d.f()}return(0,L.jsx)("div",{children:u.map((function(e,n){return(0,L.jsx)(z,{vals:(0,c.Z)(s[n]),column:e,width:a,dispatch:i,filters:o},e.field)}))})}var _=t(34298),A=["category","adapter","description"],X=.75,U=(0,u.observer)((function(e){var n,t,o=e.model,u=o.view,C=o.selection,S=(0,j.getEnv)(o).pluginManager,y=(0,_.x)(),E=y.ref,M=y.scrollLeft,T=(0,i.useState)(""),R=(0,l.Z)(T,2),H=R[0],W=R[1],I=(0,i.useState)(!1),G=(0,l.Z)(I,2),N=G[0],D=G[1],P=(0,i.useState)(),F=(0,l.Z)(P,2),z=F[0],U=F[1],V=(0,i.useState)(!1),Y=(0,l.Z)(V,2),q=Y[0],$=Y[1],J=(0,i.useState)(!0),K=(0,l.Z)(J,2),Q=K[0],ee=K[1],ne=(0,i.useState)(400),te=(0,l.Z)(ne,2),re=te[0],ie=te[1],oe=(0,j.getSession)(o),ae=(0,j.useDebounce)(H,400),ue=u.tracks,ce=(0,i.useReducer)((function(e,n){return(0,r.Z)((0,r.Z)({},e),{},(0,s.Z)({},n.key,n.val))}),{}),se=(0,l.Z)(ce,2),le=se[0],de=se[1],fe=(0,i.useMemo)((function(){return o.trackConfigurations.filter((function(e){return(0,k.wB)(ae,e,oe)})).map((function(e){var n,t,i=(0,b.readConfObject)(e,"metadata");return(0,r.Z)({id:e.trackId,conf:e,name:(0,p.getTrackName)(e,oe),category:null===(n=(0,b.readConfObject)(e,"category"))||void 0===n?void 0:n.join(", "),adapter:null===(t=(0,b.readConfObject)(e,"adapter"))||void 0===t?void 0:t.type,description:(0,b.readConfObject)(e,"description"),metadata:i},i)}))}),[o,ae,oe]),he=(0,i.useMemo)((function(){return A.filter((function(e){return!Q||fe.map((function(n){return n[e]})).filter((function(e){return!!e})).length>5}))}),[Q,fe]),me=(0,i.useMemo)((function(){return(0,c.Z)(new Set(fe.flatMap((function(e){return n=e.metadata,Object.entries(n).map((function(e){var n=(0,l.Z)(e,2),t=n[0];return"string"===typeof n[1]?t:""})).filter((function(e){return!!e}));var n})))).filter((function(e){return!Q||fe.map((function(n){return n.metadata[e]})).filter((function(e){return!!e})).length>5}))}),[Q,fe]),ve=(0,i.useMemo)((function(){return["name"].concat((0,c.Z)(he),(0,c.Z)(me))}),[he,me]),pe=(0,i.useState)((0,r.Z)((0,r.Z)({name:(0,j.measureGridWidth)(fe.map((function(e){return e.name})),{maxWidth:500,stripHTML:!0})+15},Object.fromEntries(he.map((function(e){return[e,(0,j.measureGridWidth)(fe.map((function(n){return n[e]})),{maxWidth:400,stripHTML:!0})]})))),Object.fromEntries(me.map((function(e){return[e,(0,j.measureGridWidth)(fe.map((function(n){return n.metadata[e]})),{maxWidth:400,stripHTML:!0})]}))))),ge=(0,l.Z)(pe,2),Ze=ge[0],xe=ge[1],je=(0,i.useState)(Object.fromEntries(ve.map((function(e){return[e,!0]})))),be=(0,l.Z)(je,2),we=be[0],ke=be[1];(0,i.useEffect)((function(){ke((function(e){return(0,r.Z)((0,r.Z)({},Object.fromEntries(ve.map((function(e){return[e,!0]})))),e)}))}),[ve]),(0,i.useEffect)((function(){xe((function(e){return(0,r.Z)((0,r.Z)({name:e.name},Object.fromEntries(he.filter((function(e){return we[e]})).map((function(e){return[e,(0,j.measureGridWidth)(fe.map((function(n){return n[e]})),{stripHTML:!0,maxWidth:400})]})))),Object.fromEntries(me.filter((function(e){return we[e]})).map((function(e){return[e,(0,j.measureGridWidth)(fe.map((function(n){return n.metadata[e]})),{stripHTML:!0,maxWidth:400})]}))))}))}),[me,we,he,Q,fe]);var Ce=(0,j.useDebounce)(Ze,400),Se=[{field:"name",hideable:!1,renderCell:function(e){var n=e.value,t=e.id,r=e.row;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(g.Z,{html:n}),(0,L.jsx)(d.Z,{onClick:function(e){return U({target:e.currentTarget,id:t,conf:r.conf})},children:(0,L.jsx)(w.Z,{})})]})},width:null!==(n=Ce.name)&&void 0!==n?n:100}].concat((0,c.Z)(he.map((function(e){var n;return{field:e,width:null!==(n=Ce[e])&&void 0!==n?n:100,renderCell:function(e){var n=e.value;return n?(0,L.jsx)(g.Z,{html:n}):""}}}))),(0,c.Z)(me.map((function(e){var n;return{field:e,width:null!==(n=Ce[e])&&void 0!==n?n:100,renderCell:function(e){var n=e.value;return n?(0,L.jsx)(g.Z,{html:n}):""}}})))),ye=ue.map((function(e){return e.configuration.trackId})),Ee=Object.entries(le).filter((function(e){return e[1].length>0}));return(0,L.jsxs)(L.Fragment,{children:[z?(0,L.jsx)(Z.Z,{anchorEl:null===z||void 0===z?void 0:z.target,menuItems:(null===(t=oe.getTrackActionMenuItems)||void 0===t?void 0:t.call(oe,z.conf))||[],onMenuItemClick:function(e,n){n(),U(void 0)},open:!!z,onClose:function(){return U(void 0)}}):null,(0,L.jsx)(O,{setHideSparse:ee,setShowOptions:D,setFilterText:W,setUseShoppingCart:$,hideSparse:Q,showOptions:N,filterText:H,useShoppingCart:q,model:o}),(0,L.jsxs)("div",{ref:E,style:{display:"flex",overflow:"hidden",height:window.innerHeight*X,width:window.innerWidth*X},children:[(0,L.jsxs)("div",{style:{height:window.innerHeight*X,width:window.innerWidth*X-re},children:[(0,L.jsx)(x.Z,{checkbox:!0,widths:Object.values(Ze).map((function(e){return null!==e&&void 0!==e?e:100})),setWidths:function(e){return xe(Object.fromEntries(Object.entries(Ze).map((function(n,t){return[n[0],e[t]]}))))},scrollLeft:M}),(0,L.jsx)(m._$,{rows:fe.filter((function(e){return Ee.every((function(n){var t=(0,l.Z)(n,2),r=t[0];return t[1].includes(e[r])}))})),columnVisibilityModel:we,onColumnVisibilityModelChange:function(e){return ke(e)},columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,onRowSelectionModelChange:function(e){if(q){var n=(0,h.getRoot)(o),t=S.pluggableConfigSchemaType("track"),r=e.map((function(e){return(0,h.resolveIdentifier)(t,n,e)}));o.setSelection(r)}else{var i=ye,a=e;(0,f.transaction)((function(){i.filter((function(e){return!a.includes(e)})).map((function(e){return u.hideTrack(e)})),a.filter((function(e){return!i.includes(e)})).map((function(e){return u.showTrack(e)}))}))}},rowSelectionModel:q?C.map((function(e){return e.trackId})):ye,slots:{toolbar:N?v.n:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:Se,rowHeight:25})]}),(0,L.jsx)(a.ResizeHandle,{vertical:!0,onDrag:function(e){return ie(re-e)},style:{background:"grey",width:5}}),(0,L.jsx)("div",{style:{width:re,overflowY:"auto",overflowX:"hidden"},children:(0,L.jsx)(B,{width:re-10,rows:fe,columns:Se,dispatch:de,filters:le})})]})]})})),V=(0,u.observer)((function(e){var n=e.handleClose;return(0,L.jsx)(a.Dialog,{open:!0,onClose:n,maxWidth:"xl",title:"Faceted track selector",children:(0,L.jsx)(o.Z,{children:(0,L.jsx)(U,(0,r.Z)({},e))})})}))},71127:function(e,n,t){t.d(n,{d:function(){return s}});var r=t(30969),i=t(14006),o=t(34604),a=t(4422),u=t(37574);function c(e){return e.substring(2).toLowerCase()}function s(e){var n=e.children,t=e.disableReactTree,s=void 0!==t&&t,l=e.mouseEvent,d=void 0===l?"onClick":l,f=e.onClickAway,h=e.touchEvent,m=void 0===h?"onTouchEnd":h,v=r.useRef(!1),p=r.useRef(null),g=r.useRef(!1),Z=r.useRef(!1);r.useEffect((function(){return setTimeout((function(){g.current=!0}),0),function(){g.current=!1}}),[]);var x=(0,i.Z)(n.ref,p),j=(0,o.Z)((function(e){var n=Z.current;Z.current=!1;var t=(0,a.Z)(p.current);!g.current||!p.current||"clientX"in e&&function(e,n){return n.documentElement.clientWidth<e.clientX||n.documentElement.clientHeight<e.clientY}(e,t)||(v.current?v.current=!1:(e.composedPath?e.composedPath().indexOf(p.current)>-1:!t.documentElement.contains(e.target)||p.current.contains(e.target))||!s&&n||f(e))})),b=function(e){return function(t){Z.current=!0;var r=n.props[e];r&&r(t)}},w={ref:x};return!1!==m&&(w[m]=b(m)),r.useEffect((function(){if(!1!==m){var e=c(m),n=(0,a.Z)(p.current),t=function(){v.current=!0};return n.addEventListener(e,j),n.addEventListener("touchmove",t),function(){n.removeEventListener(e,j),n.removeEventListener("touchmove",t)}}}),[j,m]),!1!==d&&(w[d]=b(d)),r.useEffect((function(){if(!1!==d){var e=c(d),n=(0,a.Z)(p.current);return n.addEventListener(e,j),function(){n.removeEventListener(e,j)}}}),[j,d]),(0,u.jsx)(r.Fragment,{children:r.cloneElement(n,w)})}},56277:function(e,n,t){var r=t(56666),i=t(31461),o=t(7896),a=t(30969),u=t(87023),c=t(26540),s=t(17363),l=t(45971),d=t(6856),f=t(37574),h=["className","component","disableGutters","variant"],m=(0,l.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,!t.disableGutters&&n.gutters,n[t.variant]]}})((function(e){var n=e.theme,t=e.ownerState;return(0,o.Z)({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&(0,r.Z)({paddingLeft:n.spacing(2),paddingRight:n.spacing(2)},n.breakpoints.up("sm"),{paddingLeft:n.spacing(3),paddingRight:n.spacing(3)}),"dense"===t.variant&&{minHeight:48})}),(function(e){var n=e.theme;return"regular"===e.ownerState.variant&&n.mixins.toolbar})),v=a.forwardRef((function(e,n){var t=(0,s.Z)({props:e,name:"MuiToolbar"}),r=t.className,a=t.component,l=void 0===a?"div":a,v=t.disableGutters,p=void 0!==v&&v,g=t.variant,Z=void 0===g?"regular":g,x=(0,i.Z)(t,h),j=(0,o.Z)({},t,{component:l,disableGutters:p,variant:Z}),b=function(e){var n=e.classes,t={root:["root",!e.disableGutters&&"gutters",e.variant]};return(0,c.Z)(t,d.N,n)}(j);return(0,f.jsx)(m,(0,o.Z)({as:l,className:(0,u.Z)(b.root,r),ref:n,ownerState:j},x))}));n.Z=v},6856:function(e,n,t){t.d(n,{N:function(){return o}});var r=t(62746),i=t(2975);function o(e){return(0,i.Z)("MuiToolbar",e)}var a=(0,r.Z)("MuiToolbar",["root","gutters","regular","dense"]);n.Z=a}}]);
//# sourceMappingURL=6510.ba83ecf4.chunk.js.map