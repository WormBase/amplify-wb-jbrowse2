"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[933],{50933:function(e,t,r){r.d(t,{Z:function(){return z}});var n,a=r(96234),s=r(32723),i=r(34795),u=r(33028),o=r(9249),c=r(87371),h=r(30249),f=r(98288),l=r(69621),v=r(52809),p=r(43245),d=r.n(p),k=r(89410),b=r.n(k),m=r(68079),x=r(61418);function y(e,t){return(n=n||(0,i.Z)((0,s.Z)().mark((function e(t,r){var n,a,i,u=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(u.length>2&&void 0!==u[2]?u[2]:{}).defaultContent,a=void 0===n?{}:n,e.prev=2,e.next=5,r(t,{encoding:"utf8"});case 5:return i=e.sent,e.abrupt("return",JSON.parse(i));case 9:if(e.prev=9,e.t0=e.catch(2),"ENOENT"!==e.t0.code&&404!==e.t0.status){e.next=13;break}return e.abrupt("return",a);case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var g=function(e){function t(e){var r=e.readFile,n=e.cacheSize,a=void 0===n?100:n;if((0,o.Z)(this,t),this.topList=[],this.chunkCache=new(b())({cache:new(d())({maxSize:a}),fill:this.readChunkItems.bind(this)}),this.readFile=r,!this.readFile)throw new Error('must provide a "readFile" function')}return(0,c.Z)(t,[{key:"importExisting",value:function(e,t,r,n,a){this.topList=e,this.attrs=t,this.start=t.makeFastGetter("Start"),this.end=t.makeFastGetter("End"),this.lazyClass=a,this.baseURL=r,this.lazyUrlTemplate=n}},{key:"binarySearch",value:function(e,t,r){for(var n,a=-1,s=e.length;s-a>1;)r(e[n=a+s>>>1])>=t?s=n:a=n;return r===this.end?s:a}},{key:"readChunkItems",value:function(e){return y(v.resolve(this.baseURL,this.lazyUrlTemplate.replace(/\{Chunk\}/gi,e)),this.readFile,{defaultContent:[]})}},{key:"iterateSublist",value:function(e,t,r,n,i,u,o){var c=this;return(0,f.Z)((0,s.Z)().mark((function f(){var v,p,d,k,b,y,g,w,Z,C;return(0,s.Z)().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:v=c.attrs.makeGetter("Chunk"),p=c.attrs.makeGetter("Sublist"),d=[],k=(0,s.Z)().mark((function a(){var f,k,m;return(0,s.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e[b][0]!==c.lazyClass){a.next=6;break}f=v(e[b]),k=c.chunkCache.get(f,f).then((function(e){return[e,f]})),d.push(k),a.next=8;break;case 6:return a.next=8,[e[b],o.concat(b)];case 8:if(!(m=p(e[b]))){a.next=11;break}return a.delegateYield((0,x.Z)((0,l.Z)(c.iterateSublist(m,t,r,n,i,u,o.concat(b))),h.Z),"t0",11);case 11:case"end":return a.stop()}}),a)})),b=c.binarySearch(e,t,i);case 5:if(!(b<e.length&&b>=0&&n*u(e[b])<n*r)){f.next=10;break}return f.delegateYield(k(),"t0",7);case 7:b+=n,f.next=5;break;case 10:y=0;case 11:if(!(y<d.length)){f.next=23;break}return f.next=14,(0,h.Z)(d[y]);case 14:if(g=f.sent,w=(0,a.Z)(g,2),Z=w[0],C=w[1],!Z){f.next=20;break}return f.delegateYield((0,x.Z)((0,l.Z)(c.iterateSublist(Z,t,r,n,i,u,[].concat((0,m.Z)(o),[C]))),h.Z),"t1",20);case 20:y+=1,f.next=11;break;case 23:case"end":return f.stop()}}),f)})))()}},{key:"iterate",value:function(e,t){var r=this;return(0,f.Z)((0,s.Z)().mark((function n(){var a,i,u;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e>t?-1:1,i=e>t?r.start:r.end,u=e>t?r.end:r.start,!(r.topList.length>0)){n.next=5;break}return n.delegateYield((0,x.Z)((0,l.Z)(r.iterateSublist(r.topList,e,t,a,i,u,[0])),h.Z),"t0",5);case 5:case"end":return n.stop()}}),n)})))()}},{key:"histogram",value:function(t,r,n){return(e=e||(0,i.Z)((0,s.Z)().mark((function e(t,r,n){var a,i,u,o,c,h,f,v,p,d,k;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=new Array(n)).fill(0),i=(r-t)/n,u=!1,o=!1,e.prev=5,h=(0,l.Z)(this.iterate(t,r));case 7:return e.next=9,h.next();case 9:if(!(u=!(f=e.sent).done)){e.next=17;break}for(v=f.value,p=Math.max(0,(this.start(v)-t)/i|0),d=Math.min(n,(this.end(v)-t)/i|0),k=p;k<=d;k+=1)a[k]+=1;case 14:u=!1,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),o=!0,c=e.t0;case 23:if(e.prev=23,e.prev=24,!u||null==h.return){e.next=28;break}return e.next=28,h.return();case 28:if(e.prev=28,!o){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.abrupt("return",a);case 34:case"end":return e.stop()}}),e,this,[[5,19,23,33],[24,,28,32]])})))).apply(this,arguments)}}]),t}(),w=function(){function e(t){(0,o.Z)(this,e),this.classes=t,this.fields=[];for(var r=0;r<t.length;r+=1){this.fields[r]={};for(var n=0;n<t[r].attributes.length;n+=1)this.fields[r][t[r].attributes[n]]=n+1;void 0===t[r].proto&&(t[r].proto={}),void 0===t[r].isArrayAttr&&(t[r].isArrayAttr={})}}return(0,c.Z)(e,[{key:"attrIndices",value:function(e){return this.classes.map((function(t){return t.attributes.indexOf(e)+1||t.attributes.indexOf(e.toLowerCase())+1||void 0}))}},{key:"get",value:function(e,t){if(t in this.fields[e[0]])return e[this.fields[e[0]][t]];var r=t.toLowerCase();if(r in this.fields[e[0]])return e[this.fields[e[0]][r]];var n=this.classes[e[0]].attributes.length+1;return n>=e.length||!(t in e[n])?t in this.classes[e[0]].proto?this.classes[e[0]].proto[t]:void 0:e[n][t]}},{key:"makeSetter",value:function(e){var t=this;return function(r,n){t.set(r,e,n)}}},{key:"makeGetter",value:function(e){var t=this;return function(r){return t.get(r,e)}}},{key:"makeFastGetter",value:function(e){var t=this.attrIndices(e);return function(e){if(void 0!==t[e[0]])return e[t[e[0]]]}}},{key:"accessors",value:function(){return this._accessors||(this._accessors=this._makeAccessors()),this._accessors}},{key:"_makeAccessors",value:function(){var e={},t={get:function(e){var t=this.get.field_accessors[e.toLowerCase()];if(t)return t.call(this)},set:function(e,t){var r=this.set.field_accessors[e];if(r)return r.call(this,t)},tags:function(){return r[this[0]]||[]}};t.get.field_accessors={},t.set.field_accessors={},this.classes.forEach((function(t,r){(t.attributes||[]).forEach((function(t,n){e[t]=e[t]||[],e[t][r]=n+1,t=t.toLowerCase(),e[t]=e[t]||[],e[t][r]=n+1}))}));var r=this.classes.map((function(e){return e.attributes}));return Object.keys(e).forEach((function(r){var n=e[r];t.get.field_accessors[r]=n?function(){return this[n[this[0]]]}:function(){}})),t}}]),e}(),Z=function(e){function t(e,r){var n=e.urlTemplate,a=e.chunkSize,s=e.length,i=e.cacheSize,u=void 0===i?100:i,c=e.readFile;if((0,o.Z)(this,t),this.urlTemplate=n,this.chunkSize=a,this.length=s,this.baseUrl=void 0===r?"":r,this.readFile=c,!c)throw new Error("must provide readFile callback");this.chunkCache=new(b())({cache:new(d())({maxSize:u}),fill:this.getChunk.bind(this)})}return(0,c.Z)(t,[{key:"index",value:function(e,t,r){this.range(e,e,t,void 0,r)}},{key:"range",value:function(e,t){var r=this;return(0,f.Z)((0,s.Z)().mark((function n(){var i,u,o,c,f,v,p,d,k;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(e=Math.max(0,e),t=Math.min(t,r.length-1),i=Math.floor(e/r.chunkSize),u=Math.floor(t/r.chunkSize),o=[],c=i;c<=u;c+=1)o.push(r.chunkCache.get(c,c));f=0;case 7:if(!(f<o.length)){n.next=18;break}return n.next=10,(0,h.Z)(o[f]);case 10:return v=n.sent,p=(0,a.Z)(v,2),d=p[0],k=p[1],n.delegateYield((0,x.Z)((0,l.Z)(r.filterChunkData(e,t,d,k)),h.Z),"t0",15);case 15:f+=1,n.next=7;break;case 18:case"end":return n.stop()}}),n)})))()}},{key:"getChunk",value:function(t){return(e=e||(0,i.Z)((0,s.Z)().mark((function e(t){var r,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.urlTemplate.replace(/\{Chunk\}/gi,t),this.baseUrl&&(r=v.resolve(this.baseUrl,r)),e.next=4,y(r,this.readFile);case 4:return n=e.sent,e.abrupt("return",[t,n]);case 6:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"filterChunkData",value:(0,s.Z)().mark((function e(t,r,n,a){var i,u,o,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n*this.chunkSize,u=Math.max(0,t-i),o=Math.min(r-i,this.chunkSize-1),c=u;case 4:if(!(c<=o)){e.next=10;break}return e.next=7,[c+i,a[c]];case 7:c+=1,e.next=4;break;case 10:case"end":return e.stop()}}),e,this)}))}]),t}();function C(){return this._uniqueID}function S(){return this._parent}function _(){return this.get("subfeatures")}var F=function(e,t){function r(e){var t=e.baseUrl,n=e.urlTemplate,a=e.readFile,s=e.cacheSize,i=void 0===s?10:s;if((0,o.Z)(this,r),this.baseUrl=t,this.urlTemplates={root:n},this.readFile=a,!this.readFile)throw new Error('must provide a "readFile" function argument');this.dataRootCache=new(b())({cache:new(d())({maxSize:i}),fill:this.fetchDataRoot.bind(this)})}return(0,c.Z)(r,[{key:"makeNCList",value:function(){return new g({readFile:this.readFile})}},{key:"loadNCList",value:function(e,t,r){e.nclist.importExisting(t.intervals.nclist,e.attrs,r,t.intervals.urlTemplate,t.intervals.lazyClass)}},{key:"getDataRoot",value:function(e){return this.dataRootCache.get(e,e)}},{key:"fetchDataRoot",value:function(e){var t=this,r=v.resolve(this.baseUrl,this.urlTemplates.root.replace(/{\s*refseq\s*}/g,e));return y(r,this.readFile).then((function(e){return t.parseTrackInfo(e,r)}))}},{key:"parseTrackInfo",value:function(e,t){var r={nclist:this.makeNCList(),stats:{featureCount:e.featureCount||0}};e.intervals&&(r.attrs=new w(e.intervals.classes),this.loadNCList(r,e,t));var n=e.histograms;if(n&&n.meta){for(var a=0;a<n.meta.length;a+=1)n.meta[a].lazyArray=new Z((0,u.Z)((0,u.Z)({},n.meta[a].arrayParams),{},{readFile:this.readFile}),t);r._histograms=n}return r._histograms&&Object.keys(r._histograms).forEach((function(e){r._histograms[e].forEach((function(e){Object.keys(e).forEach((function(t){"string"===typeof e[t]&&String(Number(e[t]))===e[t]&&(e[t]=Number(e[t]))}))}))})),r}},{key:"getRegionStats",value:function(t){return(e=e||(0,i.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDataRoot(t.ref);case 2:return r=e.sent,e.abrupt("return",r.stats);case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"getRegionFeatureDensities",value:function(e){return(t=t||(0,i.Z)((0,s.Z)().mark((function e(t){var r,n,i,u,o,c,h,f,v,p,d,k,b,m,x,y,g,w,Z,C,S,_,F;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.refName,n=t.start,i=t.end,u=t.numBins,o=t.basesPerBin,e.next=3,this.getDataRoot(r);case 3:if(c=e.sent,!u){e.next=8;break}o=(i-n)/u,e.next=13;break;case 8:if(!o){e.next=12;break}u=Math.ceil((i-n)/o),e.next=13;break;case 12:throw new TypeError("numBins or basesPerBin arg required for getRegionFeatureDensities");case 13:for(h=c._histograms.stats||[],f=h.find((function(e){return e.basesPerBin>=o})),v=c._histograms.meta[0],p=0;p<c._histograms.meta.length;p+=1)o>=c._histograms.meta[p].basesPerBin&&(v=c._histograms.meta[p]);if(!((d=o/v.basesPerBin)>.9&&Math.abs(d-Math.round(d))<1e-4)){e.next=52;break}for(k=Math.floor(n/v.basesPerBin),d=Math.round(d),b=[],m=0;m<u;m+=1)b[m]=0;x=!1,y=!1,e.prev=25,w=(0,l.Z)(v.lazyArray.range(k,k+d*u-1));case 27:return e.next=29,w.next();case 29:if(!(x=!(Z=e.sent).done)){e.next=35;break}C=(0,a.Z)(Z.value,2),S=C[0],_=C[1],b[Math.floor((S-k)/d)]+=_;case 32:x=!1,e.next=27;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(25),y=!0,g=e.t0;case 41:if(e.prev=41,e.prev=42,!x||null==w.return){e.next=46;break}return e.next=46,w.return();case 46:if(e.prev=46,!y){e.next=49;break}throw g;case 49:return e.finish(46);case 50:return e.finish(41);case 51:return e.abrupt("return",{bins:b,stats:f});case 52:return e.next=54,c.nclist.histogram(n,i,u);case 54:return F=e.sent,e.abrupt("return",{bins:F,stats:f});case 56:case"end":return e.stop()}}),e,this,[[25,37,41,51],[42,,46,50]])})))).apply(this,arguments)}},{key:"getFeatures",value:function(e){var t=this,r=e.refName,n=e.start,i=e.end;return(0,f.Z)((0,s.Z)().mark((function e(){var u,o,c,f,v,p,d,k,b,m,x;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.Z)(t.getDataRoot(r));case 2:u=e.sent,o=u.attrs&&u.attrs.accessors(),c=!1,f=!1,e.prev=6,p=(0,l.Z)(u.nclist.iterate(n,i));case 8:return e.next=10,(0,h.Z)(p.next());case 10:if(!(c=!(d=e.sent).done)){e.next=18;break}return k=(0,a.Z)(d.value,2),b=k[0],m=k[1],b.decorated||(x=m.join(","),t.decorateFeature(o,b,"".concat(r,",").concat(x))),e.next=15,b;case 15:c=!1,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),f=!0,v=e.t0;case 24:if(e.prev=24,e.prev=25,!c||null==p.return){e.next=29;break}return e.next=29,(0,h.Z)(p.return());case 29:if(e.prev=29,!f){e.next=32;break}throw v;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[6,20,24,34],[25,,29,33]])})))()}},{key:"decorateFeature",value:function(e,t,r,n){var a=this;t.get=e.get,t.tags=e.tags,t._uniqueID=r,t.id=C,t._parent=n,t.parent=S,t.children=_,(t.get("subfeatures")||[]).forEach((function(n,s){a.decorateFeature(e,n,"".concat(r,"-").concat(s),t)})),t.decorated=!0}}]),r}(),z=F},85693:function(e,t,r){function n(e,t){this.v=e,this.k=t}r.d(t,{Z:function(){return n}})},61418:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(85693);function a(e){var t={},r=!1;function a(t,a){return r=!0,a=new Promise((function(r){r(e[t](a))})),{done:!1,value:new n.Z(a,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):a("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return a("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):a("return",e)}),t}},69621:function(e,t,r){function n(e){var t,r,n,s=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);s--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new a(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function a(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return a=function(e){this.s=e,this.n=e.next},a.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new a(e)}r.d(t,{Z:function(){return n}})},30249:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(85693);function a(e){return new n.Z(e,0)}},98288:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(85693);function a(e){var t,r;function a(t,r){try{var i=e[t](r),u=i.value,o=u instanceof n.Z;Promise.resolve(o?u.v:u).then((function(r){if(o){var n="return"===t?"return":"next";if(!u.k||r.done)return a(n,r);r=e[n](r).value}s(i.done?"return":"normal",r)}),(function(e){a("throw",e)}))}catch(e){s("throw",e)}}function s(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise((function(s,i){var u={key:e,arg:n,resolve:s,reject:i,next:null};r?r=r.next=u:(t=r=u,a(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}function s(e){return function(){return new a(e.apply(this,arguments))}}a.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)}}}]);
//# sourceMappingURL=933.a4541386.chunk.js.map