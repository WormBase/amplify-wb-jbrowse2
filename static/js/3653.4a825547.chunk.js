"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3653],{53653:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=r(32723),a=r(34795),s=r(9249),i=r(87371),u=r(45754),c=r(13820),o=r(61462),d=r(20783),l=r(33528),f=r(26131),p=r(78022),h=r(59917),m=function(e,t,r,d){(0,u.Z)(v,e);var m=(0,c.Z)(v);function v(e,t,r){var n;(0,s.Z)(this,v),(n=m.call(this,e,t,r)).parser=void 0,n.bed=void 0,n.columnNames=void 0,n.scoreColumn=void 0;var a=n.getConf("bedGzLocation"),i=n.getConf(["index","indexType"]),u=n.getConf(["index","location"]),c=n.getConf("autoSql"),d=n.pluginManager;return n.bed=new p.pC({filehandle:(0,l.openLocation)(a,d),csiFilehandle:"CSI"===i?(0,l.openLocation)(u,d):void 0,tbiFilehandle:"CSI"!==i?(0,l.openLocation)(u,d):void 0,chunkCacheSize:50*Math.pow(2,20)}),n.columnNames=n.getConf("columnNames"),n.scoreColumn=n.getConf("scoreColumn"),n.parser=new o.Z({autoSql:c}),n}return(0,i.Z)(v,[{key:"getRefNames",value:function(){return(t=t||(0,a.Z)((0,n.Z)().mark((function e(){var t,r=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.abrupt("return",this.bed.getReferenceSequenceNames(t));case 2:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"getHeader",value:function(){return(r=r||(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bed.getHeader());case 1:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"getNames",value:function(){return(d=d||(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.columnNames.length){e.next=2;break}return e.abrupt("return",this.columnNames);case 2:return e.next=4,this.bed.getHeader();case 4:return t=e.sent,r=t.split(/\n|\r\n|\r/).filter((function(e){return!!e})),a=r.at(-1),e.abrupt("return",null!==a&&void 0!==a&&a.includes("\t")?a.slice(1).split("\t").map((function(e){return e.trim()})):void 0);case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"getFeatures",value:function(e){var t,r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,f.ObservableCreate)((function(i){return(t=t||(0,a.Z)((0,n.Z)().mark((function t(a){var i,u,c,o,d,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.bed.getMetadata();case 2:return i=t.sent,u=i.columnNumbers,c=u.ref-1,o=u.start-1,d=u.end-1,t.next=9,r.getNames();case 9:return l=t.sent,t.next=12,r.bed.getLines(e.refName,e.start,e.end,{lineCallback:function(e,t){a.next((0,h.P)(e,c,o,d,r.scoreColumn,r.parser,"".concat(r.id,"-").concat(t),l))},signal:s.signal});case 12:a.complete();case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}),s.signal)}},{key:"freeResources",value:function(){}}]),v}(d.BaseFeatureDataAdapter);m.capabilities=["getFeatures","getRefNames"]},59917:function(e,t,r){r.d(t,{P:function(){return i},d:function(){return s}});var n=r(33028),a=r(81073);function s(e){var t=e.children(),r=e.get("thickStart"),n=e.get("thickEnd");if(!r&&!n)return e;var s=t?t.filter((function(e){return"block"===e.get("type")})).sort((function(e,t){return e.get("start")-t.get("start")})):[],i=[];s.forEach((function(t){var a=t.get("start"),s=t.get("end");if(r>=s){var u=e.get("strand")>0?"five":"three";i.push({type:"".concat(u,"_prime_UTR"),start:a,end:s})}else if(r>a&&r<s&&n>=s){var c=e.get("strand")>0?"five":"three";i.push({type:"".concat(c,"_prime_UTR"),start:a,end:r},{type:"CDS",start:r,end:s})}else if(r<=a&&n>=s)i.push({type:"CDS",start:a,end:s});else if(r>a&&r<s&&n<s){var o=e.get("strand")>0?"five":"three",d=e.get("strand")>0?"three":"five";i.push({type:"".concat(o,"_prime_UTR"),start:a,end:r},{type:"CDS",start:r,end:n},{type:"".concat(d,"_prime_UTR"),start:n,end:s})}else if(r<=a&&n>a&&n<s){var l=e.get("strand")>0?"three":"five";i.push({type:"CDS",start:a,end:n},{type:"".concat(l,"_prime_UTR"),start:n,end:s})}else if(n<=a){var f=e.get("strand")>0?"three":"five";i.push({type:"".concat(f,"_prime_UTR"),start:a,end:s})}}));var u=Object.fromEntries(e.tags().map((function(t){return[t,e.get(t)]})));return u.subfeatures=i,u.type="mRNA",u.uniqueId=e.id(),delete u.chromStarts,delete u.chromStart,delete u.chromEnd,delete u.chrom,delete u.blockStarts,delete u.blockSizes,delete u.blockCount,delete u.thickStart,delete u.thickEnd,new a.SimpleFeature({data:u,id:e.id()})}function i(e,t,r,i,u,c,o,d){var l=e.split("\t"),f=l[t],p=+l[r],h=r===i?1:0,m=+l[i]+h,v=d?function(e,t){return Object.fromEntries(t.split("\t").map((function(t,r){return[e[r],t]})))}(d,e):c.parseLine(e,{uniqueId:o}),g=v.blockCount,b=v.blockSizes,k=v.blockStarts,C=v.chromStarts;if(g){var y=C||k||[],S=b,w=p;v.subfeatures=[];for(var Z=0;Z<g;Z+=1){var _=(y[Z]||0)+w,N=_+(S[Z]||0);v.subfeatures.push({uniqueId:"".concat(o,"-").concat(Z),start:_,end:N,type:"block"})}}u&&(v.score=+v[u]),delete v.chrom,delete v.chromStart,delete v.chromEnd;var x=new a.SimpleFeature((0,n.Z)((0,n.Z)({},v),{},{start:p,end:m,refName:f,uniqueId:o}));return x.get("thickStart")?s(x):x}}}]);
//# sourceMappingURL=3653.4a825547.chunk.js.map