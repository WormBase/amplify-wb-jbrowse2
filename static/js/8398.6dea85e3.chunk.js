"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[8398],{67677:(e,t,n)=>{n.d(t,{Mv:()=>u,OK:()=>p,ZP:()=>m,bm:()=>l,sI:()=>c});var o=n(8012),s=n.n(o),r=n(27032),i=n(90173),a=n(90872);function c(e){return(void 0!==e.umdUrl||void 0!==e.url||void 0!==e.umdLoc)&&void 0!==e.name}function l(e){return void 0!==e.esmUrl||void 0!==e.esmLoc}async function d(e){if(!Boolean("WorkerGlobalScope"in globalThis))return t=e,new Promise(((e,n)=>{s()(t,((t,o)=>{t?n(t):e(o.src)}))}));var t;if(null===globalThis||void 0===globalThis||!globalThis.importScripts)throw new Error("cannot figure out how to load external JS scripts in this environment");await globalThis.importScripts(e)}function u(e){return void 0!==e.cjsUrl}function p(e){return c(e)?"UMD plugin ".concat(e.name):l(e)?"ESM plugin ".concat(e.esmUrl||(null===(t=e.esmLoc)||void 0===t?void 0:t.uri)):u(e)?"CJS plugin ".concat(e.cjsUrl):"unknown plugin";var t}class m{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;this.definitions=[],this.fetchESM=void 0,this.fetchCJS=void 0,this.fetchESM=null===t||void 0===t?void 0:t.fetchESM,this.fetchCJS=null===t||void 0===t?void 0:t.fetchCJS,this.definitions=JSON.parse(JSON.stringify(e))}async loadCJSPlugin(e,t){const n=new URL(e.cjsUrl,t);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error('Cannot load plugins using protocol "'.concat(n.protocol,'"'));if(!this.fetchCJS)throw new Error("No fetchCJS callback provided");return this.fetchCJS(n.href)}async loadESMPlugin(e,t){const n="esmUrl"in e?new URL(e.esmUrl,t):new URL(e.esmLoc.uri,e.esmLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error('cannot load plugins using protocol "'.concat(n.protocol,'"'));if(!this.fetchESM)throw new Error("No ESM fetcher installed");const o=await this.fetchESM(n.href);if(!o)throw new Error("Could not load ESM plugin: ".concat(n));return o}async loadUMDPlugin(e,t){const n="url"in e?new URL(e.url,t):"umdUrl"in e?new URL(e.umdUrl,t):new URL(e.umdLoc.uri,e.umdLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error('cannot load plugins using protocol "'.concat(n.protocol,'"'));const o=e.name,s="JBrowsePlugin".concat(o);"undefined"===typeof jest?await d(n.href):globalThis[s]={default:r.Z};const i=globalThis[s];if(!i)throw new Error("Failed to load UMD bundle for ".concat(o,", ").concat(s," is undefined"));return i}async loadPlugin(e,t){let n;if(a.isElectron&&u(e))n=await this.loadCJSPlugin(e,t);else if(l(e))n=await this.loadESMPlugin(e,t);else{if(!c(e))throw!a.isElectron&&u(e)?new Error("CommonJS plugin found, but not in a NodeJS environment: ".concat(JSON.stringify(e))):new Error("Could not determine plugin type: ".concat(JSON.stringify(e)));n=await this.loadUMDPlugin(e,t)}if(!n.default)throw new Error("".concat(p(e)," does not have a default export, cannot load"));return n.default}installGlobalReExports(e){e.JBrowseExports=Object.fromEntries(Object.entries(i.Z).map((e=>{let[t,n]=e;return[t,n]})))}async load(e){return Promise.all(this.definitions.map((async t=>({plugin:await this.loadPlugin(t,e),definition:t}))))}}},43800:(e,t,n)=>{n.r(t),n.d(t,{ConfigurationReference:()=>o.B,ConfigurationSchema:()=>o.c,getConf:()=>s.bc,getTypeNamesFromExplicitlyTypedUnion:()=>s.G,isBareConfigurationSchemaType:()=>s.Pb,isConfigurationModel:()=>s.yt,isConfigurationSchemaType:()=>s.qN,isConfigurationSlotType:()=>s.mu,readConfObject:()=>s.pS});var o=n(98796),s=n(5074)},58062:(e,t,n)=>{n.d(t,{Iy:()=>r,ie:()=>c,k$:()=>i});let o=0;const s=new WeakMap;function r(e,t){let n=s.get(e);return n||(o+=1,s.set(e,o),n=o,e.addEventListener("abort",(()=>{const n=s.get(e);void 0!==n&&t("signalAbort",n)}))),{abortSignalId:n}}function i(e){return"object"===typeof e&&null!==e&&"abortSignalId"in e&&"number"===typeof e.abortSignalId}const a=new Map;function c(e){let{abortSignalId:t}=e,n=a.get(t);return n||(n=new AbortController,a.set(t,n)),n.signal}},78155:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(41867),s=n(49133),r=n(59231),i=n(3762),a=n(47192),c=n(43800),l=n(90872),d=n(80838);const u=(0,a.ZL)()({importFormEntry:{minWidth:180}}),p=(0,i.observer)((function(e){let{session:t,onChange:n,selected:i,InputProps:a,TextFieldProps:p,localStorageKey:m,helperText:h="Select assembly to view"}=e;const{classes:f}=u(),{assemblyNames:g,assemblyManager:v}=t,y=new URLSearchParams(window.location.search).get("config"),[w,b]="undefined"===typeof jest&&m?(0,l.useLocalStorage)("lastAssembly-".concat([window.location.host+window.location.pathname,y,m].join("-")),i):(0,o.useState)(i),S=g.includes(w||"")?w:i;(0,o.useEffect)((()=>{S&&S!==i&&n(S)}),[S,n,i]);const C=g.length?"":"No configured assemblies";return(0,d.jsx)(s.Z,{select:!0,label:"Assembly",variant:"outlined",helperText:C||h,value:S||"",inputProps:{"data-testid":"assembly-selector"},onChange:e=>b(e.target.value),error:!!C,InputProps:a,disabled:!!C,className:f.importFormEntry,...p,children:g.map((e=>{const t=v.get(e),n=t?(0,c.getConf)(t,"displayName"):"";return(0,d.jsx)(r.Z,{value:e,children:n||e},e)}))})}))},33681:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(41867),s=n(59231),r=n(12166),i=n(89661),a=n(89301),c=n(72176),l=n(12555),d=n(56762),u=n(77600),p=n(13232),m=n(67507),h=n(80838);const f=o.createContext({parentPopupState:null,rootPopupState:null});function g(e){let{onClick:t,...n}=e;const{rootPopupState:r}=(0,o.useContext)(f);if(!r)throw new Error("must be used inside a CascadingMenu");const i=(0,o.useCallback)((e=>{r.close(),null===t||void 0===t||t(e)}),[r,t]);return(0,h.jsx)(s.Z,{...n,onClick:i})}function v(e){let{title:t,Icon:n,inset:a,popupId:c,...l}=e;const{parentPopupState:d}=o.useContext(f),p=(0,u.o_)({popupId:c,variant:"popover",parentPopupState:d});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.Z,{...(0,u.b8)(p),...(0,u.bs)(p),children:[n?(0,h.jsx)(r.Z,{children:(0,h.jsx)(n,{})}):null,(0,h.jsx)(i.Z,{primary:t,inset:a}),(0,h.jsx)(m.Z,{})]}),(0,h.jsx)(y,{...l,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},popupState:p})]})}function y(e){let{popupState:t,onMenuItemClick:n,menuItems:s,classes:r,...i}=e;const{rootPopupState:a}=(0,o.useContext)(f),c=(0,o.useMemo)((()=>({rootPopupState:a||t,parentPopupState:t})),[a,t]);return(0,h.jsx)(f.Provider,{value:c,children:(0,h.jsx)(p.Z,{...i,...(0,u.wK)(t)})})}function w(e){let{popupState:t,onMenuItemClick:n,menuItems:s,...r}=e;const{rootPopupState:i}=o.useContext(f),c=o.useMemo((()=>({rootPopupState:i||t,parentPopupState:t})),[i,t]);return(0,h.jsx)(f.Provider,{value:c,children:(0,h.jsx)(a.Z,{...r,...(0,u.wK)(t)})})}function b(e){let{item:t}=e;return"subMenu"in t?(0,h.jsx)(d.J,{type:"subMenu"}):"checkbox"===t.type||"radio"===t.type?(0,h.jsx)(d.J,{type:t.type,checked:t.checked,disabled:t.disabled}):null}function S(e){let{onMenuItemClick:t,menuItems:n,...o}=e;const s=n.some((e=>"icon"in e&&e.icon));return(0,h.jsx)(h.Fragment,{children:n.map(((e,n)=>{return"subMenu"in e?(0,h.jsx)(v,{popupId:"subMenu-".concat(e.label),title:e.label,Icon:e.icon,inset:s&&!e.icon,onMenuItemClick:t,menuItems:e.subMenu,children:(0,h.jsx)(S,{...o,onMenuItemClick:t,menuItems:e.subMenu})},"subMenu-".concat(e.label,"-").concat(n)):"divider"===e.type?(0,h.jsx)(c.Z,{component:"li"},"divider-".concat(n)):"subHeader"===e.type?(0,h.jsx)(l.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(n)):(0,h.jsxs)(g,{onClick:"onClick"in e?(a=e.onClick,e=>{t(e,a)}):void 0,disabled:Boolean(e.disabled),children:[e.icon?(0,h.jsx)(r.Z,{children:(0,h.jsx)(e.icon,{})}):null," ",(0,h.jsx)(i.Z,{primary:e.label,secondary:e.subLabel,inset:s&&!e.icon}),(0,h.jsx)("div",{style:{flexGrow:1,minWidth:10}}),(0,h.jsx)(b,{item:e})]},"".concat(e.label,"-").concat(n));var a}))})}const C=function(e){return(0,h.jsx)(w,{...e,children:(0,h.jsx)(S,{...e})})}},5404:(e,t,n)=>{n.d(t,{Z:()=>b});var o=n(41867),s=n(17280),r=n(27341),i=n(51825),a=n(87984),c=n(68367),l=n(72176),d=n(81096),u=n(65559),p=n(3762),m=n(47192),h=n(97486),f=n(22177),g=n(86163),v=n(80838);const y=(0,m.ZL)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function w(e){let{error:t}=e;return(0,v.jsx)("div",{style:{width:800,margin:40},children:(0,v.jsx)(g.Z,{error:t})})}const b=(0,p.observer)((function(e){const{classes:t}=y(),{title:n,header:p,children:m,onClose:g}=e,b=(0,s.Z)();return(0,v.jsx)(r.Z,{...e,children:(0,v.jsxs)(i.Z,{children:[o.isValidElement(p)?(0,v.jsx)(v.Fragment,{children:p}):(0,v.jsxs)(a.Z,{children:[n,g?(0,v.jsx)(c.Z,{className:t.closeButton,onClick:()=>{g()},children:(0,v.jsx)(f.Z,{})}):null]}),(0,v.jsx)(l.Z,{}),(0,v.jsx)(h.SV,{FallbackComponent:w,children:(0,v.jsx)(d.Z,{theme:(0,u.Z)(b,{components:{MuiInputBase:{styleOverrides:{input:{boxSizing:"content-box!important"}}}}}),children:m})})]})})}))},15072:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(41867),s=n(17280),r=n(51590),i=n(86544),a=n(47192),c=n(57440),l=n(80838);const d=(0,a.ZL)()((e=>({input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderWidth:2}}))),u=o.forwardRef((function(e,t){const{value:n,setValue:a,variant:u,...p}=e,[m,{width:h}]=(0,c.Z)(),[f,g]=(0,o.useState)(),[v,y]=(0,o.useState)(null),[w,b]=(0,o.useState)(!1);(0,o.useEffect)((()=>{w&&(null===v||void 0===v||v.blur(),b(!1))}),[w,v]);const{classes:S}=d(e,{props:e}),C=(0,s.Z)(),x=void 0===f?n:f;return(0,l.jsxs)("div",{...p,ref:t,children:[(0,l.jsx)("div",{style:{position:"relative"},children:(0,l.jsx)(r.Z,{ref:m,component:"span",variant:u,className:S.typography,children:x})}),(0,l.jsx)(i.ZP,{inputRef:e=>y(e),className:S.inputBase,inputProps:{style:{width:h,...u&&"inherit"!==u?C.typography[u]:{}}},classes:{input:S.input,root:S.inputRoot,focused:S.inputFocused},value:x,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key?null===v||void 0===v||v.blur():"Escape"===e.key&&(g(void 0),b(!0))},onBlur:()=>{a(f||n||""),g(void 0)}})]})}))},86163:(e,t,n)=>{n.d(t,{Z:()=>s});n(41867);var o=n(80838);const s=e=>{let{error:t}=e;const n="".concat(t),s=function(e){let t="";const n="is not assignable",o=e.indexOf(n);if(-1!==o){const n=e.slice(0,o+17),s=n.match(/.*at path "(.*)" snapshot `(.*)` is not assignable/m);s&&(e="Failed to load element at ".concat(s[1],"...Failed element had snapshot"),t=s[2]);const r=n.match(/.*snapshot `(.*)` is not assignable/);r&&(e="Failed to load element...Failed element had snapshot",t=r[1])}return t}(n);return(0,o.jsxs)("div",{style:{padding:4,margin:4,overflow:"auto",maxHeight:200,background:"#f88",border:"1px solid black"},children:[n.slice(0,1e4),s?(0,o.jsx)("pre",{style:{background:"lightgrey",border:"1px solid black",margin:20},children:JSON.stringify(JSON.parse(s),null,2)}):null]})}},5146:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});n(41867);var o=n(47409),s=n(75258),r=n(27768),i=n(23801),a=n(5404),c=n(80838);function l(e){let{onClose:t,open:n,onFactoryReset:l}=e;function d(e){"reset"===e&&l(),t()}return(0,c.jsxs)(a.Z,{title:"Reset",onClose:()=>d(),open:n,children:[(0,c.jsx)(o.Z,{children:(0,c.jsx)(s.Z,{children:"Are you sure you want to reset? This will restore the default configuration."})}),(0,c.jsxs)(r.Z,{children:[(0,c.jsx)(i.Z,{onClick:()=>d(),color:"primary",children:"Cancel"}),(0,c.jsx)(i.Z,{onClick:()=>d("reset"),color:"primary",variant:"contained",children:"OK"})]})]})}},24728:(e,t,n)=>{n.d(t,{GD:()=>a,ks:()=>i,pt:()=>r,sB:()=>l,vc:()=>c});var o=n(77081),s=(n(41867),n(80838));function r(e){return(0,s.jsx)(o.Z,{...e,children:(0,s.jsx)("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"})})}function i(e){return(0,s.jsx)(o.Z,{...e,children:(0,s.jsx)("path",{d:"M19.31 18.9L22.39 22L21 23.39L17.88 20.32C17.19 20.75 16.37 21 15.5 21C13 21 11 19 11 16.5C11 14 13 12 15.5 12C18 12 20 14 20 16.5C20 17.38 19.75 18.21 19.31 18.9M15.5 19C16.88 19 18 17.88 18 16.5C18 15.12 16.88 14 15.5 14C14.12 14 13 15.12 13 16.5C13 17.88 14.12 19 15.5 19M21 4V6H3V4H21M3 16V14H9V16H3M3 11V9H21V11H18.97C17.96 10.37 16.77 10 15.5 10C14.23 10 13.04 10.37 12.03 11H3Z"})})}function a(e){return(0,s.jsx)(o.Z,{...e,children:(0,s.jsx)("path",{d:"M21 19v-2H8v2h13m0-6v-2H8v2h13M8 7h13V5H8v2M4 5v2h2V5H4M3 5a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"})})}function c(e){return(0,s.jsx)(o.Z,{...e,children:(0,s.jsx)("path",{fill:"currentColor",d:"M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"})})}function l(e){return(0,s.jsx)(o.Z,{...e,children:(0,s.jsx)("path",{d:"M20 5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v1h-1v4c0 .55.45 1 1 1h1v7c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-2.21-1.79-4-4-4S5 4.79 5 7v7H4c-.55 0-1 .45-1 1v4h1v1c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-1h1v-4c0-.55-.45-1-1-1H7V7c0-1.1.9-2 2-2s2 .9 2 2v10c0 2.21 1.79 4 4 4s4-1.79 4-4v-7h1c.55 0 1-.45 1-1V5h-1z"})})}},51572:(e,t,n)=>{n.d(t,{c:()=>r,e:()=>i});n(41867);var o=n(80838);function s(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function r(e){let{variant:t}=e;return(0,o.jsx)("svg",{viewBox:"0 0 175 175",children:(0,o.jsx)(a,{variant:t})})}function i(e){let{variant:t}=e;return(0,o.jsxs)("svg",{viewBox:"0 0 641 175",children:[(0,o.jsx)(c,{variant:t}),(0,o.jsx)(a,{variant:t})]})}function a(e){let{variant:t}=e;const n=s(t);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{style:{fill:n.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),(0,o.jsx)("path",{style:{fill:n.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),(0,o.jsx)("path",{style:{fill:n.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),(0,o.jsx)("path",{style:{fill:n.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),(0,o.jsx)("path",{style:{fill:n.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"})]})}function c(e){let{variant:t}=e;const n=s(t);return(0,o.jsxs)("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:{fill:n.midnight},children:[(0,o.jsx)("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),(0,o.jsx)("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),(0,o.jsx)("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),(0,o.jsx)("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),(0,o.jsx)("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),(0,o.jsx)("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),(0,o.jsx)("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"})]})}},56762:(e,t,n)=>{n.d(t,{J:()=>C,Z:()=>k});var o=n(41867),s=n(75833),r=n(72176),i=n(12555),a=n(12166),c=n(59231),l=n(89661),d=n(34288),u=n(7229),p=n(64980),m=n(47192),h=n(83329),f=n(64409),g=n(28006),v=n(4410),y=n(35544),w=n(90872),b=n(80838);const S=(0,m.ZL)()({paper:{position:"fixed",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",top:0,left:0,outline:0},menuItemEndDecoration:{padding:0,margin:0,height:16}});function C(e){const{classes:t}=S(),{type:n}=e;let o,s,r;switch("checked"in e&&({checked:o,disabled:s}=e),n){case"subMenu":r=(0,b.jsx)(h.Z,{color:"action"});break;case"checkbox":if(o){const e=s?"inherit":void 0;r=(0,b.jsx)(f.Z,{color:e})}else r=(0,b.jsx)(g.Z,{color:"action"});break;case"radio":if(o){const e=s?"inherit":void 0;r=(0,b.jsx)(v.Z,{color:e})}else r=(0,b.jsx)(y.Z,{color:"action"})}return(0,b.jsx)("div",{className:t.menuItemEndDecoration,children:r})}const x=o.forwardRef((function(e,t){const[n,p]=(0,o.useState)(),[m,h]=(0,o.useState)(),[f,g]=(0,o.useState)(!1),[v,y]=(0,o.useState)(),[k,A]=(0,o.useState)(),j=(0,o.useRef)(null),{classes:M}=S(),{menuItems:T,onMenuItemClick:P,open:E,onClose:I,anchorEl:N,top:Z=!1}=e;(0,o.useEffect)((()=>{E||(p(void 0),h(void 0))}),[E]),(0,o.useEffect)((()=>{const e=E&&Boolean(n);let t;return e&&!f?t=setTimeout((()=>{g(!0)}),300):!e&&f&&(t=setTimeout((()=>{g(!1)}),300)),()=>{clearTimeout(t)}}),[f,E,n]),(0,o.useEffect)((()=>{if(N){const e=N.getBoundingClientRect();k&&e.top===k.top&&e.left+e.width===k.left||A({top:e.top,left:e.left+e.width})}else k||A({})}),[k,N]);const R=T.some((e=>"icon"in e&&e.icon)),L={};const D=(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Z,{autoFocusItem:E&&!f,dense:!0,children:T.sort(((e,t)=>(t.priority||0)-(e.priority||0))).map(((e,t)=>{if("divider"===e.type)return(0,b.jsx)(r.Z,{component:"li"},"divider-".concat(t));if("subHeader"===e.type)return(0,b.jsx)(i.Z,{children:e.label},"subHeader-".concat(e.label,"-").concat(t));let n=null,o=null;if(e.icon){const t=e.icon;n=(0,b.jsx)(a.Z,{children:(0,b.jsx)(t,{})})}"subMenu"in e?o=(0,b.jsx)(C,{type:"subMenu"}):"checkbox"!==e.type&&"radio"!==e.type||(o=(0,b.jsx)(C,{type:e.type,checked:e.checked,disabled:e.disabled}));const s="onClick"in e?(d=e.onClick,e=>{P(e,d)}):void 0;var d;return(0,b.jsxs)(c.Z,{style:L,selected:t===v,onClick:s,onMouseMove:n=>{n.currentTarget!==document.activeElement&&(n.currentTarget.focus(),y(t)),"subMenu"in e?m!==t&&(p(n.currentTarget),h(t)):(p(void 0),h(void 0))},onKeyDown:n=>{switch(n.key){case"ArrowLeft":case"Escape":I&&I(n,"escapeKeyDown");break;case"ArrowUp":y(function(e,t){return(0,w.findLastIndex)(e.slice(0,t),(e=>"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled))}(T,t));break;case"ArrowDown":{const e=function(e,t){const n=e.slice(t+1).findIndex((e=>"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled));return-1===n?n:t+1+n}(T,t);y(e);break}default:!("subMenu"in e)||"ArrowRight"!==n.key&&"Enter"!==n.key||(p(n.currentTarget),h(t),g(!0))}},disabled:Boolean(e.disabled),children:[n,(0,b.jsx)(l.Z,{primary:e.label,secondary:e.subLabel,inset:R&&!e.icon}),o]},e.label)}))}),T.map(((e,t)=>{let o=null;return"subMenu"in e&&(o=(0,b.jsx)(x,{anchorEl:n,open:f&&m===t,onClose:()=>{g(!1),p(void 0)},onMenuItemClick:P,menuItems:e.subMenu},e.label)),o}))]});return Z?D:(0,b.jsx)(d.Z,{in:E,style:{transformOrigin:"0 0 0"},ref:t,children:(0,b.jsx)(u.Z,{elevation:8,ref:j,className:M.paper,style:{...k},children:D})})}));const k=function(e){const{open:t,onClose:n,menuItems:o,onMenuItemClick:s,...r}=e;return(0,b.jsx)(p.ZP,{open:t,onClose:n,BackdropProps:{invisible:!0},anchorOrigin:{vertical:"bottom",horizontal:"right",...r.anchorOrigin},transformOrigin:{vertical:"top",horizontal:"left",...r.transformOrigin},...r,children:(0,b.jsx)(x,{open:t,onClose:n,menuItems:o,onMenuItemClick:s,top:!0})})}},54560:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(41867),s=n(47192),r=n(80838);const i=(0,s.ZL)()({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}});const a=function(e){let{onDrag:t,vertical:n=!1,flexbox:s=!1,className:a,onMouseDown:c,...l}=e;const[d,u]=(0,o.useState)(!1),p=(0,o.useRef)(0),m=(0,o.useRef)(0),{classes:h,cx:f}=i();let g;return(0,o.useEffect)((()=>{function e(e){e.preventDefault();const o=n?e.clientX:e.clientY,s=p.current-o,r=o-m.current;m.current=o,t(r,s)}function o(){u(!1)}return d?(window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",o,!0),()=>{window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",o,!0)}):()=>{}}),[d,t,n]),g=s?n?h.flexbox_verticalHandle:h.flexbox_horizontalHandle:n?h.verticalHandle:h.horizontalHandle,(0,r.jsx)("div",{"data-resizer":"true",onMouseDown:e=>{e.preventDefault();const t=n?e.clientX:e.clientY;p.current=t,m.current=t,u(!0),null===c||void 0===c||c(e)},className:f(g,a),...l})}},31547:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});n(41867);var o=n(3762),s=n(47409),r=n(51590),i=n(27768),a=n(23801),c=n(5404),l=n(80838);const d=(0,o.observer)((function(e){let{model:t,handleClose:n}=e;return(0,l.jsxs)(c.Z,{maxWidth:"xl",open:!0,onClose:n,title:"Reference sequence",children:[(0,l.jsx)(s.Z,{children:(0,l.jsx)(r.Z,{children:"Are you sure you want to return to the import form? This will lose your current view"})}),(0,l.jsxs)(i.Z,{children:[(0,l.jsx)(a.Z,{onClick:()=>{t.clearView(),n()},variant:"contained",color:"primary",autoFocus:!0,children:"OK"}),(0,l.jsx)(a.Z,{onClick:()=>n(),color:"secondary",variant:"contained",children:"Cancel"})]})]})}))},83734:(e,t,n)=>{n.d(t,{Z:()=>u});n(41867);var o=n(87281),s=n.n(o),r=n(61100),i=n.n(r),a=n(90872),c=n(80838);let l=!1;const d=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","sup","sub","td","tfoot","th","thead","tr","u","ul"].map((e=>"<".concat(e,"\\b[^>]*>"))).join("|"),"i");function u(e){let{html:t}=e;const n=(0,a.linkify)(t),o=(r=n,d.test(r)?n:s()(n));var r;return l||(l=!0,i().addHook("afterSanitizeAttributes",(e=>{"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}))),(0,c.jsx)("span",{dangerouslySetInnerHTML:{__html:i().sanitize(o)}})}},35421:(e,t,n)=>{n.r(t),n.d(t,{AssemblySelector:()=>x.Z,CascadingMenu:()=>k.Z,Dialog:()=>A.Z,EditableTypography:()=>j.Z,ErrorMessage:()=>M.Z,FactoryResetDialog:()=>T.default,FatalErrorDialog:()=>P.Z,FileSelector:()=>H,LoadingEllipses:()=>K.Z,LogoFull:()=>C.e,Logomark:()=>C.c,Menu:()=>Q.Z,MenuItemEndDecoration:()=>Q.J,PrerenderedCanvas:()=>$,ResizeHandle:()=>se.Z,ReturnToImportFormDialog:()=>oe.default,SanitizedHTML:()=>re.Z,Tooltip:()=>ne,createJBrowseBaseTheme:()=>w,createJBrowseTheme:()=>b,defaultThemes:()=>v});var o=n(76440),s=n(82747),r=n(86083),i=n(65028),a=n(78223),c=n(65559),l=n(58474),d=n.n(l);const u="#0D233F",p="#721E63",m="#135560",h="#FFB11D",f=(0,c.Z)();function g(){return{palette:{mode:void 0,primary:{main:u},secondary:{main:p},tertiary:f.palette.augmentColor({color:{main:m}}),quaternary:f.palette.augmentColor({color:{main:h}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:f.palette.augmentColor({color:o.Z}),C:f.palette.augmentColor({color:s.Z}),G:f.palette.augmentColor({color:r.Z}),T:f.palette.augmentColor({color:i.Z})}},components:{MuiLink:{styleOverrides:{root:e=>{let{theme:t}=e;return{color:t.palette.tertiary.main}}}}}}}const v={default:{name:"Default (from config)",...g()},lightStock:{name:"Light (stock)",...g()},lightMinimal:{name:"Light (minimal)",palette:{primary:{main:a.Z[900]},secondary:{main:a.Z[800]},tertiary:f.palette.augmentColor({color:{main:a.Z[900]}}),quaternary:f.palette.augmentColor({color:{main:h}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:f.palette.augmentColor({color:o.Z}),C:f.palette.augmentColor({color:s.Z}),G:f.palette.augmentColor({color:r.Z}),T:f.palette.augmentColor({color:i.Z})}}},darkMinimal:{name:"Dark (minimal)",palette:{mode:"dark",primary:{main:a.Z[700]},secondary:{main:a.Z[800]},tertiary:f.palette.augmentColor({color:{main:a.Z[900]}}),quaternary:f.palette.augmentColor({color:{main:h}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:f.palette.augmentColor({color:o.Z}),C:f.palette.augmentColor({color:s.Z}),G:f.palette.augmentColor({color:r.Z}),T:f.palette.augmentColor({color:i.Z})}}},darkStock:{name:"Dark (stock)",palette:{mode:"dark",primary:{main:u},secondary:{main:p},tertiary:f.palette.augmentColor({color:{main:m}}),quaternary:f.palette.augmentColor({color:{main:h}}),stopCodon:"#e22",startCodon:"#3e3",bases:{A:f.palette.augmentColor({color:o.Z}),C:f.palette.augmentColor({color:s.Z}),G:f.palette.augmentColor({color:r.Z}),T:f.palette.augmentColor({color:i.Z})}},components:{MuiAppBar:{defaultProps:{enableColorOnDark:!0},styleOverrides:{primary:e=>e.theme.palette.primary.main}}}}};function y(e){var t,n,o,s,r,i;return{components:{MuiButton:{defaultProps:{size:"small"},styleOverrides:{root:e=>{const{theme:t}=e;return"dark"===t.palette.mode?{color:t.palette.text.primary}:void 0}}},MuiAccordion:{defaultProps:{disableGutters:!0,TransitionProps:{timeout:150}}},MuiFilledInput:{defaultProps:{margin:"dense"}},MuiFormControl:{defaultProps:{margin:"dense",size:"small"}},MuiFormHelperText:{defaultProps:{margin:"dense"}},MuiIconButton:{defaultProps:{size:"small"}},MuiInputBase:{defaultProps:{margin:"dense"}},MuiAutocomplete:{defaultProps:{size:"small"}},MuiInputLabel:{defaultProps:{margin:"dense"}},MuiToolbar:{defaultProps:{variant:"dense"}},MuiListItem:{defaultProps:{dense:!0}},MuiOutlinedInput:{defaultProps:{margin:"dense"}},MuiFab:{defaultProps:{size:"small"},styleOverrides:{secondary:{backgroundColor:null===e||void 0===e||null===(t=e.palette)||void 0===t||null===(n=t.quaternary)||void 0===n?void 0:n.main}}},MuiTable:{defaultProps:{size:"small"}},MuiPopover:{defaultProps:{transitionDuration:0}},MuiMenu:{defaultProps:{transitionDuration:0}},MuiMenuItem:{defaultProps:{dense:!0}},MuiTextField:{defaultProps:{margin:"dense",variant:"standard"}},MuiLink:{styleOverrides:{root:e=>{let{theme:t}=e;return{color:t.palette.text.secondary}}}},MuiCheckbox:{styleOverrides:{root:e=>{let{theme:t}=e;return"dark"===t.palette.mode?{color:t.palette.text.secondary,"&.Mui-checked":{color:t.palette.text.secondary}}:void 0}}},MuiRadio:{styleOverrides:{root:e=>{let{theme:t}=e;return"dark"===t.palette.mode?{color:t.palette.text.secondary,"&.Mui-checked":{color:t.palette.text.secondary}}:void 0}}},MuiFormLabel:{styleOverrides:{root:e=>{let{theme:t}=e;return"dark"===t.palette.mode?{color:t.palette.text.secondary,"&.Mui-focused":{color:t.palette.text.secondary}}:void 0}}},MuiAccordionSummary:{styleOverrides:{root:{backgroundColor:null===e||void 0===e||null===(o=e.palette)||void 0===o||null===(s=o.tertiary)||void 0===s?void 0:s.main},content:{color:null===e||void 0===e||null===(r=e.palette)||void 0===r||null===(i=r.tertiary)||void 0===i?void 0:i.contrastText}}},MuiToggleButtonGroup:{defaultProps:{size:"small"}}}}}function w(e){return d()({palette:null===e||void 0===e?void 0:e.palette,typography:{fontSize:12},spacing:4,...y(e)},e||{})}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";return(0,c.Z)(w("default"===n?d()(t.default,S(e)):function(){var e,t,n,o;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s=S(s),null!==(e=s)&&void 0!==e&&null!==(t=e.palette)&&void 0!==t&&t.quaternary||(s=d()(s,{palette:{quaternary:f.palette.augmentColor({color:{main:"#aaa"}})}}));null!==(n=s)&&void 0!==n&&null!==(o=n.palette)&&void 0!==o&&o.tertiary||(s=d()(s,{palette:{tertiary:f.palette.augmentColor({color:{main:"#aaa"}})}}));return s}(t[n])||t.default))}function S(){var e,t,n,o;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!==(e=s)&&void 0!==e&&null!==(t=e.palette)&&void 0!==t&&t.tertiary&&(s=d()(s,{palette:{tertiary:f.palette.augmentColor("color"in s.palette.tertiary?s.palette.tertiary:{color:s.palette.tertiary})}})),null!==(n=s)&&void 0!==n&&null!==(o=n.palette)&&void 0!==o&&o.quaternary&&(s=d()(s,{palette:{quaternary:f.palette.augmentColor("color"in s.palette.quaternary?s.palette.quaternary:{color:s.palette.quaternary})}})),s}var C=n(51572),x=n(78155),k=n(33681),A=n(5404),j=n(15072),M=n(86163),T=n(5146),P=n(59093),E=n(41867),I=n(3762),N=n(77573),Z=n(4490),R=n(59025),L=n(74735),D=n(36146),W=n(89301),z=n(59231),O=n(17329),V=n(55022),U=n(77638),F=n(20197),B=n(41064),q=n(90872),G=n(80838);function _(e){const{title:t,children:n,...o}=e;return(0,G.jsx)(N.Z,{title:t||"",children:(0,G.jsx)(Z.Z,{...o,children:n})})}function J(e,t){return"string"===typeof e&&e.length>t?"".concat(e.slice(0,Math.max(0,t)),"\u2026"):e}const H=(0,I.observer)((function(e){const{location:t,name:n,description:o,rootModel:s,setLocation:r}=e,i=!t||(0,V.hb)(t)?"url":"file",[a,c]=(0,E.useState)(t&&"internetAccountId"in t&&t.internetAccountId?t.internetAccountId:i),l=(0,V.dc)(s)?[...s.internetAccounts]:[],[d,u]=(0,E.useState)(l.slice(0,2)),[p,m]=(0,E.useState)(l.slice(2)),[h,f]=(0,E.useState)(null),g=l.find((e=>e.internetAccountId===a)),v=(0,E.useCallback)((e=>{r({...e,...(0,V.hb)(e)?{internetAccountId:null===g||void 0===g?void 0:g.internetAccountId}:{}})}),[r,g]);(0,E.useEffect)((()=>{g&&(0,V.hb)(t)&&t.internetAccountId!==g.internetAccountId&&v(t)}),[t,g,v]);let y=(0,G.jsx)(F.Z,{...e,setLocation:v,label:null===g||void 0===g?void 0:g.selectorLabel});if("file"===a&&(y=(0,G.jsx)(U.Z,{...e})),null!==g&&void 0!==g&&g.SelectorComponent){const{SelectorComponent:t}=g;y=(0,G.jsx)(t,{...e,setLocation:v})}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(R.Z,{display:"flex",children:(0,G.jsx)(L.Z,{shrink:!0,children:n})}),(0,G.jsx)(R.Z,{display:"flex",flexDirection:"row",children:(0,G.jsxs)(R.Z,{children:[(0,G.jsxs)(D.Z,{value:a,exclusive:!0,onChange:(e,n)=>{n&&c(n),(0,V.hb)(t)&&v(t)},"aria-label":"file, url, or account picker",children:[new URLSearchParams(window.location.search).get("adminKey")?null:(0,G.jsx)(Z.Z,{value:"file","aria-label":"local file",children:"File"}),(0,G.jsx)(Z.Z,{value:"url","aria-label":"url",children:"URL"}),d.map((e=>{let{internetAccountId:t,toggleContents:n,name:o}=e;return(0,G.jsx)(_,{value:t,"aria-label":o,title:o,children:"string"===typeof n?J(n,5):n||J(o,5)},t)})),p.length>0?(0,G.jsxs)(Z.Z,{onClick:e=>f(e.target),selected:!1,children:["More",(0,G.jsx)(B.Z,{})]}):null]}),(0,G.jsx)(W.Z,{open:Boolean(h),anchorEl:h,onClose:()=>f(null),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:null===p||void 0===p?void 0:p.map(((e,t)=>(0,G.jsx)(z.Z,{value:e.internetAccountId,onClick:()=>{const n=d.at(-1);u([...d.slice(0,-1),e]),m([n,...p.slice(0,t),...p.slice(t+1)].filter(q.notEmpty)),c(e.internetAccountId),f(null)},children:e.name},e.internetAccountId)))})]})}),y,(0,G.jsx)(O.Z,{children:o})]})}));var K=n(28164),Q=n(56762),Y=n(44632);const $=function(e){const{width:t,height:n,highResolutionScaling:o=1,style:s={},imageData:r,blockKey:i,showSoftClip:a}=e,[c,l]=(0,E.useState)(!1),d=(0,E.useRef)(null);(0,E.useEffect)((()=>{if(!r)return;const e=d.current;if(!e)return;const t=e.getContext("2d");t&&((0,Y.kv)(r,t),l(!0))}),[r]);const u=i?"_"+i:"",p="prerendered_canvas".concat(a?"_softclipped":"").concat(u).concat(c?"_done":"");return(0,G.jsx)("canvas",{"data-testid":p,ref:d,width:t*o,height:n*o,style:{width:t,height:n,...s}})};var X=n(47192),ee=n(43800);const te=(0,X.ZL)()({hoverLabel:{border:"1px solid black",position:"absolute",background:"#fffa",pointerEvents:"none",zIndex:1e4}}),ne=(0,I.observer)((function(e){let{offsetX:t,offsetY:n,configuration:o,feature:s,timeout:r=300}=e;const{classes:i}=te(),[a,c]=(0,E.useState)(!1);if((0,E.useEffect)((()=>{const e=setTimeout((()=>c(!0)),r);return()=>clearTimeout(e)})),s&&a){const e=(0,ee.readConfObject)(o,"mouseover",{feature:s});return(0,G.jsx)("div",{className:i.hoverLabel,style:{left:t,top:n},children:e})}return null}));var oe=n(31547),se=n(54560),re=n(83734)},8241:(e,t,n)=>{n.d(t,{Z:()=>o});class o extends Map{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"===typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"===typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"===typeof t.expiry&&t.expiry<=Date.now()&&("function"===typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield e)}}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t){let{maxAge:n=this.maxAge}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o="number"===typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:o}):this._set(e,{value:t,expiry:o})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[o,s]=n;!1===this._deleteIfExpired(o,s)&&(yield[o,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[o,s]=n;if(!this.cache.has(o)){!1===this._deleteIfExpired(o,s)&&(yield[o,s.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;for(const[n,o]of this.entriesAscending())e.call(t,o,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}},90872:(e,t,n)=>{n.r(t),n.d(t,{AuthNeededError:()=>c.yb,ImageBitmapType:()=>f.Ck,ReactRendering:()=>g.AN,RetryError:()=>c.Ms,SimpleFeature:()=>v.Z,abortBreakPoint:()=>l.ML,assembleLocString:()=>P,assembleLocStringFast:()=>E,avg:()=>Ze,blobToDataURL:()=>y.n,bpSpanPx:()=>q,bpToPx:()=>D,bytesForRegions:()=>he,cartesianToPolar:()=>F,checkAbortSignal:()=>l.O8,clamp:()=>L,coarseStripHTML:()=>ke,compareLocStrings:()=>R,compareLocs:()=>Z,complement:()=>oe,createCanvas:()=>f.vL,createImageBitmap:()=>f.MC,dedupe:()=>h.D,defaultCodonTable:()=>le,defaultStarts:()=>ae,defaultStops:()=>ce,degToRad:()=>V,doesIntersect2:()=>m.qY,drawImageOntoCanvasContext:()=>f.kv,featureSpanPx:()=>B,findLast:()=>J,findLastIndex:()=>_,findParentThat:()=>C,findParentThatIs:()=>k,gatherOverlaps:()=>We,generateCodonTable:()=>de,getBpDisplayStr:()=>ge,getContainingDisplay:()=>T,getContainingTrack:()=>M,getContainingView:()=>j,getEnv:()=>Me,getLayoutId:()=>be,getSerializedSvg:()=>g.E9,getSession:()=>A,getStr:()=>xe,getTickDisplayStr:()=>ye,getUriLink:()=>Ce,getViewParams:()=>we,groupBy:()=>Re,hashCode:()=>pe,intersection2:()=>m.U0,isAbortException:()=>l.zF,isAbstractMenuManager:()=>c.J0,isAppRootModel:()=>c.dc,isAuthNeededException:()=>c.PK,isBlobLocation:()=>c.ld,isContainedWithin:()=>m.J7,isDisplayModel:()=>c.yZ,isElectron:()=>ee,isFeature:()=>v.T,isLocalPathLocation:()=>c.fx,isRetryException:()=>c.Z6,isRootModelWithInternetAccounts:()=>c.At,isSelectionContainer:()=>c.zL,isSessionModel:()=>c.k$,isSessionModelWithConfigEditing:()=>c.cX,isSessionModelWithConnectionEditing:()=>c._2,isSessionModelWithConnections:()=>c.gC,isSessionModelWithWidgets:()=>c.gI,isSessionWithAddTracks:()=>c._L,isSessionWithSessionPlugins:()=>c.uF,isSessionWithShareURL:()=>c.gx,isSupportedIndexingAdapter:()=>fe,isTrackModel:()=>c.d6,isTrackViewModel:()=>c.Um,isUriLocation:()=>c.hb,isViewContainer:()=>c.BQ,isViewModel:()=>c.zN,iterMap:()=>G,linkify:()=>Ae,localStorageGetItem:()=>Te,localStorageSetItem:()=>Pe,makeAbortError:()=>l.fP,makeAbortableReaction:()=>H,max:()=>Ee,measureGridWidth:()=>je,measureText:()=>ie,mergeIntervals:()=>De,min:()=>Ie,minmax:()=>Y,notEmpty:()=>Le,objectHash:()=>me,observeAbortSignal:()=>l.N7,parseLocString:()=>N,parseLocStringOneBased:()=>I,polarToCartesian:()=>U,rIC:()=>se,radToDeg:()=>O,renameRegionIfNeeded:()=>K,renameRegionsIfNeeded:()=>Q,renderToAbstractCanvas:()=>g.Cj,revcom:()=>te,reverse:()=>ne,shorten:()=>$,springAnimate:()=>x,stringify:()=>X,stripAlpha:()=>ze,sum:()=>Ne,toLocale:()=>ve,updateStatus:()=>ue,useDebounce:()=>w,useDebouncedCallback:()=>S,useLocalStorage:()=>Se,useWidthSetter:()=>b,when:()=>p.g,whenPresent:()=>p.q});var o=n(41867),s=n(44050),r=n.n(s),i=n(31625),a=n(85815),c=n(55022),l=n(47685),d=n(57440),u=n(622),p=n(45445),m=n(19881),h=n(72160),f=n(44632),g=n(55619),v=n(85291),y=n(76258);function w(e,t){const[n,s]=(0,o.useState)(e);return(0,o.useEffect)((()=>{const n=setTimeout((()=>{s(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),n}function b(e,t){const[n,{width:s}]=(0,d.Z)();return(0,o.useEffect)((()=>{s&&(0,i.isAlive)(e)&&requestAnimationFrame((()=>e.setWidth(s-2*Number.parseInt(t,10))))}),[t,e,s]),n}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400;const n=(0,o.useRef)(),s=(0,o.useRef)();function r(){s.current&&clearTimeout(s.current)}return(0,o.useEffect)((()=>r),[]),function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];n.current=i,r(),s.current=setTimeout((()=>{n.current&&e(...n.current)}),t)}}function C(e,t){if(!(0,i.hasParent)(e))throw new Error("node does not have parent");let n=(0,i.getParent)(e);for(;n&&(0,i.isAlive)(n);){if(t(n))return n;if(!(0,i.hasParent)(n))break;n=(0,i.getParent)(n)}throw new Error("no matching node found")}function x(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:170,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:26;let a;function c(e){const l=Date.now();let d=e.lastPosition,u=e.lastTime||l,p=e.lastVelocity||0;l>u+64&&(u=l);const m=Math.floor(l-u);for(let n=0;n<m;++n){p+=1*((-r*(d-t)+-i*p)/1)/1e3,d+=1*p/1e3}const h=Math.abs(p)<=s,f=0===r||Math.abs(t-d)<=s;h&&f?(n(t),o()):(n(d),a=requestAnimationFrame((()=>c({lastPosition:d,lastTime:l,lastVelocity:p}))))}return s||(s=Math.abs(t-e)/1e3),[()=>c({lastPosition:e}),()=>cancelAnimationFrame(a)]}function k(e,t){return C(e,t)}function A(e){try{return k(e,c.k$)}catch(t){throw new Error("no session model found!")}}function j(e){try{return k(e,c.zN)}catch(t){throw new Error("no containing view found")}}function M(e){try{return k(e,c.d6)}catch(t){throw new Error("no containing track found")}}function T(e){try{return k(e,c.yZ)}catch(t){throw new Error("no containing display found")}}function P(e){return E(e,ve)}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;const{assemblyName:n,refName:o,start:s,end:r,reversed:i}=e,a=n?"{".concat(n,"}"):"";let c,l;c=void 0!==s?":".concat(t(s+1)):void 0!==r?":1":"",l=void 0!==r?void 0!==s&&s+1===r?"":"..".concat(t(r)):void 0!==s?"..":"";let d="";return i&&(d="[rev]"),"".concat(a).concat(o).concat(c).concat(l).concat(d)}function I(e,t){if(!e)throw new Error("no location string provided, could not parse");let n=!1;e.endsWith("[rev]")&&(n=!0,e=e.replace(/\[rev]$/,""));const o=(e=e.replace(/\s/,"")).match(/({(.+)})?(.+)/);if(!o)throw new Error('invalid location string: "'.concat(e,'"'));const[,,s,r]=o;if(!s&&r.startsWith("{}"))throw new Error('no assembly name was provided in location "'.concat(r,'"'));const i=r.lastIndexOf(":");if(-1===i){if(t(r,s))return{assemblyName:s,refName:r,reversed:n};throw new Error('Unknown reference sequence "'.concat(r,'"'))}const a=r.slice(0,i),c=r.slice(i+1);if(t(a,s)&&t(r,s))throw new Error('ambiguous location string: "'.concat(e,'"'));if(t(a,s)){if(!c)return{assemblyName:s,refName:a,reversed:n};{const t=c.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)(-?(\d+|\d{1,3}(,\d{3})*))$/),o=c.match(/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)?$/);if(t){const[,e,,,,o]=t;if(void 0!==e&&void 0!==o)return{assemblyName:s,refName:a,start:+e.replaceAll(",",""),end:+o.replaceAll(",",""),reversed:n}}else{if(!o)throw new Error('could not parse range "'.concat(c,'" on location "').concat(e,'"'));{const[,e,,,t]=o;if(void 0!==e)return t?{assemblyName:s,refName:a,start:+e.replaceAll(",",""),reversed:n}:{assemblyName:s,refName:a,start:+e.replaceAll(",",""),end:+e.replaceAll(",",""),reversed:n}}}}}else if(t(r,s))return{assemblyName:s,refName:r,reversed:n};throw new Error('unknown reference sequence name in location "'.concat(e,'"'))}function N(e,t){const n=I(e,t);return"number"===typeof n.start&&(n.start-=1),n}function Z(e,t){const n=e.assemblyName||t.assemblyName?(e.assemblyName||"").localeCompare(t.assemblyName||""):0;if(n)return n;const o=e.refName||t.refName?(e.refName||"").localeCompare(t.refName||""):0;if(o)return o;if(void 0!==e.start&&void 0!==t.start){const n=e.start-t.start;if(n)return n}if(void 0!==e.end&&void 0!==t.end){const n=e.end-t.end;if(n)return n}return 0}function R(e,t,n){return Z(N(e,n),N(t,n))}function L(e,t,n){return e<t?t:e>n?n:e}function D(e,t,n){let{reversed:o,end:s=0,start:r=0}=t;return i=(o?s-e:e-r)/n,Math.round(10*i)/10;var i}const W=180/Math.PI,z=Math.PI/180;function O(e){return e*W%360}function V(e){return e*z%(2*Math.PI)}function U(e,t){return[e*Math.cos(t),e*Math.sin(t)]}function F(e,t){return[Math.sqrt(e*e+t*t),Math.atan(t/e)]}function B(e,t,n){return q(e.get("start"),e.get("end"),t,n)}function q(e,t,n,o){const s=D(e,n,o),r=D(t,n,o);return n.reversed?[r,s]:[s,r]}function G(e,t,n){const o=Array.from({length:n||0});let s=0;for(const r of e)o[s]=t(r),s+=1;return o}function _(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return n;return-1}function J(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return e[n]}function H(e,t,n,o,s,r,c){let d;function u(t){(0,l.zF)(t)||((0,i.isAlive)(e)?c(t):console.error(t))}(0,i.addDisposer)(e,(0,a.reaction)((()=>{try{return t(e)}catch(n){return void u(n)}}),(async(t,o)=>{if(d&&!d.signal.aborted&&d.abort(),!(0,i.isAlive)(e))return;d=new AbortController;const a=d;s(a);try{const s=await n(t,a.signal,e,o);(0,l.O8)(a.signal),(0,i.isAlive)(e)&&r(s)}catch(c){a&&!a.signal.aborted&&a.abort(),u(c)}}),o)),(0,i.addDisposer)(e,(()=>{d&&!d.signal.aborted&&d.abort()}))}function K(e,t){if((0,i.isStateTreeNode)(t)&&!(0,i.isAlive)(t))return t;if(t&&null!==e&&void 0!==e&&e[t.refName]){const n=e[(t=(0,i.isStateTreeNode)(t)?{...(0,i.getSnapshot)(t)}:{...t}).refName];if(n)return{...t,refName:n,originalRefName:t.refName}}return t}async function Q(e,t){const{regions:n=[],adapterConfig:o}=t;if(!t.sessionId)throw new Error("sessionId is required");const s=n.map((e=>e.assemblyName)),r=Object.fromEntries(await Promise.all([...new Set(s)].map((async n=>[n,await e.getRefNameMapForAdapter(o,n,t)]))));return{...t,regions:n.map(((e,t)=>K(r[s[t]],e)))}}function Y(e,t){return[Math.min(e,t),Math.max(e,t)]}function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:70,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;return e.length>t?e.slice(0,n)+"..."+e.slice(-n):e}function X(e,t){let{refName:n,coord:o,assemblyName:s,oob:r}=e;return[s&&t?"{".concat(s,"}"):"",n?"".concat($(n),":").concat(ve(o)).concat(r?" (out of bounds)":""):""].join("")}const ee=/electron/i.test("undefined"!==typeof navigator?navigator.userAgent:"");function te(e){return ne(oe(e))}function ne(e){return e.split("").reverse().join("")}const oe=(()=>{const e=/[ACGT]/gi,t={S:"S",w:"w",T:"A",r:"y",a:"t",N:"N",K:"M",x:"x",d:"h",Y:"R",V:"B",y:"r",M:"K",h:"d",k:"m",C:"G",g:"c",t:"a",A:"T",n:"n",W:"W",X:"X",m:"k",v:"b",B:"V",s:"s",H:"D",c:"g",D:"H",b:"v",R:"Y",G:"C"};return n=>n.replaceAll(e,(e=>t[e]||""))})(),se="undefined"===typeof jest?"undefined"!==typeof window&&window.requestIdleCallback?window.requestIdleCallback:e=>setTimeout((()=>e()),1):e=>e(),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];function ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const n=String(e);let o=0;for(let r=0;r<n.length;r++){var s;const e=n.charCodeAt(r);o+=null!==(s=re[e])&&void 0!==s?s:.5279276315789471}return o*t}const ae=["ATG"],ce=["TAA","TAG","TGA"],le={TCA:"S",TCC:"S",TCG:"S",TCT:"S",TTC:"F",TTT:"F",TTA:"L",TTG:"L",TAC:"Y",TAT:"Y",TAA:"*",TAG:"*",TGC:"C",TGT:"C",TGA:"*",TGG:"W",CTA:"L",CTC:"L",CTG:"L",CTT:"L",CCA:"P",CCC:"P",CCG:"P",CCT:"P",CAC:"H",CAT:"H",CAA:"Q",CAG:"Q",CGA:"R",CGC:"R",CGG:"R",CGT:"R",ATA:"I",ATC:"I",ATT:"I",ATG:"M",ACA:"T",ACC:"T",ACG:"T",ACT:"T",AAC:"N",AAT:"N",AAA:"K",AAG:"K",AGC:"S",AGT:"S",AGA:"R",AGG:"R",GTA:"V",GTC:"V",GTG:"V",GTT:"V",GCA:"A",GCC:"A",GCG:"A",GCT:"A",GAC:"D",GAT:"D",GAA:"E",GAG:"E",GGA:"G",GGC:"G",GGG:"G",GGT:"G"};function de(e){const t={};return Object.keys(e).forEach((n=>{const o=e[n],s=[];for(let e=0;e<3;e++){const t=n.charAt(e);s[e]=[],s[e][0]=t.toUpperCase(),s[e][1]=t.toLowerCase()}for(let e=0;e<2;e++){const n=s[0][e];for(let e=0;e<2;e++){const r=s[1][e];for(let e=0;e<2;e++){const i=s[2][e];t[n+r+i]=o}}}})),t}async function ue(e,t,n){t(e);const o=await n();return t(""),o}function pe(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}function me(e){return"".concat(pe(JSON.stringify(e)))}async function he(e,t){return(await Promise.all(e.map((e=>t.blocksForRange(e.refName,e.start,e.end))))).flat().map((e=>({start:e.minv.blockPosition,end:e.maxv.blockPosition+65535}))).reduce(((e,t)=>e+t.end-t.start),0)}function fe(e){return["Gff3TabixAdapter","VcfTabixAdapter","Gff3Adapter","VcfAdapter"].includes(e)}function ge(e){let t;return t=Math.floor(e/1e6)>0?"".concat(Number.parseFloat((e/1e6).toPrecision(3)),"Mbp"):Math.floor(e/1e3)>0?"".concat(Number.parseFloat((e/1e3).toPrecision(3)),"Kbp"):"".concat(ve(Math.floor(e)),"bp"),t}function ve(e){return e.toLocaleString("en-US")}function ye(e,t){return Math.floor(t/1e3)>0?"".concat(ve(Number.parseFloat((e/1e6).toFixed(2))),"M"):"".concat(ve(Math.floor(e)))}function we(e,t){const{dynamicBlocks:n,staticBlocks:o,offsetPx:s}=j(e),r=(null===n||void 0===n?void 0:n.contentBlocks[0])||{},i=(null===o||void 0===o?void 0:o.contentBlocks[0])||{},a=(null===o||void 0===o?void 0:o.contentBlocks[1])||{};return{offsetPx:t?0:s-i.offsetPx,offsetPx1:t?0:s-a.offsetPx,start:r.start,end:r.end}}function be(e){let{sessionId:t,layoutId:n}=e;return t+"-"+n}function Se(e,t){const[n,s]=(0,o.useState)((()=>{if("undefined"===typeof window)return t;try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(n){return console.error(n),t}}));return[n,t=>{try{const o=t instanceof Function?t(n):t;s(o),"undefined"!==typeof window&&window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(o)}}]}function Ce(e){const{uri:t,baseUri:n=""}=e;let o;try{o=new URL(t,n).href}catch(s){o=t}return o}function xe(e){return r()(e)?(0,c.hb)(e)?Ce(e):JSON.stringify(e):String(e)}function ke(e){return e.replaceAll(/(<([^>]+)>)/gi,"")}function Ae(e){return e.replaceAll(/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,"$1<a href='$2' target=\"_blank\">$2</a>")}function je(e,t){const{padding:n=30,minWidth:o=80,fontSize:s=12,maxWidth:r=1e3,stripHTML:i=!1}=t||{};return Ee(e.map((e=>xe(e))).map((e=>i?ke(e):e)).map((e=>ie(e,s))).map((e=>Math.min(Math.max(e+n,o),r))))}function Me(e){return(0,i.getEnv)(e)}function Te(e){return"undefined"!==typeof localStorage?localStorage.getItem(e):void 0}function Pe(e,t){return"undefined"!==typeof localStorage?localStorage.setItem(e,t):void 0}function Ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0;for(const n of e)t=n>t?n:t;return t}function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;for(const n of e)t=n<t?n:t;return t}function Ne(e){let t=0;for(const n of e)t+=n;return t}function Ze(e){return Ne(e)/e.length}function Re(e,t){const n={};for(const s of e){var o;(n[o=t(s)]||(n[o]=[])).push(s)}return n}function Le(e){return null!==e&&void 0!==e}function De(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;if(e.length<=1)return e;const n=[];let o=null;e=e.sort(((e,t)=>e.start-t.start)),n.push(e[0]);for(let s=1;s<e.length;s++)o=n.at(-1),o.end+t<e[s].start-t?n.push(e[s]):o.end<e[s].end&&(o.end=Math.max(o.end,e[s].end),n.pop(),n.push(o));return n}function We(e){const t={};for(const n of e)t[n.refName]||(t[n.refName]=[]),t[n.refName].push(n);return Object.values(t).flatMap((e=>De(e.sort(((e,t)=>e.start-t.start)))))}function ze(e){return(0,u.V)(e).alpha(1).toHex()}},1502:(e,t,n)=>{n.r(t),n.d(t,{BlobLocation:()=>m,ElementId:()=>c,FileLocation:()=>g,LocalPathLocation:()=>p,NoAssemblyRegion:()=>d,PropTypes:()=>l,Region:()=>u,UriLocation:()=>f,UriLocationRaw:()=>h});var o=n(31625),s=n(93250),r=n.n(s),i=n(3762),a=n(45466);const c=o.types.optional(o.types.identifier,(()=>(0,a.x0)())),l={Region:r().shape({refName:r().string.isRequired,start:r().number.isRequired,end:r().number.isRequired}),ConfigSchema:i.PropTypes.objectOrObservableObject,Feature:r().shape({get:r().func.isRequired,id:r().func.isRequired})},d=o.types.model("NoAssemblyRegion",{refName:o.types.string,start:o.types.number,end:o.types.number,reversed:o.types.optional(o.types.boolean,!1)}).actions((e=>({setRefName(t){e.refName=t}}))),u=o.types.compose("Region",d,o.types.model({assemblyName:o.types.string})),p=o.types.model("LocalPathLocation",{locationType:o.types.literal("LocalPathLocation"),localPath:o.types.string}),m=o.types.model("BlobLocation",{locationType:o.types.literal("BlobLocation"),name:o.types.string,blobId:o.types.string}),h=o.types.model("UriLocation",{locationType:o.types.literal("UriLocation"),uri:o.types.string,baseUri:o.types.maybe(o.types.string),internetAccountId:o.types.maybe(o.types.string),internetAccountPreAuthorization:o.types.maybe(o.types.model("InternetAccountPreAuthorization",{internetAccountType:o.types.string,authInfo:o.types.frozen()}))}),f=o.types.snapshotProcessor(h,{postProcessor:e=>{const{baseUri:t,...n}=e;return t?e:n}}),g=o.types.snapshotProcessor(o.types.union(p,f,m),{preProcessor(e){if(!e)return;const{locationType:t,...n}=e;if(!t){const{uri:e,localPath:t,blob:o}=n;let s="";return void 0!==e?s="UriLocation":void 0!==t?s="LocalPathLocation":void 0!==o&&(s="BlobLocation"),{...n,locationType:s}}return e}})},10730:(e,t,n)=>{n.d(t,{Ac:()=>r,N_:()=>i});var o=n(31625),s=n(1502);function r(e){return o.types.model({id:s.ElementId,name:o.types.string,margin:0}).volatile((()=>({selection:void 0,hovered:void 0}))).views((e=>({get root(){return(0,o.getParent)(e)}}))).views((e=>({get jbrowse(){return e.root.jbrowse},get rpcManager(){return e.root.rpcManager},get configuration(){return this.jbrowse.configuration},get adminMode(){return e.root.adminMode},get textSearchManager(){return e.root.textSearchManager}}))).views((e=>({get assemblies(){return e.jbrowse.assemblies}}))).actions((e=>({setSelection(t){e.selection=t},clearSelection(){e.selection=void 0},setHovered(t){e.hovered=t}})))}function i(e){return"id"in e&&"name"in e&&"root"in e}},74761:(e,t,n)=>{n.d(t,{C:()=>i,n:()=>a});var o=n(43800),s=n(31625),r=n(10730);function i(e){return s.types.model({connectionInstances:s.types.array(e.pluggableMstType("connection","stateModel"))}).views((e=>({get connections(){const{jbrowse:t}=e;return t.connections}}))).actions((t=>({makeConnection(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.type;if(!r)throw new Error("track configuration has no `type` listed");const i=(0,o.readConfObject)(n,"name");if(!e.getConnectionType(r))throw new Error("unknown connection type ".concat(r));const a=t.connectionInstances.push({...s,name:i,type:r,configuration:n});return t.connectionInstances[a-1]},prepareToBreakConnection(e){const n=t,s=[],r={},i=(0,o.readConfObject)(e,"name"),a=t.connectionInstances.find((e=>e.name===i));if(a){for(const e of a.tracks){const t=n.getReferring(e);n.removeReferring(t,e,s,r)}return[()=>{s.forEach((e=>e())),this.breakConnection(e)},r]}},breakConnection(e){const n=(0,o.readConfObject)(e,"name"),s=t.connectionInstances.find((e=>e.name===n));if(!s)throw new Error("no connection found with name ".concat(n));t.connectionInstances.remove(s)},deleteConnection(e){const{jbrowse:n}=t;return n.deleteConnectionConf(e)},addConnectionConf(e){const{jbrowse:n}=t;return n.addConnectionConf(e)},clearConnections(){t.connectionInstances.clear()}})))}function a(e){return(0,r.N_)(e)&&"connectionInstances"in e}},35354:(e,t,n)=>{n.d(t,{K:()=>d,Z:()=>u});var o=n(41867),s=n(27032),r=n(72602),i=n(88654),a=n(19462),c=n(58391),l=n(66504);const d=(0,o.lazy)((()=>n.e(2458).then(n.bind(n,2458)))),u=class extends s.Z{constructor(){super(...arguments),this.name="DataManagementPlugin",this.exports={AssemblyManager:d}}install(e){(0,r.Z)(e),(0,i.Z)(e),(0,l.ZP)(e),(0,a.Z)(e),(0,c.Z)(e)}configure(e){}}},33136:(e,t,n)=>{n.r(t),n.d(t,{Loader:()=>Ht,default:()=>$t});var o=n(41867),s=n(3762),r=n(97486),i=n(93438),a=n(49677),c=n(35421),l=(n(80008),n(56505)),d=n(31625),u=n(81096),p=n(98406),m=n(70974),h=n(47192),f=n(73067),g=n(77327),v=n(23801),y=n(68367),w=n(22177),b=n(80838);const S=(0,s.observer)((function(e){let{session:t}=e;const{snackbarMessages:n}=t,o=n.at(-1),s=(e,n)=>{"clickaway"!==n&&t.popSnackbarMessage()};return o?(0,b.jsx)(f.Z,{open:!0,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,b.jsx)(g.Z,{onClose:s,action:o.action?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Z,{color:"inherit",onClick:e=>{var t;null===(t=o.action)||void 0===t||t.onClick(),s()},children:o.action.name}),(0,b.jsx)(y.Z,{color:"inherit",onClick:s,children:(0,b.jsx)(w.Z,{})})]}):null,severity:o.level||"warning",children:o.message})}):null}));var C=n(69625),x=n(77573),k=n(71939),A=n(41064),j=n(56762);const M=(0,h.ZL)()((e=>({buttonRoot:{"&:hover":{backgroundColor:(0,k.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}))),T=(0,s.observer)((function(e){let{menuTitle:t,session:n,menuItems:s}=e;const[r,i]=(0,o.useState)(!1),a=(0,o.useRef)(null),{classes:c}=M();function l(){i(!1)}return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(v.Z,{ref:a,onClick:()=>i(!r),color:"inherit","data-testid":"dropDownMenuButton",classes:{root:c.buttonRoot},children:[t,(0,b.jsx)(A.Z,{})]}),(0,b.jsx)(j.Z,{anchorEl:a.current,anchorOrigin:{vertical:"bottom",horizontal:"left"},onMenuItemClick:(e,t)=>{t(n),l()},open:r,onClose:l,menuItems:s})]})}));var P=n(15072),E=n(43800),I=n(51572);const N=(0,s.observer)((function(e){let{session:t}=e;const{configuration:n}=t,o=(0,E.readConfObject)(n,"logoPath");return null!==o&&void 0!==o&&o.uri?(0,b.jsx)("img",{src:o.uri,alt:"Custom logo"}):(0,b.jsx)(I.e,{variant:"white"})})),Z=(0,h.ZL)()((e=>({grow:{flexGrow:1},inputBase:{color:e.palette.primary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.primary.light}},inputFocused:{borderColor:e.palette.secondary.main,backgroundColor:e.palette.primary.light}}))),R=(0,s.observer)((function(e){let{session:t,HeaderButtons:n=(0,b.jsx)("div",{})}=e;const{classes:o}=Z(),{savedSessionNames:s,name:r,menus:i}=t;return(0,b.jsxs)(C.Z,{children:[i.map((e=>(0,b.jsx)(T,{menuTitle:e.label,menuItems:e.menuItems,session:t},e.label))),(0,b.jsx)("div",{className:o.grow}),(0,b.jsx)(x.Z,{title:"Rename Session",arrow:!0,children:(0,b.jsx)(P.Z,{value:r,setValue:e=>{null!==s&&void 0!==s&&s.includes(e)?t.notify('Cannot rename session to "'.concat(e,'", a saved session with that name already exists'),"warning"):t.renameCurrentSession(e)},variant:"body1",classes:{inputBase:o.inputBase,inputRoot:o.inputRoot,inputFocused:o.inputFocused}})}),n,(0,b.jsx)("div",{className:o.grow}),(0,b.jsx)("div",{style:{width:150,maxHeight:48},children:(0,b.jsx)(N,{session:t})})]})}));var L=n(7229),D=n(51590),W=n(90552),z=n(36669),O=n(59231),V=n(90872);const U=(0,h.ZL)()((e=>({selectPaper:{padding:e.spacing(4)}}))),F=(0,s.observer)((e=>{var t;let{session:n}=e;const{classes:s}=U(),{pluginManager:r}=(0,V.getEnv)(n),i=r.getElementTypeRecord("view").all(),[a,c]=(0,o.useState)(null===(t=i[0])||void 0===t?void 0:t.name);return(0,b.jsxs)(L.Z,{className:s.selectPaper,children:[(0,b.jsx)(D.Z,{children:"Select a view to launch"}),(0,b.jsx)(W.Z,{style:{margin:2},children:(0,b.jsx)(z.Z,{value:a,onChange:e=>c(e.target.value),children:i.map((e=>{let{displayName:t,name:n}=e;return(0,b.jsx)(O.Z,{value:n,children:t},n)}))})}),(0,b.jsx)(W.Z,{style:{margin:2},children:(0,b.jsx)(v.Z,{onClick:()=>n.addView(a,{}),variant:"contained",color:"primary",children:"Launch view"})})]})}));var B=n(86163),q=n(28164),G=n(17280),_=n(18087),J=n(36686),H=n(84333),K=n(69282),Q=n(3086),Y=n(11949),$=n(6247);const X=(0,s.observer)((function(e){let{model:t,IconProps:n}=e;const{menuItems:o}=t,s=(0,V.getSession)(t),r=[...s.views.length>1?[{label:"Move view up",icon:$.Z,onClick:()=>s.moveViewUp(t.id)},{label:"Move view down",icon:Y.Z,onClick:()=>s.moveViewDown(t.id)}]:[],...("function"===typeof o?o():o)||[]];return r.length?(0,b.jsx)(K.Z,{menuItems:r,"data-testid":"view_menu_icon",children:(0,b.jsx)(Q.Z,{...n,fontSize:"small"})}):null})),ee=(0,h.ZL)()((e=>({input:{paddingBottom:0,paddingTop:2},inputBase:{color:e.palette.secondary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.secondary.light}},inputFocused:{borderColor:e.palette.primary.main,backgroundColor:e.palette.secondary.light}}))),te=(0,s.observer)((function(e){var t;let{view:n}=e;const{classes:o}=ee();return(0,b.jsx)(x.Z,{title:"Rename view",arrow:!0,children:(0,b.jsx)(P.Z,{value:n.displayName||"".concat((null===(t=n.assemblyNames)||void 0===t?void 0:t.join(","))||"Untitled view").concat(n.minimized?" (minimized)":""),setValue:e=>n.setDisplayName(e),variant:"body2",classes:{input:o.input,inputBase:o.inputBase,inputRoot:o.inputRoot,inputFocused:o.inputFocused}})})})),ne=(0,h.ZL)()((e=>({icon:{color:e.palette.secondary.contrastText},grow:{flexGrow:1},viewHeader:{display:"flex"},viewTitle:{display:"flex",alignItems:"center"}}))),oe=(0,s.observer)((function(e){let{view:t,onClose:n,onMinimize:o}=e;const{classes:s}=ne();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.Z,{"data-testid":"minimize_view",onClick:o,children:t.minimized?(0,b.jsx)(J.Z,{className:s.icon,fontSize:"small"}):(0,b.jsx)(_.Z,{className:s.icon,fontSize:"small"})}),(0,b.jsx)(y.Z,{"data-testid":"close_view",onClick:n,children:(0,b.jsx)(w.Z,{className:s.icon,fontSize:"small"})})]})})),se=(0,s.observer)((function(e){let{view:t,onClose:n,onMinimize:s}=e;const{classes:r}=ne(),i=(0,o.useRef)(null),a=(0,V.getSession)(t);return(0,o.useEffect)((()=>{var e,t;null===(e=i.current)||void 0===e||null===(t=e.scrollIntoView)||void 0===t||t.call(e,{block:"center"})}),[]),(0,b.jsxs)("div",{ref:i,className:r.viewHeader,children:[(0,b.jsx)(X,{model:t,IconProps:{className:r.icon}}),(0,b.jsx)("div",{className:r.grow}),(0,b.jsxs)("div",{className:r.viewTitle,children:[a.focusedViewId===t.id?(0,b.jsx)(H.Z,{className:r.icon,fontSize:"small"}):null,(0,b.jsx)(te,{view:t})]}),(0,b.jsx)("div",{className:r.grow}),(0,b.jsx)(oe,{onClose:n,onMinimize:s,view:t})]})})),re=(0,h.ZL)()((e=>({viewContainer:{overflow:"hidden",margin:e.spacing(.5),padding:"0 ".concat(e.spacing(1)," ").concat(e.spacing(1))},focusedView:{background:e.palette.secondary.main},unfocusedView:{background:e.palette.secondary.dark}}))),ie=(0,s.observer)((function(e){let{view:t,onClose:n,onMinimize:s,children:r}=e;const i=(0,G.Z)(),a=(0,V.useWidthSetter)(t,i.spacing(1)),{classes:c,cx:l}=re(),d=(0,V.getSession)(t);return(0,o.useEffect)((()=>{function e(e){e.target instanceof Element&&null!==a&&void 0!==a&&a.current&&a.current.contains(e.target)&&d.setFocusedViewId(t.id)}return document.addEventListener("mousedown",e),document.addEventListener("keydown",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",e)}}),[a,d,t]),(0,b.jsxs)(L.Z,{ref:a,elevation:12,className:l(c.viewContainer,d.focusedViewId===t.id?c.focusedView:c.unfocusedView),children:[(0,b.jsx)(se,{view:t,onClose:n,onMinimize:s}),(0,b.jsx)(L.Z,{children:r})]})})),ae=(0,s.observer)((function(e){let{view:t,session:n}=e;const{pluginManager:s}=(0,V.getEnv)(n),i=s.getViewType(t.type);if(!i)throw new Error("unknown view type ".concat(t.type));const{ReactComponent:a}=i;return(0,b.jsx)(ie,{view:t,onClose:()=>n.removeView(t),onMinimize:()=>t.setMinimized(!t.minimized),children:!t.minimized&&(0,b.jsx)(r.SV,{FallbackComponent:e=>{let{error:t}=e;return(0,b.jsx)(B.Z,{error:t})},children:(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(q.Z,{variant:"h6"}),children:(0,b.jsx)(a,{model:t,session:n})})})})})),ce=(0,s.observer)((function(e){let{session:t}=e;const{DialogComponent:n,DialogProps:s}=t;return(0,b.jsx)(b.Fragment,{children:n?(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(o.Fragment,{}),children:(0,b.jsx)(n,{...s})}):null})}));var le=n(49595),de=n(14106);const ue=(0,h.ZL)()((e=>({left:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},right:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}))),pe=(0,s.observer)((function(e){let{session:t}=e;const{minimized:n,activeWidgets:o,drawerPosition:s}=t,{classes:r}=ue();return o.size>0&&n?(0,b.jsx)(x.Z,{title:"Open drawer widget",children:(0,b.jsx)(le.Z,{className:"right"===s?r.right:r.left,color:"primary","data-testid":"drawer-maximize",onClick:()=>t.showWidgetDrawer(),children:(0,b.jsx)(de.Z,{})})}):null})),me=(0,o.lazy)((()=>n.e(634).then(n.bind(n,40634)))),he=(0,h.ZL)()((e=>({root:{display:"grid",height:"100vh",width:"100%",colorScheme:e.palette.mode},appContainer:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},viewContainer:{overflowY:"auto",gridRow:"components"},appBar:{flexGrow:1,gridRow:"menubar"}}))),fe=(0,s.observer)((function(e){const{session:t}=e;return(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(o.Fragment,{}),children:(0,b.jsx)(me,{session:t})})})),ge=(0,s.observer)((function(e){const{session:t}=e,{views:n}=t,{classes:o}=he();return(0,b.jsxs)("div",{className:o.viewContainer,children:[n.length>0?n.map((e=>(0,b.jsx)(ae,{view:e,session:t},"view-".concat(e.id)))):(0,b.jsx)(F,{...e}),(0,b.jsx)("div",{style:{height:300}})]})})),ve=(0,s.observer)((function(e){const{session:t}=e,{classes:n}=he(),{minimized:o,visibleWidget:s,drawerWidth:r,drawerPosition:i}=t,a=s&&!o,c=a?"[drawer] ".concat(r,"px"):void 0,l="right"===i?["[main] 1fr",c]:[c,"[main] 1fr"];return(0,b.jsxs)("div",{className:n.root,style:{gridTemplateColumns:null===l||void 0===l?void 0:l.filter((e=>!!e)).join(" ")},children:[a&&"left"===i?(0,b.jsx)(fe,{session:t}):null,(0,b.jsx)(ce,{session:t}),(0,b.jsxs)("div",{className:n.appContainer,children:[(0,b.jsx)(m.Z,{className:n.appBar,position:"static",children:(0,b.jsx)(R,{...e})}),(0,b.jsx)(ge,{...e})]}),(0,b.jsx)(pe,{session:t}),a&&"right"===i?(0,b.jsx)(fe,{session:t}):null,(0,b.jsx)(S,{session:t})]})}));const ye=d.types.model("TimeTraveller",{undoIdx:-1,targetPath:""}).volatile((()=>({history:[],notTrackingUndo:!1}))).views((e=>({get canUndo(){return e.undoIdx>0&&!e.notTrackingUndo},get canRedo(){return e.undoIdx<e.history.length-1&&!e.notTrackingUndo}}))).actions((e=>{let t,n,o=!1;return{stopTrackingUndo(){e.notTrackingUndo=!0},resumeTrackingUndo(){e.notTrackingUndo=!1},addUndoState(t){e.notTrackingUndo||(o?o=!1:(e.history.splice(e.undoIdx+1),e.history.push(t),e.history.length>20&&e.history.shift(),e.undoIdx=e.history.length-1))},beforeDestroy(){n()},initialize(){if(t=e.targetPath?(0,d.resolvePath)(e,e.targetPath):(0,d.getEnv)(e).targetStore,!t)throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath` property, or a `targetStore` in the environment");n=(0,d.onSnapshot)(t,function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];clearTimeout(t),t=setTimeout((()=>e(...s)),n)}}((e=>this.addUndoState(e)),300)),0===e.history.length&&this.addUndoState((0,d.getSnapshot)(t))},undo(){e.undoIdx--,o=!0,(0,d.applySnapshot)(t,e.history[e.undoIdx])},redo(){e.undoIdx++,o=!0,(0,d.applySnapshot)(t,e.history[e.undoIdx])}}}));var we=n(85815);const be=(0,E.ConfigurationSchema)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0});const Se=(0,E.ConfigurationSchema)("WebWorkerRpcDriver",{},{baseConfiguration:be,explicitlyTyped:!0});const Ce=(0,E.ConfigurationSchema)("MainThreadRpcDriver",{},{baseConfiguration:be,explicitlyTyped:!0});const xe=(0,E.ConfigurationSchema)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:d.types.optional(d.types.map(d.types.union(Ce,Se)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"},WebWorkerRpcDriver:{type:"WebWorkerRpcDriver"}})},{actions:e=>({addDriverConfig(t,n){e.drivers.set(t,n)}})});var ke=n(87317),Ae=n(23480),je=n(45466),Me=n(58062);function Te(e){return!("function"===typeof e)&&!(e instanceof Error)}class Pe{constructor(e){this.driver=e,this.workerP=void 0}async getWorker(){return this.workerP||(this.workerP=this.driver.makeWorker().then((e=>(async function(e,t,n){for(;;)await e.call("ping",[],{timeout:2*t,rpcDriverClassName:n}),await new Promise((e=>setTimeout(e,t)))}(e,this.driver.maxPingTime,this.driver.name).catch((t=>{e&&(console.error("worker did not respond, killing and generating new one"),console.error(t),e.destroy(),e.status="killed",e.error=t,this.workerP=void 0)})),e))).catch((e=>{throw this.workerP=void 0,e}))),this.workerP}}class Ee{constructor(e){this.name=void 0,this.lastWorkerAssignment=-1,this.workerAssignments=new Map,this.workerPool=void 0,this.maxPingTime=3e4,this.workerCheckFrequency=5e3,this.config=void 0,this.config=e.config}filterArgs(e,t){if(Array.isArray(e))return e.filter((e=>Te(e))).map((e=>this.filterArgs(e,t)));if("object"===typeof e&&null!==e){if(e instanceof AbortSignal)return(0,Me.Iy)(e,this.remoteAbort.bind(this,t));if((0,d.isStateTreeNode)(e)&&!(0,d.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:Object.fromEntries(Object.entries(e).filter((e=>Te(e[1]))).map((e=>{let[n,o]=e;return[n,this.filterArgs(o,t)]})))}return e}async remoteAbort(e,t,n){const o=await this.getWorker(e);await o.call(t,{signalId:n},{timeout:1e6,rpcDriverClassName:this.name})}createWorkerPool(){const e=function(){const e="undefined"!==typeof window,t=e&&"hardwareConcurrency"in window.navigator;return e&&t?window.navigator.hardwareConcurrency:1}(),t=(0,E.readConfObject)(this.config,"workerCount")||(0,V.clamp)(1,Math.max(1,e-1),5),n=[];for(let o=0;o<t;o++)n.push(new Pe(this));return n}getWorkerPool(){if(!this.workerPool){const e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}async getWorker(e){const t=this.getWorkerPool();let n=this.workerAssignments.get(e);if(void 0===n){const o=(this.lastWorkerAssignment+1)%t.length;this.workerAssignments.set(e,o),this.lastWorkerAssignment=o,n=o}return t[n].getWorker()}async call(e,t,n,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!t)throw new TypeError("sessionId is required");let r=!1;const i=await this.getWorker(t),a=e.evaluateExtensionPoint("Core-extendWorker",i),c=e.getRpcMethodType(n),l=await c.serializeArguments(o,this.name),d=this.filterArgs(l,t),u=a.call(n,d,{timeout:3e5,statusCallback:o.statusCallback,rpcDriverClassName:this.name,...s}).finally((()=>{r=!0}));let p;const m=new Promise(((e,t)=>{p=setInterval((()=>{"killed"===a.status?t(new Error("operation timed out, worker process stopped responding, ".concat(a.error))):r&&e(!0)}),this.workerCheckFrequency)})).finally((()=>{clearInterval(p)})),h=Promise.race([u,m]);return c.deserializeReturn(h,o,this.name)}}class Ie extends ke.Z.Client{destroy(){this.workers[0].terminate()}async call(e,t,n){const{statusCallback:o,rpcDriverClassName:s}=n,r="message-".concat((0,je.x0)()),i=e=>{null===o||void 0===o||o(e)};this.on(r,i);const a=await super.call(e,{...t,channel:r,rpcDriverClassName:s},n);return this.off(r,i),a}}class Ne extends Ee{constructor(e,t){super(e),this.workerBootConfiguration=t,this.name="WebWorkerRpcDriver",this.makeWorkerInstance=void 0,this.makeWorkerInstance=e.makeWorkerInstance}async makeWorker(){const e=this.makeWorkerInstance(),t=new Ie({workers:[e]});return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&console.log("console logging the webworker handle avoids the track going into an infinite loading state, this is a hacky workaround for safari",e),new Promise(((e,n)=>{const o=s=>{switch(s.data.message){case"ready":e(t),t.workers[0].removeEventListener("message",o);break;case"readyForConfig":t.workers[0].postMessage({message:"config",config:this.workerBootConfiguration});break;case"error":n((0,Ae.deserializeError)(s.data.error))}};t.workers[0].addEventListener("message",o)}))}}class Ze{destroy(){}async call(e,t){}}class Re extends Ee{constructor(e){super(e),this.name="MainThreadRpcDriver",this.makeWorker=void 0,this.makeWorker=async()=>new Ze}async call(e,t,n,o){if(!t)throw new TypeError("sessionId is required");const s=e.getRpcMethodType(n),r=await s.serializeArguments(o,this.name),i=await s.execute(r,this.name);return s.deserializeReturn(i,o,this.name)}}class Le{constructor(e,t,n){if(this.pluginManager=e,this.mainConfiguration=t,this.backendConfigurations=n,this.driverObjects=void 0,!t)throw new Error("RpcManager requires at least a main configuration");this.driverObjects=new Map}getDriver(e){const t=this.driverObjects.get(e);if(t)return t;let n;const o=this.mainConfiguration.drivers.get("WebWorkerRpcDriver");if("MainThreadRpcDriver"===e){const t=this.backendConfigurations.MainThreadRpcDriver;if(!t)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new Re({...t,config:o})}else{if("WebWorkerRpcDriver"!==e)throw new Error('requested RPC driver "'.concat(e,'" is not installed'));{const t=this.backendConfigurations.WebWorkerRpcDriver;if(!t)throw new Error('requested RPC driver "'.concat(e,'" is missing config'));n=new Ne({...t,config:o},{plugins:this.pluginManager.runtimePluginDefinitions,windowHref:window.location.href})}}return this.driverObjects.set(e,n),n}async getDriverForCall(e,t,n){const o=n.rpcDriverName||(0,E.readConfObject)(this.mainConfiguration,"defaultDriver");return this.getDriver(o)}async call(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e)throw new Error("sessionId is required");return(await this.getDriverForCall(e,t,n)).call(this.pluginManager,e,t,n,o)}}function De(e){let{pluginManager:t,assemblyConfigSchema:n}=e;return function(e){let{pluginManager:t,assemblyConfigSchema:n}=e;return d.types.model("JBrowseConfig",{configuration:(0,E.ConfigurationSchema)("Root",{rpc:Le.configSchema,highResolutionScaling:{type:"number",defaultValue:2},formatDetails:(0,E.ConfigurationSchema)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth to iterate on subfeatures"}}),formatAbout:(0,E.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}}),shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},disableAnalytics:{type:"boolean",defaultValue:!1},hierarchical:(0,E.ConfigurationSchema)("hierarchical",{sort:(0,E.ConfigurationSchema)("hierarchicalSort",{trackNames:{type:"boolean",defaultValue:!1},categories:{type:"boolean",defaultValue:!1}}),defaultCollapsed:(0,E.ConfigurationSchema)("defaultCollapsed",{categoryNames:{type:"stringArray",defaultValue:[]},topLevelCategories:{type:"boolean",defaultValue:!1},subCategories:{type:"boolean",defaultValue:!1}})}),theme:{type:"frozen",defaultValue:{}},extraThemes:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}},...t.pluginConfigurationSchemas()}),plugins:d.types.array(d.types.frozen()),assemblies:d.types.array(n),tracks:d.types.array(t.pluggableConfigSchemaType("track")),internetAccounts:d.types.array(t.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:d.types.array(t.pluggableConfigSchemaType("text search adapter")),connections:d.types.array(t.pluggableConfigSchemaType("connection")),defaultSession:d.types.optional(d.types.frozen(),{name:"New Session"})})}({pluginManager:t,assemblyConfigSchema:n}).views((e=>({get assemblyNames(){return e.assemblies.map((e=>(0,E.readConfObject)(e,"name")))},get rpcManager(){return(0,d.getParent)(e).rpcManager}}))).actions((e=>({addAssemblyConf(t){const{name:n}=t;if(!n)throw new Error('Can\'t add assembly with no "name"');if(e.assemblyNames.includes(n))throw new Error("Can't add assembly with name \"".concat(n,'", an assembly with that name already exists'));const o=e.assemblies.push({...t,sequence:{type:"ReferenceSequenceTrack",trackId:"".concat(n,"-").concat(Date.now()),...t.sequence}});return e.assemblies[o-1]},removeAssemblyConf(t){const n=e.assemblies.find((e=>e.name===t));n&&e.assemblies.remove(n)},addTrackConf(t){const{type:n}=t;if(!n)throw new Error("unknown track type ".concat(n));const o=e.tracks.push(t);return e.tracks[o-1]},addConnectionConf(t){const{type:n}=t;if(!n)throw new Error("unknown connection type ".concat(n));const o=e.connections.push(t);return e.connections[o-1]},deleteConnectionConf(t){const n=e.connections.find((e=>e.id===t.id));return e.connections.remove(n)},deleteTrackConf(t){const n=e.tracks.find((e=>e.trackId===t.trackId));return e.tracks.remove(n)},addPlugin(t){e.plugins.push(t);(0,d.getParent)(e).setPluginsUpdated(!0)},removePlugin(t){e.plugins=(0,d.cast)(e.plugins.filter((e=>e.url!==t.url||e.umdUrl!==t.umdUrl||e.cjsUrl!==t.cjsUrl||e.esmUrl!==t.esmUrl))),(0,d.getParent)(e).setPluginsUpdated(!0)},setDefaultSessionConf(t){const n=(0,d.getParent)(e).session.name===t.name?(0,d.getSnapshot)(t):(0,we.toJS)(t);if(!n.name)throw new Error("unable to set default session to ".concat(n.name));e.defaultSession=(0,d.cast)(n)},addInternetAccountConf(t){const{type:n}=t;if(!n)throw new Error("unknown internetAccount type ".concat(n));const o=e.internetAccounts.push(t);return e.internetAccounts[o-1]},deleteInternetAccountConf(t){const n=e.internetAccounts.find((e=>e.id===t.id));return e.internetAccounts.remove(n)}})))}Le.configSchema=xe;var We=n(40202);const ze=(0,h.ZL)()((e=>({shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{backgroundColor:(0,k.Fq)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}))),Oe=(0,o.lazy)((()=>n.e(5544).then(n.bind(n,45544)))),Ve=(0,s.observer)((function(e){const[t,n]=(0,o.useState)(!1),{session:s}=e,{classes:r}=ze();return(0,b.jsxs)("div",{className:r.shareDiv,children:[(0,b.jsx)(v.Z,{onClick:async()=>n(!0),size:"small",color:"inherit",startIcon:(0,b.jsx)(We.Z,{}),classes:{root:r.shareButton},children:"Share"}),t?(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(o.Fragment,{}),children:(0,b.jsx)(Oe,{handleClose:()=>n(!1),session:s})}):null]})})),Ue=(0,s.observer)((function(e){let{pluginManager:t}=e;const[n]=(0,i.useQueryParam)("adminKey",i.StringParam),[s]=(0,i.useQueryParam)("adminServer",i.StringParam),[r]=(0,i.useQueryParam)("config",i.StringParam),[,a]=(0,i.useQueryParam)("session",i.StringParam),{rootModel:c}=t,{error:l,jbrowse:m}=c||{},h=null===c||void 0===c?void 0:c.session,f=h.id;if((0,o.useEffect)((()=>{a("local-".concat(f),"replaceIn"),window.JBrowseRootModel=c,window.JBrowseSession=h}),[f,c,h,a]),(0,o.useEffect)((()=>{if(m&&n)return(0,d.onSnapshot)(m,(async e=>{try{const t=await fetch(s||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:n,configPath:r,config:e})});if(!t.ok){const e=await t.text();throw new Error("HTTP ".concat(t.status," (").concat(e,")"))}}catch(t){null===h||void 0===h||h.notify("Admin server error: ".concat(t))}}))}),[m,h,n,s,r]),l)throw l;if(!c)throw new Error("No rootModel found");if(!h)throw new Error("No session found");return(0,b.jsxs)(u.Z,{theme:h.theme,children:[(0,b.jsx)(p.ZP,{}),(0,b.jsx)(ve,{session:h,HeaderButtons:(0,b.jsx)(Ve,{session:h})})]})}));var Fe=n(91932),Be=n(67677),qe=n(59062),Ge=n(53064),_e=n(71883);const Je=d.types.model({configPath:d.types.maybe(d.types.string),sessionQuery:d.types.maybe(d.types.string),password:d.types.maybe(d.types.string),adminKey:d.types.maybe(d.types.string),loc:d.types.maybe(d.types.string),sessionTracks:d.types.maybe(d.types.string),assembly:d.types.maybe(d.types.string),tracks:d.types.maybe(d.types.string),initialTimestamp:d.types.number}).volatile((()=>({sessionTriaged:void 0,configSnapshot:void 0,sessionSnapshot:void 0,sessionSpec:void 0,blankSession:!1,runtimePlugins:[],sessionPlugins:[],sessionError:void 0,configError:void 0,bc1:window.BroadcastChannel&&new window.BroadcastChannel("jb_request_session"),bc2:window.BroadcastChannel&&new window.BroadcastChannel("jb_respond_session")}))).views((e=>({get isSharedSession(){var t;return!(null===(t=e.sessionQuery)||void 0===t||!t.startsWith("share-"))},get isSpecSession(){var t;return!(null===(t=e.sessionQuery)||void 0===t||!t.startsWith("spec-"))},get isJb1StyleSession(){return!!e.loc},get isEncodedSession(){var t;return!(null===(t=e.sessionQuery)||void 0===t||!t.startsWith("encoded-"))},get isJsonSession(){var t;return!(null===(t=e.sessionQuery)||void 0===t||!t.startsWith("json-"))},get isLocalSession(){var t;return!(null===(t=e.sessionQuery)||void 0===t||!t.startsWith("local-"))},get ready(){return Boolean(this.isSessionLoaded&&!e.configError)},get error(){return e.configError||e.sessionError},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]}}))).actions((e=>({setSessionQuery(t){e.sessionQuery=t},setConfigError(t){e.configError=t},setSessionError(t){e.sessionError=t},setRuntimePlugins(t){e.runtimePlugins=t},setSessionPlugins(t){e.sessionPlugins=t},setConfigSnapshot(t){e.configSnapshot=t},setBlankSession(t){e.blankSession=t},setSessionTriaged(t){e.sessionTriaged=t},setSessionSnapshotSuccess(t){e.sessionSnapshot=t}}))).actions((e=>({async fetchPlugins(t){try{const n=new Be.ZP(t.plugins,{fetchESM:e=>import(e)});n.installGlobalReExports(window);const o=await n.load(window.location.href);e.setRuntimePlugins([...o])}catch(n){console.error(n),e.setConfigError(n)}},async fetchSessionPlugins(t){try{const n=new Be.ZP(t.sessionPlugins||[],{fetchESM:e=>import(e)});n.installGlobalReExports(window);const o=await n.load(window.location.href);e.setSessionPlugins([...o])}catch(n){console.error(n),e.setConfigError(n)}},async setSessionSnapshot(t,n){try{const{sessionPlugins:o=[]}=t;await(0,_e.t$)(o)||n?(await this.fetchSessionPlugins(t),e.setSessionSnapshotSuccess(t)):e.setSessionTriaged({snap:t,origin:"session",reason:o})}catch(o){console.error(o),e.setConfigError(o)}},async fetchConfig(){let{configPath:t=window.__jbrowseConfigPath||"config.json"}=e;window.__jbrowseCacheBuster&&(t+="?rand=".concat(Math.random()));const n=await(0,qe.openLocation)({uri:t,locationType:"UriLocation"}).readFile("utf8"),o=JSON.parse(n),s=new URL(t,window.location.href);if((0,_e.H1)(o,s),s.hostname!==window.location.hostname){const t=o.plugins||[];if(!await(0,_e.t$)(t))return e.setSessionTriaged({snap:o,origin:"config",reason:t})}await this.fetchPlugins(o),e.setConfigSnapshot(o)},async fetchSessionStorageSession(){const t=sessionStorage.getItem("current"),n=e.sessionQuery.replace("local-","");if(t){const e=JSON.parse(t).session||{};if(n===e.id)return this.setSessionSnapshot(e)}if(e.bc1){e.bc1.postMessage(n);try{const t=await new Promise(((t,n)=>{e.bc2&&(e.bc2.onmessage=e=>{t(e.data)}),setTimeout((()=>n()),1e3)}));return this.setSessionSnapshot({...t,id:(0,je.x0)()})}catch(o){}}throw new Error("Local storage session not found")},async fetchSharedSession(){const t=await(0,Ge.h)("".concat((0,_e.bP)(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/"),"load"),e.sessionQuery||"",e.password||""),n=JSON.parse(await(0,_e.cD)(t));await this.setSessionSnapshot({...n,id:(0,je.x0)()})},async decodeEncodedUrlSession(){const t=JSON.parse(await(0,_e.cD)(e.sessionQuery.replace("encoded-","")));await this.setSessionSnapshot({...t,id:(0,je.x0)()})},decodeSessionSpec(){e.sessionQuery&&(e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-","")))},decodeJb1StyleSession(){const{loc:t,tracks:n,assembly:o,sessionTracksParsed:s}=e;t&&(e.sessionSpec={sessionTracks:s,views:[{type:"LinearGenomeView",tracks:null===n||void 0===n?void 0:n.split(","),sessionTracks:s,loc:t,assembly:o}]})},async decodeJsonUrlSession(){const t=JSON.parse(e.sessionQuery.replace("json-",""));await this.setSessionSnapshot({...t.session,id:(0,je.x0)()})},async afterCreate(){try{const{configPath:t}=e,n=localStorage.getItem("autosave-".concat(t));n&&localStorage.setItem("previousAutosave-".concat(t),n)}catch(t){console.error("failed to create previousAutosave",t)}try{await this.fetchConfig()}catch(t){return console.error(t),void e.setConfigError(t)}(0,d.addDisposer)(e,(0,we.autorun)((async()=>{try{const{isLocalSession:t,isEncodedSession:n,isSpecSession:o,isSharedSession:s,isJsonSession:r,isJb1StyleSession:i,sessionQuery:a,configSnapshot:c}=e;if(!c)return;if(e.bc1&&(e.bc1.onmessage=t=>{const n=JSON.parse(sessionStorage.getItem("current")||"{}").session||{};n.id===t.data&&e.bc2&&e.bc2.postMessage(n)}),s)await this.fetchSharedSession();else if(o)this.decodeSessionSpec();else if(i)this.decodeJb1StyleSession();else if(n)await this.decodeEncodedUrlSession();else if(r)await this.decodeJsonUrlSession();else if(t)await this.fetchSessionStorageSession();else{if(a)throw new Error("unrecognized session format");e.setBlankSession(!0)}}catch(t){console.error(t),e.setSessionError(t)}})))}})));function He(e){let{error:t}=e;return(0,b.jsx)(b.Fragment,{children:"".concat(t).match(/HTTP 404 fetching config.json/)?(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{children:"It worked!"}),(0,b.jsxs)("p",{style:{margin:8,padding:8,background:"#9f9",border:"1px solid green"},children:["JBrowse 2 is installed. Your next step is to add and configure an assembly. Follow our"," ",(0,b.jsx)("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web/",children:"quick start guide"})," ","to continue or browse the sample data"," ",(0,b.jsx)("a",{href:"?config=test_data/volvox/config.json",children:"here"}),"."]}),null]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{children:"JBrowse Error"}),(0,b.jsx)(c.ErrorMessage,{error:t})]})})}var Ke=n(59608);function Qe(e,t,n){e&&!(0,E.readConfObject)(e.jbrowse.configuration,"disableAnalytics")&&(async function(e,t,n){try{const o="https://analytics.jbrowse.org/api/v1",s=e.jbrowse.tracks.filter((e=>((0,E.readConfObject)(e,"assemblyNames")||[]).length>1)).length,r=Object.keys(localStorage).filter((e=>e.includes("localSaved-"))).length,{jbrowse:i,session:a,version:c}=e,{tracks:l,assemblies:d,plugins:u}=i,p={ver:c,"plugins-count":(null===u||void 0===u?void 0:u.length)||0,"plugin-names":null===u||void 0===u?void 0:u.map((e=>e.name)).join(","),"assemblies-count":d.length,"tracks-count":l.length,"session-tracks-count":(null===a||void 0===a?void 0:a.sessionTracks.length)||0,"open-views":(null===a||void 0===a?void 0:a.views.length)||0,"synteny-tracks-count":s,"saved-sessions-count":r,"existing-session-param-type":(null===n||void 0===n?void 0:n.split("-")[0])||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:V.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0};l.forEach((e=>{const t="track-types-".concat(e.type);p[t]=p[t]+1||1})),null===a||void 0===a||a.sessionTracks.forEach((e=>{const t="sessionTrack-types-".concat(e.type);p[t]=p[t]+1||1}));const m=Object.keys(p).map((e=>"".concat(e,"=").concat(p[e]))).join("&");await fetch("".concat(o,"?").concat(m))}catch(o){console.error("Failed to write analytics to AWS.",o)}}(e,t,n),async function(e,t){var n;const o={"tracks-count":e.jbrowse.tracks.length,ver:e.version,electron:V.isElectron,loadTime:Date.now()-t,pluginNames:(null===(n=e.jbrowse.plugins)||void 0===n?void 0:n.map((e=>e.name)))||""};let s="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){";s+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",s+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",s+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",s+="ga('create', '".concat("UA-7115575-5","', 'auto', 'jbrowseTracker');");const r={};"tracks-count ver electron loadTime pluginNames".split(/\s+/).forEach(((e,t)=>{r["dimension".concat(t+1)]=o[e]})),r.metric1=Math.round(o.loadTime),s+="ga('jbrowseTracker.send', 'pageview',".concat(JSON.stringify(r),");");const i=document.createElement("script");i.innerHTML=s,document.getElementsByTagName("head")[0].append(i)}(e,t))}var Ye=n(40753);const $e=function(e){return(0,E.ConfigurationSchema)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,E.ConfigurationSchema)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}),cytobands:(0,E.ConfigurationSchema)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"CytobandAdapter"}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})};var Xe=n(8241);class et{constructor(e){this.pluginManager=e,this.adapterCache=new Xe.Z({maxSize:15})}loadTextSearchAdapters(e){const t=this.pluginManager;return this.relevantAdapters(e).map((e=>{const n=(0,E.readConfObject)(e,"textSearchAdapterId"),o=this.adapterCache.get(n);if(o)return o;{const{AdapterClass:o}=t.getTextSearchAdapterType(e.type),s=new o(e,void 0,t);return this.adapterCache.set(n,s),s}}))}relevantAdapters(e){var t,n;const o=this.pluginManager,{aggregateTextSearchAdapters:s}=null===(t=o.rootModel)||void 0===t?void 0:t.jbrowse,{tracks:r}=null===(n=o.rootModel)||void 0===n?void 0:n.session,{assemblyName:i}=e;return[...this.getAdaptersWithAssembly(i,s),...this.getTrackAdaptersWithAssembly(i,r)]}getAdaptersWithAssembly(e,t){return t.filter((t=>{var n;return null===(n=(0,E.readConfObject)(t,"assemblyNames"))||void 0===n?void 0:n.includes(e)}))}getTrackAdaptersWithAssembly(e,t){return t.filter((t=>{var n;return null===(n=(0,E.readConfObject)(t,["textSearching","textSearchAdapter","assemblyNames"]))||void 0===n?void 0:n.includes(e)})).map((e=>e.textSearching.textSearchAdapter))}async search(e,t,n){const o=this.loadTextSearchAdapters(t),s=await Promise.all(o.map((t=>t.searchIndex(e))));return this.sortResults(s.flat(),n)}sortResults(e,t){return t(e.sort(((e,t)=>-t.getLabel().localeCompare(e.getLabel())))).sort(((e,t)=>e.getScore()-t.getScore()))}}var tt=n(51862),nt=n(64813),ot=n(99813),st=n(39841),rt=n(83713),it=n(93226),at=n(40004),ct=n(12521),lt=n(72950),dt=n(48340),ut=n(20670),pt=n(24728);function mt(){return new Worker(new URL(n.p+n.u(3203),n.b))}var ht=n(25217),ft=n.n(ht);window.getSnapshot=d.getSnapshot,window.resolveIdentifier=d.resolveIdentifier;const gt={i8:"2.8.0"};var vt=n(26607),yt=n.n(vt),wt=n(62979),bt=n.n(wt);const St=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),Ct=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function xt(e){if(!St.test(e))throw new Error('Encountered invalid refName: "'.concat(e,'"'))}function kt(e,t){const n=new(bt())({cache:new Xe.Z({maxSize:1e3}),async fill(e,t,n){const{adapterConf:o,self:s,options:r}=e;return async function(e,t,n,o){const{sessionId:s}=n;await(0,V.when)((()=>!(!e.regions||!e.refNameAliases)),{signal:o,name:"when assembly ready"});const r=await e.rpcManager.call(s||"assemblyRpc","CoreGetRefNames",{adapterConfig:t,signal:o,...n},{timeout:1e6}),{refNameAliases:i}=e;if(!i)throw new Error("error loading assembly ".concat(e.name,"'s refNameAliases"));const a=Object.fromEntries(r.map((t=>(xt(t),[e.getCanonicalRefName(t),t]))));return{forwardMap:a,reverseMap:Object.fromEntries(Object.entries(a).map((e=>{let[t,n]=e;return[n,t]})))}}(s,o,{...r,statusCallback:n},t)}});return d.types.model({configuration:d.types.safeReference(e)}).volatile((()=>({error:void 0,loaded:!1,loadingP:void 0,volatileRegions:void 0,refNameAliases:void 0,lowerCaseRefNameAliases:void 0,cytobands:void 0}))).views((e=>({getConf:t=>e.configuration?(0,E.getConf)(e,t):void 0}))).views((e=>({get initialized(){return e.load(),!!e.refNameAliases},get name(){return e.getConf("name")||""},get regions(){return e.load(),e.volatileRegions},get aliases(){return e.getConf("aliases")||[]},get displayName(){return e.getConf("displayName")},hasName(e){return this.allAliases.includes(e)},get allAliases(){return[this.name,...this.aliases]},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get lowerCaseRefNames(){return e.lowerCaseRefNameAliases?Object.keys(e.lowerCaseRefNameAliases||{}):void 0},get allRefNamesWithLowerCase(){return this.allRefNames&&this.lowerCaseRefNames?[...new Set([...this.allRefNames,...this.lowerCaseRefNames])]:void 0},get rpcManager(){return(0,d.getParent)(e,2).rpcManager},get refNameColors(){const t=e.getConf("refNameColors")||[];return 0===t.length?Ct:t}}))).views((e=>({get refNames(){var t;return null===(t=e.regions)||void 0===t?void 0:t.map((e=>e.refName))}}))).views((e=>({getCanonicalRefName(t){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[t]||e.lowerCaseRefNameAliases[t]},getRefNameColor(t){if(!e.refNames)return;const n=e.refNames.indexOf(t);return-1!==n?e.refNameColors[n%e.refNameColors.length]:void 0},isValidRefName(t){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(t)}}))).actions((e=>({setLoaded(t){let{adapterRegionsWithAssembly:n,refNameAliases:o,lowerCaseRefNameAliases:s,cytobands:r}=t;e.loaded=!0,this.setRegions(n),this.setRefNameAliases(o,s),this.setCytobands(r)},setError(t){console.error(t),e.error=t},setRegions(t){e.volatileRegions=t},setRefNameAliases(t,n){e.refNameAliases=t,e.lowerCaseRefNameAliases=n},setCytobands(t){e.cytobands=t},setLoadingP(t){e.loadingP=t},load(){return e.loadingP||(e.loadingP=this.loadPre().catch((e=>{this.setLoadingP(void 0),this.setError(e)}))),e.loadingP},async loadPre(){var n,o;const s=e.configuration,r=null===s||void 0===s||null===(n=s.refNameAliases)||void 0===n?void 0:n.adapter,i=null===s||void 0===s||null===(o=s.cytobands)||void 0===o?void 0:o.adapter,a=null===s||void 0===s?void 0:s.sequence.adapter,c=e.name,l=await async function(e,t,n){const o=t.getAdapterType(e.type),s=new(await o.getAdapterClass())(e,void 0,t);return s.getRegions({signal:n})}(a,t),d=l.map((e=>(xt(e.refName),{...e,assemblyName:c}))),u={},p=await async function(e,t,n){const o=t.getAdapterType(e.type),s=new(await o.getAdapterClass())(e,void 0,t);return s.getRefNameAliases({signal:n})}(r,t),m=await async function(e,t){const n=t.getAdapterType(e.type),o=new(await n.getAdapterClass())(e,void 0,t);return o.getData()}(i,t);p.forEach((e=>{let{refName:t,aliases:n}=e;n.forEach((e=>{xt(e),u[e]=t}))})),d.forEach((e=>{u[e.refName]=e.refName}));const h=Object.fromEntries(Object.entries(u).map((e=>{let[t,n]=e;return[t.toLowerCase(),n]})));this.setLoaded({adapterRegionsWithAssembly:d,refNameAliases:u,lowerCaseRefNameAliases:h,cytobands:m})}}))).views((e=>({getAdapterMapEntry(t,o){const{signal:s,statusCallback:r,...i}=o;if(!o.sessionId)throw new Error("sessionId is required");const a=function(e){return yt()(e)}(t);return n.get(a,{adapterConf:t,self:e,options:i},void 0,r)},async getRefNameMapForAdapter(e,t){if(null===t||void 0===t||!t.sessionId)throw new Error("sessionId is required");return(await this.getAdapterMapEntry(e,t)).forwardMap},async getReverseRefNameMapForAdapter(e,t){return(await this.getAdapterMapEntry(e,t)).reverseMap}})))}const At=function(e,t){return d.types.model({assemblies:d.types.array(kt(e,t))}).views((e=>({get assemblyNameMap(){const t={};for(const n of e.assemblies)for(const e of n.allAliases)t[e]=n;return t}}))).views((e=>({get:t=>e.assemblyNameMap[t],get assemblyNamesList(){return this.assemblyList.map((e=>e.name))},get assemblyList(){const{jbrowse:{assemblies:t},session:{sessionAssemblies:n=[],temporaryAssemblies:o=[]}={}}=(0,d.getParent)(e);return[...t,...n,...o]},get rpcManager(){return(0,d.getParent)(e).rpcManager}}))).views((e=>({async waitForAssembly(t){if(!t)throw new Error("no assembly name supplied to waitForAssembly");let n=e.get(t);if(!n)try{await(0,V.when)((()=>Boolean(e.get(t))),{timeout:1e3}),n=e.get(t)}catch(o){}if(n){if(await n.load(),await(0,V.when)((()=>{var e,t;return Boolean((null===(e=n)||void 0===e?void 0:e.regions)&&n.refNameAliases)||!(null===(t=n)||void 0===t||!t.error)})),n.error)throw n.error;return n}},async getRefNameMapForAdapter(e,t,n){if(t){const o=await this.waitForAssembly(t);return null===o||void 0===o?void 0:o.getRefNameMapForAdapter(e,n)}return{}},async getReverseRefNameMapForAdapter(e,t,n){if(t){const o=await this.waitForAssembly(t);return null===o||void 0===o?void 0:o.getReverseRefNameMapForAdapter(e,n)}return{}},isValidRefName(t,n){const o=e.get(n);if(o)return o.isValidRefName(t);throw new Error("Failed to look up refName ".concat(t," on ").concat(n," because assembly does not exist"))}}))).actions((e=>({afterAttach(){(0,d.addDisposer)(e,(0,we.reaction)((()=>e.assemblyList),(t=>{e.assemblies.forEach((e=>{e.configuration||this.removeAssembly(e)})),t.forEach((t=>{e.assemblies.some((e=>e.name===(0,E.readConfObject)(t,"name")))||this.addAssembly(t)}))}),{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},removeAssembly(t){e.assemblies.remove(t)},addAssembly(t){e.assemblies.push({configuration:t})},replaceAssembly(t,n){e.assemblies[t]=(0,d.cast)({configuration:n})}})))};var jt=n(7287),Mt=n(35354);const Tt=(0,o.lazy)((()=>n.e(767).then(n.bind(n,80767)))),Pt=(0,o.lazy)((()=>n.e(5793).then(n.bind(n,25793))));function Et(e){let{pluginManager:t,sessionModelFactory:n,adminMode:o=!1}=e;const s=$e(t),r=function(e){let{pluginManager:t,assemblyConfigSchema:n}=e;return d.types.snapshotProcessor(De({pluginManager:t,assemblyConfigSchema:n}),{postProcessor:e=>(0,_e.uV)(ft()(e),"baseUri")})}({pluginManager:t,assemblyConfigSchema:s}),i=n({pluginManager:t,assemblyConfigSchema:s});return d.types.compose(function(e){let{pluginManager:t,jbrowseModelType:n,sessionModelType:o,assemblyConfigSchema:s}=e;return d.types.model("BaseRootModel",{jbrowse:n,session:d.types.maybe(o),sessionPath:d.types.optional(d.types.string,""),assemblyManager:d.types.optional(At(s,t),{})}).volatile((e=>({rpcManager:new Le(t,e.jbrowse.configuration.rpc,{MainThreadRpcDriver:{}}),adminMode:!1,isAssemblyEditing:!1,error:void 0,textSearchManager:new et(t),pluginManager:t}))).actions((e=>({setError(t){e.error=t},setSession(t){e.session=(0,d.cast)(t)},setDefaultSession(){this.setSession(e.jbrowse.defaultSession)},setSessionPath(t){e.sessionPath=t},renameCurrentSession(t){if(e.session){const n=JSON.parse(JSON.stringify((0,d.getSnapshot)(e.session)));n.name=t,this.setSession(n)}},setAssemblyEditing(t){e.isAssemblyEditing=t}})))}({pluginManager:t,jbrowseModelType:r,sessionModelType:i,assemblyConfigSchema:s}),function(e){return d.types.model({internetAccounts:d.types.array(e.pluggableMstType("internet account","stateModel"))}).actions((t=>({initializeInternetAccount(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getInternetAccountType(n.type))throw new Error("unknown internet account type ".concat(n.type));const s=t.internetAccounts.push({...o,type:n.type,configuration:n});return t.internetAccounts[s-1]},createEphemeralInternetAccount(n){let o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;try{o=new URL(r).origin}catch(l){}const i=n.split("-"),a={type:i[0],internetAccountId:n,name:i.slice(1).join("-"),description:"",domains:o?[o]:[]},c=e.getInternetAccountType(a.type).stateModel.create({...s,type:a.type,configuration:a});return t.internetAccounts.push(c),c},findAppropriateInternetAccount(e){const n=e.internetAccountId;if(n){const e=t.internetAccounts.find((e=>e.internetAccountId===n));if(e)return e}for(const o of t.internetAccounts)if(o.handlesLocation(e))return o;return n?this.createEphemeralInternetAccount(n,{},e.uri):null}}))).actions((e=>({afterCreate(){(0,d.addDisposer)(e,(0,we.autorun)((()=>{const{jbrowse:t}=e;t.internetAccounts.forEach(e.initializeInternetAccount)})))}})))}(t),d.types.model({history:d.types.optional(ye,{targetPath:"../session"})}).actions((e=>({afterCreate(){document.addEventListener("keydown",(t=>{var n,o;e.history.canRedo&&((t.ctrlKey||t.metaKey)&&t.shiftKey&&"KeyZ"===t.code||t.ctrlKey&&!t.shiftKey&&"KeyY"===t.code)&&"INPUT"!==(null===(n=document.activeElement)||void 0===n?void 0:n.tagName.toUpperCase())&&e.history.redo(),e.history.canUndo&&(t.ctrlKey||t.metaKey)&&!t.shiftKey&&"KeyZ"===t.code&&"INPUT"!==(null===(o=document.activeElement)||void 0===o?void 0:o.tagName.toUpperCase())&&e.history.undo()})),(0,d.addDisposer)(e,(0,we.autorun)((()=>{const{session:t}=e;t&&e.history.initialize()})))}}))),d.types.model({}).actions((e=>{const t=e;return{setMenus(e){t.menus=e},appendMenu:e=>t.menus.push({label:e,menuItems:[]}),insertMenu:(e,n)=>(t.menus.splice((n<0?t.menus.length:0)+n,0,{label:e,menuItems:[]}),t.menus.length),appendToMenu(e,n){const o=t.menus.find((t=>t.label===e));return o?o.menuItems.push(n):(t.menus.push({label:e,menuItems:[n]}),1)},insertInMenu(e,n,o){const s=t.menus.find((t=>t.label===e));if(!s)return t.menus.push({label:e,menuItems:[n]}),1;const r=o<0?s.menuItems.length+o:o;return s.menuItems.splice(r,0,n),s.menuItems.length},appendToSubMenu(e,n){let o=t.menus.find((t=>t.label===e[0]));if(!o){const n=this.appendMenu(e[0]);o=t.menus[n-1]}let{menuItems:s}=o;const r=[e[0]];return e.slice(1).forEach((e=>{r.push(e);let t=s.find((t=>"label"in t&&t.label===e));if(!t){const n=s.push({label:e,subMenu:[]});t=s[n-1]}if(!("subMenu"in t))throw new Error('"'.concat(e,'" in path "').concat(r,'" is not a subMenu'));s=t.subMenu})),s.push(n)},insertInSubMenu(e,n,o){let s=t.menus.find((t=>t.label===e[0]));if(!s){const n=this.appendMenu(e[0]);s=t.menus[n-1]}let{menuItems:r}=s;const i=[e[0]];return e.slice(1).forEach((e=>{i.push(e);let t=r.find((t=>"label"in t&&t.label===e));if(!t){const n=r.push({label:e,subMenu:[]});t=r[n-1]}if(!("subMenu"in t))throw new Error('"'.concat(e,'" in path "').concat(i,'" is not a subMenu'));r=t.subMenu})),r.splice(o,0,n),r.length}}}))).props({configPath:d.types.maybe(d.types.string)}).volatile((e=>({version:gt.i8,hydrateFn:jt.a,pluginsUpdated:!1,rpcManager:new Le(t,e.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:mt},MainThreadRpcDriver:{}}),savedSessionsVolatile:we.observable.map({}),textSearchManager:new et(t),error:void 0}))).views((e=>({get savedSessions(){return[...e.savedSessionsVolatile.values()]},localStorageId:t=>"localSaved-".concat(t,"-").concat(e.configPath),get autosaveId(){return"autosave-".concat(e.configPath)},get previousAutosaveId(){return"previousAutosave-".concat(e.configPath)}}))).views((e=>({get savedSessionNames(){return e.savedSessions.map((e=>e.name))},get currentSessionId(){var e;const t=new URL(window.location.href),n=new URLSearchParams(t.search);return null===n||void 0===n||null===(e=n.get("session"))||void 0===e?void 0:e.split("local-")[1]}}))).actions((e=>({afterCreate(){for(const[n,o]of Object.entries(localStorage).filter((e=>{let[t,n]=e;return t.startsWith("localSaved-")})).filter((t=>{let[n]=t;return n.includes(e.configPath||"undefined")})))try{const{session:t}=JSON.parse(o);e.savedSessionsVolatile.set(n,t)}catch(t){console.error("bad session encountered",n,o)}(0,d.addDisposer)(e,(0,we.autorun)((()=>{for(const[,n]of e.savedSessionsVolatile.entries())try{const t=e.localStorageId(n.name);localStorage.setItem(t,JSON.stringify({session:n}))}catch(t){"22"!==t.code&&"1024"!==t.code||alert('Local storage is full! Please use the "Open sessions" panel to remove old sessions')}}))),(0,d.addDisposer)(e,(0,we.autorun)((()=>{if(!e.session)return;const t=(0,d.getSnapshot)(e.session)||{name:"empty"},n=JSON.stringify;sessionStorage.setItem("current",n({session:t})),localStorage.setItem("autosave-".concat(e.configPath),n({session:{...t,name:"".concat(t.name,"-autosaved")}})),e.pluginsUpdated&&window.location.reload()}),{delay:400}))},setSession(t){const n=e.session;if(e.session=(0,d.cast)(t),e.session)try{(0,_e.Yr)(e.session,(0,d.getType)(e.session))}catch(o){throw e.session=n,o}},setPluginsUpdated(t){e.pluginsUpdated=t},setDefaultSession(){const{defaultSession:t}=e.jbrowse,n={...t,name:"".concat(t.name," ").concat((new Date).toLocaleString())};this.setSession(n)},renameCurrentSession(t){if(e.session){const n=JSON.parse(JSON.stringify((0,d.getSnapshot)(e.session)));n.name=t,this.setSession(n)}},addSavedSession(t){const n=e.localStorageId(t.name);e.savedSessionsVolatile.set(n,t)},removeSavedSession(t){const n=e.localStorageId(t.name);localStorage.removeItem(n),e.savedSessionsVolatile.delete(n)},duplicateCurrentSession(){if(e.session){const t=JSON.parse(JSON.stringify((0,d.getSnapshot)(e.session)));let n="".concat(e.session.name," (copy)");if(e.savedSessionNames.includes(n)){let t=2;do{n="".concat(e.session.name," (copy ").concat(t,")"),t+=1}while(e.savedSessionNames.includes(n))}t.name=n,this.setSession(t)}},activateSession(t){const n=e.localStorageId(t),o=localStorage.getItem(n);if(!o)throw new Error("Can't activate session ".concat(t,", it is not in the savedSessions"));this.setSession(JSON.parse(o).session)},saveSessionToLocalStorage(){if(e.session){const t=e.localStorageId(e.session.name);e.savedSessionsVolatile.set(t,(0,d.getSnapshot)(e.session))}},loadAutosaveSession(){const t=localStorage.getItem(e.previousAutosaveId),n=t?JSON.parse(t).session:{},{name:o}=n;n.name="".concat(o.replace("-autosaved",""),"-restored"),this.setSession(n)},setError(t){e.error=t}}))).volatile((e=>({menus:[{label:"File",menuItems:[{label:"New session",icon:J.Z,onClick:t=>{const n=localStorage.getItem(e.autosaveId);n&&localStorage.setItem(e.previousAutosaveId,n),t.setDefaultSession()}},{label:"Import session\u2026",icon:it.Z,onClick:e=>{const t=e.addWidget("ImportSessionWidget","importSessionWidget");e.showWidget(t)}},{label:"Export session",icon:rt.Z,onClick:e=>{const t=new Blob([JSON.stringify({session:(0,d.getSnapshot)(e)},null,2)],{type:"text/plain;charset=utf-8"});(0,Ye.saveAs)(t,"session.json")}},{label:"Open session\u2026",icon:st.Z,onClick:e=>{const t=e.addWidget("SessionManager","sessionManager");e.showWidget(t)}},{label:"Save session",icon:lt.Z,onClick:t=>{e.saveSessionToLocalStorage(),t.notify('Saved session "'.concat(t.name,'"'),"success")}},{label:"Duplicate session",icon:ot.Z,onClick:e=>{e.duplicateCurrentSession&&e.duplicateCurrentSession()}},{type:"divider"},{label:"Open track...",icon:ct.Z,onClick:e=>{if(0===e.views.length)e.notify("Please open a view to add a track first");else if(e.views.length>0){const t=e.addWidget("AddTrackWidget","addTrackWidget",{view:e.views[0].id});e.showWidget(t),e.views.length>1&&e.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:pt.sB,onClick:e=>{e.showWidget(e.addWidget("AddConnectionWidget","addConnectionWidget"))}},{type:"divider"},{label:"Return to splash screen",icon:nt.Z,onClick:()=>e.setSession(void 0)}]},...o?[{label:"Admin",menuItems:[{label:"Open assembly manager",onClick:()=>e.session.queueDialog((t=>[Mt.K,{onClose:t,rootModel:e}]))},{label:"Set default session",onClick:()=>e.session.queueDialog((t=>[Tt,{rootModel:e,onClose:t}]))}]}]:[],{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Undo",icon:dt.Z,onClick:()=>{e.history.canUndo&&e.history.undo()}},{label:"Redo",icon:ut.Z,onClick:()=>{e.history.canRedo&&e.history.redo()}},{type:"divider"},{label:"Plugin store",icon:at.Z,onClick:()=>{e.session&&e.session.showWidget(e.session.addWidget("PluginStoreWidget","pluginStoreWidget"))}},{label:"Preferences",icon:tt.Z,onClick:()=>{e.session&&e.session.queueDialog((t=>[Pt,{session:e.session,handleClose:t}]))}}]}],adminMode:o})))}function It(e){return e.extend((()=>function(e){return{views:{get snackbarMessages(){return e}},actions:{notify(e,t,n){this.pushSnackbarMessage(e,t,n),"info"!==t&&"success"!==t||setTimeout((()=>{this.removeSnackbarMessage(e)}),5e3)},pushSnackbarMessage:(t,n,o)=>e.push({message:t,level:n,action:o}),popSnackbarMessage:()=>e.pop(),removeSnackbarMessage(t){const n=e.find((e=>e.message===t));n&&e.remove(n)}}}}(we.observable.array())))}var Nt=n(98662),Zt=n(84382);function Rt(e){return d.types.model("ReferenceManagementSessionMixin",{}).views((e=>({getReferring(t){const n=[];return(0,d.walk)((0,d.getParent)(e),(e=>{if((0,d.isModelType)((0,d.getType)(e))){const o=(0,d.getMembers)(e);Object.entries(o.properties).forEach((o=>{let[s,r]=o;(0,d.isReferenceType)(r)&&e[s]===t&&n.push({node:e,key:s})}))}})),n}}))).actions((e=>({removeReferring(t,n,o,s){t.forEach((t=>{let{node:r}=t,i=!1;try{const e="open track(s)",t=(0,V.getContainingView)(r);o.push((()=>t.hideTrack(n.trackId))),i=!0,s[e]||(s[e]=0),s[e]+=1}catch(a){}if((0,V.isSessionModelWithWidgets)(e)&&e.widgets.has(r.id)){const t="configuration editor widget(s)";(0,V.isSessionModelWithWidgets)(e)&&o.push((()=>e.hideWidget(r))),i=!0,s[t]||(s[t]=0),s[t]+=1}if(!i)throw new Error("Error when closing this connection, the following node is still referring to a track configuration: ".concat(JSON.stringify((0,d.getSnapshot)(r))))}))}})))}const Lt=128;function Dt(e){const t=e.pluggableMstType("widget","stateModel");return d.types.model({drawerPosition:d.types.optional(d.types.string,(()=>(0,V.localStorageGetItem)("drawerPosition")||"right")),drawerWidth:d.types.optional(d.types.refinement(d.types.integer,(e=>e>=Lt)),384),widgets:d.types.map(t),activeWidgets:d.types.map(d.types.safeReference(t)),minimized:d.types.optional(d.types.boolean,!1)}).views((e=>({get visibleWidget(){if((0,d.isAlive)(e))return[...e.activeWidgets.values()][e.activeWidgets.size-1]}}))).actions((t=>({setDrawerPosition(e){t.drawerPosition=e,localStorage.setItem("drawerPosition",e)},updateDrawerWidth(e){if(e===t.drawerWidth)return t.drawerWidth;let n=e;return n<Lt&&(n=Lt),t.drawerWidth=n,n},resizeDrawer(e){"left"===t.drawerPosition&&(e*=-1);const n=t.drawerWidth;return n-this.updateDrawerWidth(n-e)},addWidget(n,o){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!e.getElementType("widget",n))throw new Error("unknown widget type ".concat(n));const i={...s,id:o,type:n,configuration:r||{type:n}};return t.widgets.set(o,i),t.widgets.get(o)},showWidget(e){t.activeWidgets.has(e.id)&&t.activeWidgets.delete(e.id),t.activeWidgets.set(e.id,e),t.minimized=!1},hasWidget:e=>t.activeWidgets.has(e.id),hideWidget(e){t.activeWidgets.delete(e.id)},minimizeWidgetDrawer(){t.minimized=!0},showWidgetDrawer(){t.minimized=!1},hideAllWidgets(){t.activeWidgets.clear()},editConfiguration(e){if(!(0,E.isConfigurationModel)(e))throw new Error("must pass a configuration model to editConfiguration");const t=this.addWidget("ConfigurationEditorWidget","configEditor",{target:e});this.showWidget(t)},afterAttach(){(0,d.addDisposer)(t,(0,we.autorun)((()=>{(0,V.localStorageSetItem)("drawerPosition",t.drawerPosition)})))}})))}var Wt=n(10730);function zt(e){return function(e){return d.types.compose("TracksManagerSessionMixin",(0,Wt.Ac)(e),Rt()).views((e=>({get tracks(){return e.jbrowse.tracks}}))).actions((e=>({addTrackConf:t=>e.jbrowse.addTrackConf(t),deleteTrackConf(t){const n=[],o=e.getReferring(t);if(e.removeReferring(o,t,n,{}),n.forEach((e=>e())),e.adminMode)return e.jbrowse.deleteTrackConf(t)}})))}(e).named("SessionTracksManagerSessionMixin").props({sessionTracks:d.types.array(e.pluggableConfigSchemaType("track"))}).views((e=>({get tracks(){return e.jbrowse.tracks}}))).actions((e=>{const{addTrackConf:t,deleteTrackConf:n}=e;return{addTrackConf(n){if(e.adminMode)return t(n);const{trackId:o,type:s}=n;if(!s)throw new Error("unknown track type ".concat(s));const r=e.sessionTracks.find((e=>e.trackId===o));if(r)return r;const i=e.sessionTracks.push(n);return e.sessionTracks[i-1]},deleteTrackConf(t){const o=n(t);if(o)return o;const{trackId:s}=t,r=e.sessionTracks.findIndex((e=>e.trackId===s));return-1!==r?e.sessionTracks.splice(r,1):void 0}}}))}var Ot=n(74761);const Vt=(0,o.lazy)((()=>Promise.all([n.e(3650),n.e(7102),n.e(5354),n.e(3437),n.e(4047),n.e(7019)]).then(n.bind(n,17019))));function Ut(e){let{pluginManager:t,assemblyConfigSchema:n}=e;const o=d.types.compose("WebCoreSessionModel",d.types.compose("WebCoreSessionModelGroupA",Rt(),Dt(t),d.types.model("DialogQueueSessionMixin",{}).volatile((()=>({queueOfDialogs:[]}))).views((e=>({get DialogComponent(){var t;return null===(t=e.queueOfDialogs[0])||void 0===t?void 0:t[0]},get DialogProps(){var t;return null===(t=e.queueOfDialogs[0])||void 0===t?void 0:t[1]}}))).actions((e=>({removeActiveDialog(){e.queueOfDialogs=e.queueOfDialogs.slice(1)},queueDialog(t){const[n,o]=t((()=>{this.removeActiveDialog()}));e.queueOfDialogs=[...e.queueOfDialogs,[n,o]]}}))),d.types.model({}).volatile((()=>({sessionThemeName:(0,V.localStorageGetItem)("themeName")||"default"}))).views((e=>({allThemes(){const t=e,n=(0,E.getConf)(t.jbrowse,"extraThemes");return{...c.defaultThemes,...n}},get themeName(){const{sessionThemeName:t}=e;return this.allThemes()[t]?t:"default"},get theme(){const t=e,n=(0,E.getConf)(t.jbrowse,"theme"),o=this.allThemes();return(0,c.createJBrowseTheme)(n,o,this.themeName)}}))).actions((e=>({setThemeName(t){e.sessionThemeName=t},afterAttach(){(0,d.addDisposer)(e,(0,we.autorun)((()=>{(0,V.localStorageSetItem)("themeName",e.themeName)})))}}))),function(e){return d.types.compose((0,Wt.Ac)(e),Dt(e)).props({views:d.types.array(e.pluggableMstType("view","stateModel"))}).actions((t=>({moveViewUp(e){const n=t.views.findIndex((t=>t.id===e));-1!==n&&n>0&&t.views.splice(n-1,2,t.views[n],t.views[n-1])},moveViewDown(e){const n=t.views.findIndex((t=>t.id===e));-1!==n&&n<t.views.length-1&&t.views.splice(n,2,t.views[n+1],t.views[n])},addView(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.getElementType("view",n))throw new Error("unknown view type ".concat(n));const s=t.views.push({...o,type:n});return t.views[s-1]},removeView(e){for(const[,n]of t.activeWidgets)n.view&&n.view.id===e.id&&t.hideWidget(n);t.views.remove(e)},addLinearGenomeViewOfAssembly(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addViewOfAssembly("LinearGenomeView",e,t)},addViewOfAssembly(e,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=t.assemblies.find((e=>(0,E.readConfObject)(e,"name")===n));if(!s)throw new Error('Could not add view of assembly "'.concat(n,'", assembly name not found'));return this.addView(e,{...o,displayRegionsFromAssemblyName:(0,E.readConfObject)(s,"name")})},addViewFromAnotherView(e,t){const n={...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}};return n.displayedRegions=(0,d.getSnapshot)(t.displayedRegions),this.addView(e,n)}})))}(t)),d.types.compose("WebCoreSessionModelGroupB",zt(t),(s=n,d.types.model({sessionAssemblies:d.types.array(s)}).actions((e=>{const t=e;return{addSessionAssembly(e){const n=t.sessionAssemblies.find((t=>t.name===e.name));if(n)return console.warn("Assembly ".concat(e.name," already exists")),n;const o=t.sessionAssemblies.push(e);return t.sessionAssemblies[o-1]},removeSessionAssembly(e){const n=t.sessionAssemblies.find((t=>t.name===e));n&&t.sessionAssemblies.remove(n)}}}))),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.types.frozen();return d.types.model({temporaryAssemblies:d.types.array(t)}).actions((e=>{const t=e;return{addTemporaryAssembly(e){const n=t.temporaryAssemblies.find((t=>t.name===e.name));if(n)return console.warn("Assembly ".concat(e.name," was already existing")),n;const o=t.temporaryAssemblies.push(e);return t.temporaryAssemblies[o-1]},removeTemporaryAssembly(e){const n=t.temporaryAssemblies.find((t=>t.name===e));n&&t.temporaryAssemblies.remove(n)}}}))}(t,n),function(e){return d.types.compose("SessionConnectionsManagement",(0,Ot.C)(e),d.types.model({sessionConnections:d.types.array(e.pluggableConfigSchemaType("connection"))})).actions((e=>{const t=e,n=t.deleteConnection,o=t.addConnectionConf;return{addConnectionConf(e){if(t.adminMode)return o(e);const{connectionId:n,type:s}=e;if(!s)throw new Error("unknown connection type ".concat(s));const r=t.sessionTracks.find((e=>e.connectionId===n));if(r)return r;const i=t.sessionConnections.push(e);return t.sessionConnections[i-1]},deleteConnection(e){let o;if(t.adminMode&&(o=n(e)),!o){const{connectionId:n}=e,o=t.sessionConnections.findIndex((e=>e.connectionId===n));if(-1===o)return;return t.sessionConnections.splice(o,1)}return o}}}))}(t),d.types.model({focusedViewId:d.types.maybe(d.types.string)}).actions((e=>({setFocusedViewId(t){e.focusedViewId=t}}))))).props({margin:0,sessionPlugins:d.types.array(d.types.frozen())}).volatile((()=>({sessionThemeName:(0,V.localStorageGetItem)("themeName")||"default",task:void 0}))).views((e=>({get tracks(){return[...e.sessionTracks,...e.jbrowse.tracks]},get root(){return(0,d.getParent)(e)},get assemblies(){return[...e.jbrowse.assemblies,...e.sessionAssemblies]},get connections(){return[...e.jbrowse.connections,...e.sessionConnections]}}))).actions((e=>({setName(t){e.name=t}}))).views((e=>({get assemblyNames(){return e.assemblies.map((e=>(0,E.readConfObject)(e,"name")))},get version(){return e.root.version},get shareURL(){return(0,E.getConf)(e.jbrowse,"shareURL")},get textSearchManager(){return e.root.textSearchManager},get assemblyManager(){return e.root.assemblyManager},get savedSessions(){return e.root.savedSessions},get previousAutosaveId(){return e.root.previousAutosaveId},get savedSessionNames(){return e.root.savedSessionNames},get history(){return e.root.history},get menus(){return e.root.menus},renderProps:()=>({theme:e.theme})}))).actions((e=>({addAssemblyConf(t){e.jbrowse.addAssemblyConf(t)},addSessionPlugin(t){if(e.sessionPlugins.some((e=>e.name===t.name)))throw new Error("session plugin cannot be installed twice");e.sessionPlugins.push(t),e.root.setPluginsUpdated(!0)},removeSessionPlugin(t){e.sessionPlugins=(0,d.cast)(e.sessionPlugins.filter((e=>e.url!==t.url||e.umdUrl!==t.umdUrl||e.cjsUrl!==t.cjsUrl||e.esmUrl!==t.esmUrl))),(0,d.getParent)(e).setPluginsUpdated(!0)},addSavedSession:t=>e.root.addSavedSession(t),removeSavedSession:t=>e.root.removeSavedSession(t),renameCurrentSession:t=>e.root.renameCurrentSession(t),duplicateCurrentSession:()=>e.root.duplicateCurrentSession(),activateSession:t=>e.root.activateSession(t),setDefaultSession:()=>e.root.setDefaultSession(),saveSessionToLocalStorage:()=>e.root.saveSessionToLocalStorage(),loadAutosaveSession:()=>e.root.loadAutosaveSession(),setSession:t=>e.root.setSession(t)}))).actions((e=>({editTrackConfiguration(t){const{adminMode:n,sessionTracks:o}=e;if(!n&&!o.includes(t))throw new Error("Can't edit the configuration of a non-session track");e.editConfiguration(t)}}))).views((e=>({getTrackActionMenuItems(t){const{adminMode:n,sessionTracks:o}=e,s=n||o.find((e=>e.trackId===t.trackId)),r="ReferenceSequenceTrack"===t.type;return[{label:"About track",onClick:()=>{e.queueDialog((e=>[Vt,{config:t,handleClose:e}]))},icon:Zt.Z},{label:"Settings",disabled:!s,onClick:()=>e.editTrackConfiguration(t),icon:tt.Z},{label:"Delete track",disabled:!s||r,onClick:()=>e.deleteTrackConf(t),icon:Nt.Z},{label:"Copy track",disabled:r,onClick:()=>{const n=ft()((0,d.getSnapshot)(t)),o=Date.now();n.trackId+="-".concat(o),n.displays.forEach((e=>{e.displayId+="-".concat(o)})),e.adminMode||(n.trackId+="-sessionTrack",n.category=void 0),n.name+=" (copy)",e.addTrackConf(n)},icon:ot.Z}]}}))).actions((e=>({afterAttach(){(0,d.addDisposer)(e,(0,we.autorun)((()=>{(0,V.localStorageSetItem)("drawerPosition",e.drawerPosition),(0,V.localStorageSetItem)("themeName",e.themeName)})))}})));var s;const r=t.evaluateExtensionPoint("Core-extendSession",o);return d.types.snapshotProcessor(It(r),{preProcessor(e){if(e){const{connectionInstances:t,...n}=e||{};if(!Array.isArray(t))return n}return e}})}function Ft(e){let{pluginManager:t,assemblyConfigSchema:n}=e;return Ut({pluginManager:t,assemblyConfigSchema:n})}var Bt=n(41882);function qt(e){var t,n,o;const s=new Ke.Z([...Bt.Z.map((e=>({plugin:new e,metadata:{isCore:!0}}))),...e.runtimePlugins.map((e=>{let{plugin:t,definition:n}=e;return{plugin:new t,definition:n,metadata:{url:n.url}}})),...e.sessionPlugins.map((e=>{let{plugin:t,definition:n}=e;return{plugin:new t,definition:n,metadata:{url:n.url}}}))]);s.createPluggableElements();const r=Et({pluginManager:s,sessionModelFactory:Ft,adminMode:!!e.adminKey});if(!e.configSnapshot)return;const i=r.create({jbrowse:e.configSnapshot,configPath:e.configPath},{pluginManager:s});if(null===(t=e.configSnapshot)||void 0===t||null===(n=t.configuration)||void 0===n||null===(o=n.rpc)||void 0===o||!o.defaultDriver){const{rpc:e}=i.jbrowse.configuration;e.defaultDriver.set("WebWorkerRpcDriver")}let a=()=>{};try{var c,l;e.sessionError?(i.setDefaultSession(),i.session.notify("Error loading session: ".concat(e.sessionError,'. If you\n                received this URL from another user, request that they send you\n                a session generated with the "Share" button instead of copying\n                and pasting their URL'))):e.sessionSnapshot?i.setSession(e.sessionSnapshot):e.sessionSpec?a=function(e,t){let{views:n,sessionTracks:o=[]}=e;return async()=>{const{rootModel:e}=t;if(!e)throw new Error("rootModel not initialized");try{e.setSession({name:"New session ".concat((new Date).toLocaleString())}),o.forEach((t=>e.session.addTrackConf(t))),await Promise.all(n.map((n=>t.evaluateAsyncExtensionPoint("LaunchView-"+n.type,{...n,session:e.session}))))}catch(r){var s;console.error(r),null===(s=e.session)||void 0===s||s.notify("".concat(r))}}}(e.sessionSpec,s):null!==(c=i.jbrowse.defaultSession)&&void 0!==c&&null!==(l=c.views)&&void 0!==l&&l.length&&i.setDefaultSession()}catch(u){var d;i.setDefaultSession();const e="".concat(u).replace("[mobx-state-tree] ","").replace(/\(.+/,"");null===(d=i.session)||void 0===d||d.notify("Session could not be loaded. ".concat(e.length>1e3?"".concat(e.slice(0,1e3),"...see more in console"):e)),console.error(u)}return Qe(i,e.initialTimestamp,e.sessionQuery),s.setRootModel(i),s.configure(),a(),s}const Gt=(0,o.lazy)((()=>n.e(9206).then(n.bind(n,19206)))),_t=(0,o.lazy)((()=>n.e(4907).then(n.bind(n,4907)))),Jt=(0,o.lazy)((()=>Promise.all([n.e(2280),n.e(7308),n.e(3249)]).then(n.bind(n,43249))));function Ht(e){let{initialTimestamp:t=Date.now()}=e;const n=e=>null===e?void 0:e,s=i.StringParam,[r]=(0,i.useQueryParam)("config",s),[a]=(0,i.useQueryParam)("session",s),[c]=(0,i.useQueryParam)("adminKey",s),[l,d]=(0,i.useQueryParam)("password",s),[u,p]=(0,i.useQueryParam)("loc",s),[m,h]=(0,i.useQueryParam)("sessionTracks",s),[f,g]=(0,i.useQueryParam)("assembly",s),[v,y]=(0,i.useQueryParam)("tracks",s),w=Je.create({configPath:n(r),sessionQuery:n(a),password:n(l),adminKey:n(c),loc:n(u),assembly:n(f),tracks:n(v),sessionTracks:n(m),initialTimestamp:t});return(0,o.useEffect)((()=>{p(void 0,"replaceIn"),y(void 0,"replaceIn"),g(void 0,"replaceIn"),d(void 0,"replaceIn"),h(void 0,"replaceIn")}),[g,p,y,d,h]),(0,b.jsx)(Yt,{loader:w})}const Kt=(0,s.observer)((function(e){let{sessionTriaged:t,loader:n}=e;return(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(o.Fragment,{}),children:"session"===(null===t||void 0===t?void 0:t.origin)?(0,b.jsx)(_t,{loader:n,handleClose:()=>n.setSessionTriaged(void 0)}):(0,b.jsx)(Gt,{loader:n,handleClose:()=>n.setSessionTriaged(void 0)})})})),Qt=(0,s.observer)((function(e){let{pluginManager:t}=e;const{rootModel:n}=t;return null!==n&&void 0!==n&&n.session?(0,b.jsx)(Ue,{pluginManager:t}):(0,b.jsx)(o.Suspense,{fallback:(0,b.jsx)(c.LoadingEllipses,{}),children:(0,b.jsx)(Jt,{rootModel:n,onFactoryReset:Fe.Z})})})),Yt=(0,s.observer)((function(e){let{loader:t}=e;const{configError:n,ready:s,sessionTriaged:r}=t,[i,a]=(0,o.useState)(),[c,d]=(0,o.useState)();(0,o.useEffect)((()=>{let e;try{if(!s)return;e=qt(t),a(e)}catch(n){console.error(n),d(n)}}),[t,s]);const u=n||c;return u?(0,b.jsx)(He,{error:u}):r?(0,b.jsx)(Kt,{loader:t,sessionTriaged:r}):i?(0,b.jsx)(Qt,{pluginManager:i}):(0,b.jsx)(l.Z,{})}));const $t=function(e){let{initialTimestamp:t}=e;return(0,b.jsx)(r.SV,{FallbackComponent:e=>(0,b.jsx)(c.FatalErrorDialog,{...e,resetButtonText:"Reset Session",onFactoryReset:Fe.Z}),children:(0,b.jsx)(i.QueryParamProvider,{adapter:a.V,children:(0,b.jsx)(Ht,{initialTimestamp:t})})})}},91932:(e,t,n)=>{async function o(){window.location=window.location.pathname}n.d(t,{Z:()=>o})},53064:(e,t,n)=>{n.d(t,{h:()=>c,p:()=>a});var o=n(71883);const s=async(e,t)=>(await Promise.all([n.e(7626),n.e(5607),n.e(633)]).then(n.t.bind(n,45607,23))).encrypt(e,t).toString(),r=async(e,t)=>{const o=await Promise.all([n.e(7626),n.e(5607),n.e(633)]).then(n.t.bind(n,45607,23)),s=await Promise.all([n.e(7626),n.e(6828)]).then(n.t.bind(n,87380,23));return o.decrypt(e,t).toString(s)};function i(e){try{return JSON.parse(e).message}catch(t){return e}}async function a(e,t,n){const r=await(0,o.JY)(JSON.stringify(e)),a=(c=5,window.btoa([...window.crypto.getRandomValues(new Uint8Array(2*c))].map((e=>String.fromCharCode(e))).join("")).replaceAll(/[+/]/g,"").slice(0,c));var c;const l=await s(r,a),d=new FormData;d.append("session",l),d.append("dateShared","".concat(Date.now())),d.append("referer",n);const u=await fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:d});if(!u.ok){const e=await u.text();throw new Error(i(e))}return{json:await u.json(),encryptedSession:l,password:a}}async function c(e,t,n,o){const s=t.split("share-")[1],a="".concat(e,"?sessionId=").concat(encodeURIComponent(s)),c=await fetch(a,{signal:o});if(!c.ok){const e=await c.text();throw new Error(i(e))}const l=await c.json();return r(l.session,n)}},71883:(e,t,n)=>{n.d(t,{H1:()=>c,JY:()=>i,Yr:()=>a,bP:()=>l,cD:()=>r,t$:()=>d,uV:()=>u});var o=n(67677),s=n(31625);async function r(e){const t=function(e){let t=0;switch(e.length%4){case 3:t=1;break;case 2:t=2;break;case 0:t=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(t)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:o}=await Promise.resolve().then(n.t.bind(n,96116,19)),{inflate:s}=await n.e(2695).then(n.bind(n,52695)),r=s(o(t));return(new TextDecoder).decode(r)}async function i(e){const t=(new TextEncoder).encode(e),{deflate:o}=await n.e(2695).then(n.bind(n,52695)),{fromByteArray:s}=await Promise.resolve().then(n.t.bind(n,96116,19)),r=s(o(t)),i=r.indexOf("=");return i>0?r.slice(0,i).replaceAll("+","-").replaceAll("/","_"):r.replaceAll("+","-").replaceAll("/","_")}function a(e,t){if(void 0!==e)if((0,s.isArrayType)(t)){const t=e,n=(0,s.getChildType)(e);if((0,s.isReferenceType)(n))for(let e=0;e<t.length;)(0,s.isValidReference)((()=>t[e]))?e+=1:t.splice(e,1);t.forEach((e=>{a(e,n)}))}else if((0,s.isMapType)(t)){const t=e,n=(0,s.getChildType)(t);if((0,s.isReferenceType)(n))for(const e in t.keys())(0,s.isValidReference)((()=>t.get(e)))||t.delete(e);t.forEach((e=>{a(e,n)}))}else if((0,s.isModelType)(t)){const{properties:t}=(0,s.getPropertyMembers)(e);Object.entries(t).forEach((t=>{let[n,o]=t;a(e[n],o)}))}}function c(e,t){if("object"===typeof e)for(const n of Object.keys(e))"object"===typeof e[n]?c(e[n],t):"uri"===n&&(e.baseUri=t.href)}function l(e,t,n){let{configuration:o}=e;return(null===o||void 0===o?void 0:o[t])||n}async function d(e){if(0===e.length)return!0;const t=await async function(){const e=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!e.ok)throw new Error("HTTP ".concat(e.status," ").concat(e.statusText," fetching plugins"));return e.json()}();return e.every((e=>(0,o.sI)(e)?t.plugins.some((t=>(0,o.sI)(e)&&("url"in t&&"url"in e&&e.url===t.url||"umdUrl"in t&&"umdUrl"in e&&e.umdUrl===t.umdUrl))):(0,o.bm)(e)?t.plugins.some((t=>(0,o.bm)(e)&&"esmUrl"in e&&e.esmUrl===t.esmUrl)):!!(0,o.Mv)(e)&&t.plugins.some((t=>(0,o.Mv)(e)&&e.cjsUrl===t.cjsUrl))))}function u(e,t){for(const n in e)n===t?delete e[n]:"object"===typeof e[n]&&u(e[n],t);return e}}}]);
//# sourceMappingURL=8398.6dea85e3.chunk.js.map