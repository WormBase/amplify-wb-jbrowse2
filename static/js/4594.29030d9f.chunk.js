"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[4594,4535],{64535:(e,n,t)=>{t.r(n),t.d(n,{default:()=>E});var o=t(41867),r=t(47192),s=t(3762),i=t(43800),a=t(90872),l=t(35421),c=t(71939),d=t(64980),u=t(51590),m=t(77573),p=t(80838);const v=(0,r.ZL)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10},sm:{fontSize:10}}),h=(0,s.observer)((function(e){let{model:n,coordX:t}=e;const{classes:o}=v();return(0,p.jsx)(m.Z,{open:!0,placement:"top",title:n.views.map((e=>e.pxToBp(t))).map(((e,n)=>(0,p.jsx)(u.Z,{className:o.sm,children:(0,a.stringify)(e,!0)},[JSON.stringify(e),n].join("-")))),arrow:!0,children:(0,p.jsx)("div",{className:o.guide,style:{left:t,background:"red"}})})})),f=(0,r.ZL)()((e=>{const{tertiary:n,primary:t}=e.palette;return{rubberband:{height:"100%",background:n?(0,c.Fq)(n.main,.7):(0,c.Fq)(t.main,.7),position:"absolute",zIndex:10,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:n?n.contrastText:t.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}}})),b=(0,s.observer)((function(e){let{model:n,ControlComponent:t=(0,p.jsx)("div",{})}=e;const[r,s]=(0,o.useState)(),[i,c]=(0,o.useState)(),[m,v]=(0,o.useState)(),[b,g]=(0,o.useState)(),x=(0,o.useRef)(null),j=(0,o.useRef)(null),{classes:w}=f(),C=void 0!==r&&void 0===m;function y(e){e.preventDefault(),e.stopPropagation();const n=e.clientX-e.target.getBoundingClientRect().left;s(n),c(n)}function N(e){const n=e.target;g(e.clientX-n.getBoundingClientRect().left)}function k(){g(void 0),n.views.forEach((e=>e.setOffsets(void 0,void 0)))}function M(){v(void 0),s(void 0),c(void 0)}(0,o.useEffect)((()=>{function e(e){if(x.current&&C){const n=e.clientX-x.current.getBoundingClientRect().left;c(n)}}function t(e){if(void 0!==r&&x.current){const{clientX:t,clientY:o}=e,s=t-x.current.getBoundingClientRect().left;v({offsetX:s,clientX:t,clientY:o}),n.views.forEach((e=>{const n=function(e,n){if(void 0===r)return;let t=r,o=e;return o<t&&([t,o]=[o,t]),{leftOffset:n.pxToBp(t),rightOffset:n.pxToBp(o)}}(s,e);if(n){const{leftOffset:t,rightOffset:o}=n;e.setOffsets(t,o)}})),g(void 0)}}return C?(window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}):()=>{}}),[r,C,m,n]),(0,o.useEffect)((()=>{!C&&void 0!==i&&void 0!==r&&Math.abs(i-r)<=3&&M()}),[C,i,r]);const B=Boolean(m);if(void 0===r)return(0,p.jsxs)(p.Fragment,{children:[void 0!==b?(0,p.jsx)(h,{model:n,coordX:b}):null,(0,p.jsx)("div",{ref:x,className:w.rubberbandControl,onMouseDown:y,onMouseOut:k,onMouseMove:N,children:t})]});const S=m?m.offsetX:i||0,Z=S<r?S:r,E=Math.abs(S-r),{views:O}=n,R=O.map((e=>e.pxToBp(Z))),T=O.map((e=>e.pxToBp(Z+E))),L=O.map((e=>Math.ceil(E*e.bpPerPx)));return(0,p.jsxs)(p.Fragment,{children:[j.current?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.ZP,{className:w.popover,classes:{paper:w.paper},open:!0,anchorEl:j.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0,children:R.map(((e,n)=>(0,p.jsx)(u.Z,{children:(0,a.stringify)(e,!0)},[JSON.stringify(e),n,"left"].join("-"))))}),(0,p.jsx)(d.ZP,{className:w.popover,classes:{paper:w.paper},open:!0,anchorEl:j.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0,children:T.map(((e,n)=>(0,p.jsx)(u.Z,{children:(0,a.stringify)(e,!0)},[JSON.stringify(e),n,"right"].join("-"))))})]}):null,(0,p.jsx)("div",{ref:j,className:w.rubberband,style:{left:Z,width:E},children:(0,p.jsx)(u.Z,{variant:"h6",className:w.rubberbandText,children:L.map(((e,n)=>(0,p.jsx)(u.Z,{children:"".concat(e.toLocaleString("en-US"),"bp")},"".concat(e,"_").concat(n))))})}),(0,p.jsx)("div",{className:w.rubberbandControl,ref:x,onMouseDown:y,onMouseOut:k,onMouseMove:N,children:t}),m?(0,p.jsx)(l.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:m.clientX,top:m.clientY},onMenuItemClick:function(e,n){n(),M()},open:B,onClose:M,menuItems:n.rubberBandMenuItems()}):null]})}));var g=t(68367),x=t(4592),j=t(30340),w=t(24728),C=t(69282);const y=(0,r.ZL)()((()=>({headerBar:{gridArea:"1/1/auto/span 2",display:"flex"},spacer:{flexGrow:1},iconButton:{margin:5},bp:{display:"flex",alignItems:"center",marginLeft:10},searchContainer:{marginLeft:5},searchBox:{display:"flex"}}))),N=(0,s.observer)((e=>{let{model:n}=e;return(0,p.jsx)(C.Z,{menuItems:[{label:"Synteny track selector",onClick:()=>n.activateTrackSelector()},...n.views.map(((e,n)=>({label:"View ".concat(n+1," track selector"),onClick:()=>e.activateTrackSelector()})))],children:(0,p.jsx)(w.GD,{})})})),k=(0,s.observer)((function(e){let{model:n}=e;const{classes:t}=y(),[r,s]=(0,o.useState)(),i=n.views.some((e=>!e.hideHeader));return(0,p.jsxs)("div",{className:t.headerBar,children:[(0,p.jsx)(N,{model:n}),(0,p.jsx)(g.Z,{onClick:e=>s(e.currentTarget),className:t.iconButton,children:(0,p.jsx)(j.Z,{})}),i?null:n.views.map((e=>(0,p.jsxs)("div",{className:t.searchBox,children:[(0,p.jsx)("div",{className:t.searchContainer,children:(0,p.jsx)(x.Rj,{model:e,showHelp:!1})}),(0,p.jsx)("div",{className:t.bp,children:(0,p.jsxs)(u.Z,{variant:"body2",color:"textSecondary",className:t.bp,children:[Math.round(e.coarseTotalBp).toLocaleString("en-US")," bp"]})})]},e.id))),(0,p.jsx)("div",{className:t.spacer}),r?(0,p.jsx)(l.Menu,{anchorEl:r,open:!0,onMenuItemClick:(e,n)=>{n(),s(void 0)},menuItems:n.headerMenuItems(),onClose:()=>s(void 0)}):null]})})),M=(0,r.ZL)()((e=>({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},content:{gridArea:"1/1",position:"relative"},grid:{display:"grid"},relative:{position:"relative"},rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:e.palette.action.disabledBackground,height:15,"&:hover":{background:e.palette.action.selected}}}))),B=(0,s.observer)((e=>{let{model:n}=e;const{classes:t}=M();return(0,p.jsx)(p.Fragment,{children:n.tracks.map((e=>{const[o]=e.displays,{RenderingComponent:r}=o,s=(0,i.getConf)(e,"trackId");return r?(0,p.jsx)("div",{className:t.overlay,style:{height:n.middleComparativeHeight,overflow:"hidden"},children:(0,p.jsx)(r,{model:o})},s):null}))})})),S=(0,s.observer)((e=>{let{model:n}=e;const{classes:t}=M(),{views:o}=n,{pluginManager:r}=(0,a.getEnv)(n),{ReactComponent:s}=r.getViewType(o[0].type);return(0,p.jsxs)("div",{className:t.rubberbandContainer,children:[(0,p.jsx)(k,{model:n}),(0,p.jsx)(b,{model:n,ControlComponent:(0,p.jsx)("div",{className:t.rubberbandDiv})}),(0,p.jsxs)("div",{className:t.container,children:[(0,p.jsx)(s,{model:o[0]}),(0,p.jsx)("div",{className:t.grid,children:(0,p.jsx)(B,{model:n})}),(0,p.jsx)(l.ResizeHandle,{onDrag:e=>n.setMiddleComparativeHeight(n.middleComparativeHeight+e),style:{height:4,background:"#ccc"}}),(0,p.jsx)(s,{model:o[1]})]})]})})),Z=(0,s.observer)((e=>{let{model:n}=e;const{classes:t}=M(),{views:o}=n,{pluginManager:r}=(0,a.getEnv)(n);return(0,p.jsxs)("div",{className:t.rubberbandContainer,children:[(0,p.jsx)(k,{model:n}),(0,p.jsx)(b,{model:n,ControlComponent:(0,p.jsx)("div",{className:t.rubberbandDiv})}),(0,p.jsx)("div",{className:t.container,children:(0,p.jsxs)("div",{className:t.content,children:[(0,p.jsx)("div",{className:t.relative,children:o.map((e=>{const{ReactComponent:n}=r.getViewType(e.type);return(0,p.jsx)(n,{model:e},e.id)}))}),(0,p.jsx)(B,{model:n})]})})]})})),E=(0,s.observer)((function(e){const{model:n}=e;return n.tracks.some((e=>{let{displays:n}=e;return n.some((e=>(0,i.getConf)(e,"middle")))}))?(0,p.jsx)(S,{...e}):(0,p.jsx)(Z,{...e})}))},94594:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var o=t(41867),r=t(3762),s=t(64535),i=t(80838);const a=(0,o.lazy)((()=>t.e(8156).then(t.bind(t,38156)))),l=(0,r.observer)((e=>{let{model:n}=e;return n.initialized?(0,i.jsx)(s.default,{model:n}):(0,i.jsx)(a,{model:n})}))}}]);
//# sourceMappingURL=4594.29030d9f.chunk.js.map