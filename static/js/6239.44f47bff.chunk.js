"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6239],{6239:function(e,t,r){r.r(t),r.d(t,{renderToSvg:function(){return w}});var n=r(32723),a=r(33028),i=r(34795),s=(r(96902),r(93751)),c=r(30908),o=r(75717),u=r(27664),l=r(16151),d=r(17867),f=r(50209),h=r(88636),p=r(29938);function x(e){var t=e.width,r=e.height,n=e.shift,a=(0,h.Z)();return(0,p.jsx)("rect",{width:t+2*n,height:r,fill:a.palette.background.default})}var m=r(70833);function w(e,t){return v.apply(this,arguments)}function v(){return v=(0,i.Z)((0,n.Z)().mark((function e(t,r){var h,w,v,g,b,j,k,y,Z,S,z,T,H,L,P,R,B,C,N,_,G,D,J,M,O,U,A,E,F,V,W;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.when)((function(){return t.initialized}));case 2:return w=r.textHeight,v=void 0===w?18:w,g=r.headerHeight,b=void 0===g?30:g,j=r.rulerHeight,k=void 0===j?30:j,y=r.fontSize,Z=void 0===y?13:y,S=r.trackLabels,z=void 0===S?"offset":S,T=r.Wrapper,H=void 0===T?function(e){var t=e.children;return(0,p.jsx)(p.Fragment,{children:t})}:T,L=r.themeName,P=void 0===L?"default":L,R=(0,u.getSession)(t),B=null===(h=R.allThemes)||void 0===h?void 0:h.call(R)[P],C=t.width,N=t.views,_=t.middleComparativeHeight,G=t.tracks,D=50,J=b+k,M=N.map((function(e){return(0,f.hY)(e.tracks,v,z)+J})),O=(0,u.sum)(M)+_+100,e.next=12,Promise.all(N.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,Promise.all(t.tracks.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.displays[0],e.next=3,(0,o.when)((function(){return void 0===i.ready||i.ready}));case 3:return e.t0=t,e.next=6,i.renderSvg((0,a.Z)((0,a.Z)({},r),{},{theme:B}));case 6:return e.t1=e.sent,e.abrupt("return",{track:e.t0,result:e.t1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.t1=e.sent,e.abrupt("return",{view:e.t0,data:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return U=e.sent,e.next=15,Promise.all(G.map(function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var i,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.displays[0],e.next=3,(0,o.when)((function(){return void 0===i.ready||i.ready}));case 3:return e.next=5,(0,u.renderToAbstractCanvas)(C,_,{exportSVG:r},(function(e){return(0,m.Bf)(i,e)}));case 5:if(!("imageData"in(s=e.sent))){e.next=10;break}throw new Error("found a canvas in svg export, probably a bug");case 10:if(!("canvasRecordedData"in s)){e.next=17;break}return e.next=13,(0,u.getSerializedSvg)((0,a.Z)((0,a.Z)({},s),{},{width:C,height:_}));case 13:return e.t0=e.sent,e.abrupt("return",{html:e.t0});case 17:return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 15:return A=e.sent,E=(0,u.max)(N.flatMap((function(e){return e.tracks.map((function(e){return(0,u.measureText)((0,l.getTrackName)(e.configuration,R),Z)}))})),0)+40,V=C+(F="left"===z?E:0),W=(0,d.createJBrowseTheme)(B),e.abrupt("return",(0,c.renderToStaticMarkup)((0,p.jsx)(s.Z,{theme:(0,d.createJBrowseTheme)(B),children:(0,p.jsx)(H,{children:(0,p.jsxs)("svg",{width:C,height:O,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,V+2*D,O].toString(),children:[(0,p.jsx)(x,{width:V,height:O,shift:D}),(0,p.jsxs)("g",{transform:"translate(".concat(D," ").concat(Z,")"),children:[(0,p.jsxs)("g",{transform:"translate(".concat(F,")"),children:[(0,p.jsx)("text",{x:0,fontSize:Z,fill:W.palette.text.primary,children:N[0].assemblyNames.join(", ")}),(0,p.jsx)(f.Uc,{model:U[0].view,fontSize:Z})]}),(0,p.jsx)(f.Ge,{textHeight:v,trackLabels:z,fontSize:Z,model:U[0].view,displayResults:U[0].data,offset:J,trackLabelOffset:F})]}),(0,p.jsx)("defs",{children:(0,p.jsx)("clipPath",{id:"synclip",children:(0,p.jsx)("rect",{x:0,y:0,width:C,height:_})})}),(0,p.jsx)("g",{transform:"translate(".concat(D+F," ").concat(Z+M[0],")"),clipPath:"url(#synclip)",children:A.map((function(e,t){return(0,p.jsx)(u.ReactRendering,{rendering:e},t)}))}),(0,p.jsxs)("g",{transform:"translate(".concat(D," ").concat(Z+M[0]+_,")"),children:[(0,p.jsxs)("g",{transform:"translate(".concat(F,")"),children:[(0,p.jsx)("text",{x:0,fontSize:Z,fill:W.palette.text.primary,children:N[1].assemblyNames.join(", ")}),(0,p.jsx)(f.Uc,{model:U[1].view,fontSize:Z})]}),(0,p.jsx)(f.Ge,{textHeight:v,trackLabels:z,fontSize:Z,model:U[1].view,displayResults:U[1].data,offset:J,trackLabelOffset:F})]})]})})})));case 21:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}}}]);
//# sourceMappingURL=6239.44f47bff.chunk.js.map