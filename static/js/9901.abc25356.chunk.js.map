{"version":3,"file":"static/js/9901.abc25356.chunk.js","mappings":"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","sources":["../../../plugins/legacy-jbrowse/src/JBrowse1Connection/jb1ToJb2.ts"],"sourcesContent":["import { openLocation } from '@jbrowse/core/util/io'\nimport { objectHash } from '@jbrowse/core/util'\nimport {\n  generateUnknownTrackConf,\n  generateUnsupportedTrackConf,\n  guessAdapter,\n  guessTrackType,\n  UNKNOWN,\n  UNSUPPORTED,\n} from '@jbrowse/core/util/tracks'\nimport { Track, RefSeqs, RefSeq } from './types'\n\ninterface Jb2Track {\n  trackId: string\n  name: string\n  description?: string\n  category?: string[]\n  adapter?: Jb2Adapter\n  type?: string\n  defaultRendering?: string\n}\n\ninterface Jb2Adapter {\n  type: string\n  features?: Jb2Feature[]\n  bamLocation?: Jb2Location\n  cramLocation?: Jb2Location\n  craiLocation?: Jb2Location\n  fastaLocation?: Jb2Location\n  faiLocation?: Jb2Location\n  gziLocation?: Jb2Location\n  twoBitLocation?: Jb2Location\n  bigWigLocation?: Jb2Location\n  bigBedLocation?: Jb2Location\n  vcfGzLocation?: Jb2Location\n  gffLocation?: Jb2Location\n  gffGzLocation?: Jb2Location\n  gtfLocation?: Jb2Location\n  bedGzLocation?: Jb2Location\n  index?: { location: Jb2Location; indexType?: string }\n  rootUrlTemplate?: Jb2Location\n  sequenceAdapter?: Jb2Adapter\n}\n\ninterface Jb2Feature {\n  refName: string\n  uniqueId: string\n  start: number\n  end: number\n}\n\ninterface Jb2Location {\n  uri?: string\n  localPath?: string\n  blobId?: string\n  locationType?: string\n}\n\nexport function convertTrackConfig(\n  jb1TrackConfig: Track,\n  dataRoot: string,\n  sequenceAdapter: Jb2Adapter,\n): Jb2Track {\n  const jb2TrackConfig: Jb2Track = {\n    trackId: objectHash(jb1TrackConfig),\n    name: jb1TrackConfig.key || jb1TrackConfig.label,\n  }\n\n  const description =\n    jb1TrackConfig.metadata &&\n    (jb1TrackConfig.metadata.description || jb1TrackConfig.metadata.Description)\n  if (description) {\n    jb2TrackConfig.description = description\n  }\n\n  const category = jb1TrackConfig.category || jb1TrackConfig.metadata?.category\n  jb2TrackConfig.category = category ? category.split(/\\s*\\/\\s*/) : []\n\n  const { storeClass } = jb1TrackConfig\n  if (!jb1TrackConfig.urlTemplate) {\n    if (!(storeClass && storeClass.endsWith('FromConfig'))) {\n      const trackIdentifier = jb1TrackConfig.key || jb1TrackConfig.label\n      console.warn(\n        `Could not import JBrowse1 track \"${trackIdentifier}\" because it does not have a \"urlTemplate\" or is not a \"FromConfig\" track`,\n      )\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        trackIdentifier,\n        jb2TrackConfig.category,\n      )\n    }\n    return generateFromConfigTrackConfig(jb1TrackConfig, jb2TrackConfig)\n  }\n\n  const resolveUrlTemplate = (urlTemplate: string) => {\n    return new URL(urlTemplate, `${dataRoot}/`).href\n      .replaceAll(/%7B/gi, '{')\n      .replaceAll(/%7D/gi, '}')\n  }\n  const urlTemplate = resolveUrlTemplate(jb1TrackConfig.urlTemplate)\n\n  if (storeClass) {\n    if (storeClass === 'JBrowse/Store/SeqFeature/BAM') {\n      const adapter: Jb2Adapter = {\n        type: 'BamAdapter',\n        bamLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.baiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.baiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.bai`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'AlignmentsTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/CRAM') {\n      const adapter: Jb2Adapter = {\n        type: 'CramAdapter',\n        cramLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        sequenceAdapter,\n      }\n      adapter.craiLocation = jb1TrackConfig.craiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.craiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.crai`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'AlignmentsTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/NCList') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'NCListAdapter',\n          rootUrlTemplate: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (\n      storeClass === 'JBrowse/Store/SeqFeature/BigWig' ||\n      storeClass === 'JBrowse/Store/BigWig'\n    ) {\n      if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('XYPlot')) {\n        jb2TrackConfig.defaultRendering = 'xyplot'\n      } else if (\n        jb1TrackConfig.type &&\n        jb1TrackConfig.type.endsWith('Density')\n      ) {\n        jb2TrackConfig.defaultRendering = 'density'\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'QuantitativeTrack',\n        adapter: {\n          type: 'BigWigAdapter',\n          bigWigLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/VCFTabix') {\n      const adapter: Jb2Adapter = {\n        type: 'VcfTabixAdapter',\n        vcfGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'VariantTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/VCFTribble') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `VCFTribble (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GFF3') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'Gff3Adapter',\n          gffLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BigBed') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'BigBedAdapter',\n          bigBedLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GFF3Tabix') {\n      const adapter: Jb2Adapter = {\n        type: 'Gff3TabixAdapter',\n        gffGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BED') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `BED (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BEDTabix') {\n      const adapter: Jb2Adapter = {\n        type: 'BedTabixAdapter',\n        bedGzLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      if (jb1TrackConfig.tbiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.tbiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n        }\n      } else if (jb1TrackConfig.csiUrlTemplate) {\n        adapter.index = {\n          location: {\n            uri: resolveUrlTemplate(jb1TrackConfig.csiUrlTemplate),\n            locationType: 'UriLocation',\n          },\n          indexType: 'CSI',\n        }\n      } else {\n        adapter.index = {\n          location: { uri: `${urlTemplate}.tbi`, locationType: 'UriLocation' },\n        }\n      }\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/GTF') {\n      return {\n        ...jb2TrackConfig,\n        type: 'FeatureTrack',\n        adapter: {\n          type: 'GtfAdapter',\n          gtfLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n    if (\n      storeClass === 'JBrowse/Store/SeqFeature/StaticChunked' ||\n      storeClass === 'JBrowse/Store/Sequence/StaticChunked'\n    ) {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `StaticChunked (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/UnindexedFasta') {\n      return generateUnsupportedTrackConf(\n        jb2TrackConfig.name,\n        `UnindexedFasta (${urlTemplate})`,\n        jb2TrackConfig.category,\n      )\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/IndexedFasta') {\n      const adapter: Jb2Adapter = {\n        type: 'IndexedFastaAdapter',\n        fastaLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      adapter.faiLocation = jb1TrackConfig.faiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.faiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.fai`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'SequenceTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/BgzipIndexedFasta') {\n      const adapter: Jb2Adapter = {\n        type: 'BgzipFastaAdapter',\n        fastaLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n      }\n      adapter.faiLocation = jb1TrackConfig.faiUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.faiUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.fai`,\n            locationType: 'UriLocation',\n          }\n      adapter.gziLocation = jb1TrackConfig.gziUrlTemplate\n        ? {\n            uri: resolveUrlTemplate(jb1TrackConfig.gziUrlTemplate),\n            locationType: 'UriLocation',\n          }\n        : {\n            uri: `${urlTemplate}.gzi`,\n            locationType: 'UriLocation',\n          }\n      return {\n        ...jb2TrackConfig,\n        type: 'ReferenceSequenceTrack',\n        adapter,\n      }\n    }\n    if (storeClass === 'JBrowse/Store/SeqFeature/TwoBit') {\n      return {\n        ...jb2TrackConfig,\n        type: 'ReferenceSequenceTrack',\n        adapter: {\n          type: 'TwoBitAdapter',\n          twoBitLocation: { uri: urlTemplate, locationType: 'UriLocation' },\n        },\n      }\n    }\n  }\n\n  // If we don't recognize the store class, make a best effort to guess by file type\n  jb2TrackConfig.adapter = guessAdapter(\n    { uri: urlTemplate, locationType: 'UriLocation' },\n    undefined,\n    urlTemplate,\n  )\n  if (!jb2TrackConfig.adapter) {\n    throw new Error('Could not determine adapter')\n  }\n\n  if (jb2TrackConfig.adapter.type === UNSUPPORTED) {\n    return generateUnsupportedTrackConf(\n      jb2TrackConfig.name,\n      urlTemplate,\n      jb2TrackConfig.category,\n    )\n  }\n  if (jb2TrackConfig.adapter.type === UNKNOWN) {\n    return generateUnknownTrackConf(\n      jb2TrackConfig.name,\n      urlTemplate,\n      jb2TrackConfig.category,\n    )\n  }\n\n  jb2TrackConfig.type = guessTrackType(jb2TrackConfig.adapter.type)\n\n  if (jb2TrackConfig.type === 'QuantitativeTrack') {\n    if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('XYPlot')) {\n      jb2TrackConfig.defaultRendering = 'xyplot'\n    } else if (jb1TrackConfig.type && jb1TrackConfig.type.endsWith('Density')) {\n      jb2TrackConfig.defaultRendering = 'density'\n    }\n  }\n\n  return jb2TrackConfig\n}\n\nfunction generateFromConfigTrackConfig(\n  jb1TrackConfig: Track,\n  jb2TrackConfig: Jb2Track,\n): Jb2Track {\n  const jb1Features = jb1TrackConfig.features || []\n  const jb2Features = jb1Features.map((feature): Jb2Feature => {\n    const jb2Feature: Jb2Feature = JSON.parse(JSON.stringify(feature))\n    jb2Feature.refName = feature.seq_id\n    jb2Feature.uniqueId = `${feature.seq_id}:${feature.start}-${feature.end}:${\n      feature.name || ''\n    }`\n    return jb2Feature\n  })\n  jb2TrackConfig.adapter = {\n    type: 'FromConfigAdapter',\n    features: jb2Features,\n  }\n  jb2TrackConfig.type = 'FeatureTrack'\n  return jb2TrackConfig\n}\n\nexport async function createRefSeqsAdapter(\n  refSeqs: string | RefSeqs,\n): Promise<Jb2Adapter> {\n  if (typeof refSeqs === 'string') {\n    // assume refSeqs is a url if it is string\n    refSeqs = {\n      url: refSeqs,\n    }\n  }\n\n  // check refseq urls\n  if (refSeqs.url) {\n    if (refSeqs.url.match(/.fai$/)) {\n      return {\n        type: 'IndexedFastaAdapter',\n        fastaLocation: {\n          uri: refSeqs.url.slice(0, -4),\n          locationType: 'UriLocation',\n        },\n        faiLocation: {\n          uri: refSeqs.url,\n          locationType: 'UriLocation',\n        },\n      }\n    }\n    if (refSeqs.url.match(/.2bit$/)) {\n      return {\n        type: 'TwoBitAdapter',\n        twoBitLocation: { uri: refSeqs.url, locationType: 'UriLocation' },\n      }\n    }\n    if (refSeqs.url.match(/.fa$/)) {\n      throw new Error('Unindexed FASTA adapter not available')\n    }\n    if (refSeqs.url.match(/.sizes/)) {\n      throw new Error('chromosome SIZES adapter not available')\n    }\n    const refSeqsJson = await openLocation({\n      uri: refSeqs.url,\n      locationType: 'UriLocation',\n    }).readFile('utf8')\n    const refSeqsData: RefSeq[] = JSON.parse(refSeqsJson)\n    return refSeqAdapterFromConfig(refSeqsData)\n  }\n  if ('data' in refSeqs) {\n    return refSeqAdapterFromConfig(refSeqs.data || [])\n  }\n  throw new Error(\n    `Could not determine adapter for JBrowse1 refSeqs: ${\n      refSeqs.url || JSON.stringify(refSeqs)\n    }`,\n  )\n}\n\nfunction refSeqAdapterFromConfig(refSeqsData: RefSeq[]): Jb2Adapter {\n  const features = refSeqsData.map(\n    (refSeq): Jb2Feature => ({\n      refName: refSeq.name,\n      uniqueId: refSeq.name,\n      start: refSeq.start,\n      end: refSeq.end,\n    }),\n  )\n  return {\n    type: 'FromConfigAdapter',\n    features,\n  }\n}\n"],"names":["convertTrackConfig","jb1TrackConfig","dataRoot","sequenceAdapter","_jb1TrackConfig$metad","jb2TrackConfig","trackId","objectHash","name","key","label","description","metadata","Description","category","split","storeClass","urlTemplate","endsWith","trackIdentifier","console","warn","concat","generateUnsupportedTrackConf","jb1Features","features","jb2Features","map","feature","jb2Feature","JSON","parse","stringify","refName","seq_id","uniqueId","start","end","adapter","type","generateFromConfigTrackConfig","resolveUrlTemplate","URL","href","replaceAll","bamLocation","uri","locationType","baiUrlTemplate","index","location","csiUrlTemplate","indexType","cramLocation","craiLocation","craiUrlTemplate","rootUrlTemplate","defaultRendering","bigWigLocation","vcfGzLocation","tbiUrlTemplate","gffLocation","bigBedLocation","gffGzLocation","bedGzLocation","gtfLocation","fastaLocation","faiLocation","faiUrlTemplate","gziLocation","gziUrlTemplate","twoBitLocation","guessAdapter","undefined","Error","UNSUPPORTED","UNKNOWN","generateUnknownTrackConf","guessTrackType"],"sourceRoot":""}