"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[6423],{6423:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var s=n(41867),o=n(47192),a=n(47409),r=n(51590),i=n(47500),l=n(93764),c=n(49133),d=n(45489),u=n(96614),m=n(83171),h=n(27768),f=n(23801),p=n(3762),x=n(40753),g=n(43800),b=n(62877),v=n.n(b),Z=n(35421),w=n(90872);var C=n(24728),S=n(83713),j=n(80838);const k=(0,o.ZL)()({dialogContent:{width:"80em"},textAreaFont:{fontFamily:"Courier New"}});const y=(0,p.observer)((function(e){let{model:t,handleClose:n}=e;const{classes:o}=k(),p=(0,w.getSession)(t),[b,y]=(0,s.useState)(),[W,R]=(0,s.useState)(),[q,G]=(0,s.useState)(!1),[N,A]=(0,s.useState)(!1),[M,E]=(0,s.useState)(!1),{leftOffset:L,rightOffset:O}=t,F=Boolean(void 0===W);(0,s.useEffect)((()=>{let e=!0;const n=new AbortController;return(async()=>{try{const s=t.getSelectedRegions(L,O);if(0===s.length)throw new Error("Selected region is out of bounds");const o=await async function(e,t,n){const s=(0,w.getSession)(e),{leftOffset:o,rightOffset:a}=e;if(!o||!a)throw new Error("no offsets on model to use for range");if(o.assemblyName!==a.assemblyName)throw new Error("not able to fetch sequences from multiple assemblies");const{rpcManager:r,assemblyManager:i}=s,l=o.assemblyName||a.assemblyName||"",c=i.get(l);if(!c)throw new Error("assembly ".concat(l," not found"));const d=(0,g.getConf)(c,["sequence","adapter"]),u="getSequence";return r.call(u,"CoreGetFeatures",{adapterConfig:d,regions:t,sessionId:u,signal:n})}(t,s,n.signal);e&&R(o)}catch(s){console.error(s),e&&y(s)}})(),()=>{n.abort(),e=!1}}),[t,p,L,O]);const T=W?W.filter((e=>!!e)).map((e=>{var t;let n=e.get("seq");const s=e.get("refName"),o=e.get("start")+1,a=e.get("end"),r="".concat(s,":").concat(o,"-").concat(a);if((null===(t=n)||void 0===t?void 0:t.length)!==a-o+1)throw new Error("".concat(r," returned ").concat(n.length.toLocaleString()," bases, but should have returned ").concat((a-o).toLocaleString()));return q&&(n=(0,w.reverse)(n)),M&&(n=(0,w.complement)(n)),{header:r+(q?"-rev":"")+(M?"-comp":""),seq:n}})).map((e=>">".concat(e.header,"\n").concat(e.seq.replaceAll(/(.{1,80})/g,"$1\n").trimEnd()))).join("\n"):"";const _=!!T&&T.length>1e6;return(0,j.jsxs)(Z.Dialog,{maxWidth:"xl",open:!0,onClose:()=>{n(),t.setOffsets()},title:"Reference sequence",children:[(0,j.jsxs)(a.Z,{children:[b?(0,j.jsx)(r.Z,{color:"error",children:"".concat(b)}):F?(0,j.jsxs)(i.Z,{children:["Retrieving reference sequence...",(0,j.jsx)(l.Z,{style:{marginLeft:10},size:20,disableShrink:!0})]}):null,(0,j.jsx)(c.Z,{variant:"outlined",multiline:!0,minRows:5,maxRows:10,disabled:_,className:o.dialogContent,fullWidth:!0,value:_?"Reference sequence too large to display, use the download FASTA button":T,InputProps:{readOnly:!0,classes:{input:o.textAreaFont}}}),(0,j.jsxs)(d.Z,{children:[(0,j.jsx)(u.Z,{control:(0,j.jsx)(m.Z,{value:q,onChange:e=>G(e.target.checked)}),label:"Reverse sequence"}),(0,j.jsx)(u.Z,{control:(0,j.jsx)(m.Z,{value:M,onChange:e=>E(e.target.checked)}),label:"Complement sequence"})]}),(0,j.jsx)(r.Z,{style:{margin:10},children:'Note: Check both boxes for the "reverse complement"'})]}),(0,j.jsxs)(h.Z,{children:[(0,j.jsx)(f.Z,{onClick:()=>{v()(T),A(!0),setTimeout((()=>A(!1)),500)},disabled:F||!!b||_,startIcon:(0,j.jsx)(C.pt,{}),children:N?"Copied":"Copy to clipboard"}),(0,j.jsx)(f.Z,{onClick:()=>{(0,x.saveAs)(new Blob([T||""],{type:"text/x-fasta;charset=utf-8"}),"jbrowse_ref_seq.fa")},disabled:F||!!b,startIcon:(0,j.jsx)(S.Z,{}),children:"Download FASTA"}),(0,j.jsx)(f.Z,{onClick:n,variant:"contained",children:"Close"})]})]})}))},83713:(e,t,n)=>{var s=n(71600);t.Z=void 0;var o=s(n(80337)),a=n(80838),r=(0,o.default)((0,a.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");t.Z=r},47500:(e,t,n)=>{n.d(t,{Z:()=>C});var s=n(31461),o=n(7896),a=n(41867),r=n(66184),i=n(19092),l=n(88498),c=n(92705),d=n(8380),u=n(35283),m=n(15453),h=n(80838);const f=["className","component","disableGutters","fixed","maxWidth","classes"],p=(0,m.Z)(),x=(0,u.Z)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat((0,i.Z)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),g=e=>(0,d.Z)({props:e,name:"MuiContainer",defaultTheme:p});var b=n(9931),v=n(75693),Z=n(90293);const w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=x,useThemeProps:n=g,componentName:d="MuiContainer"}=e,u=t((e=>{let{theme:t,ownerState:n}=e;return(0,o.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!n.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}})}),(e=>{let{theme:t,ownerState:n}=e;return n.fixed&&Object.keys(t.breakpoints.values).reduce(((e,n)=>{const s=n,o=t.breakpoints.values[s];return 0!==o&&(e[t.breakpoints.up(s)]={maxWidth:"".concat(o).concat(t.breakpoints.unit)}),e}),{})}),(e=>{let{theme:t,ownerState:n}=e;return(0,o.Z)({},"xs"===n.maxWidth&&{[t.breakpoints.up("xs")]:{maxWidth:Math.max(t.breakpoints.values.xs,444)}},n.maxWidth&&"xs"!==n.maxWidth&&{[t.breakpoints.up(n.maxWidth)]:{maxWidth:"".concat(t.breakpoints.values[n.maxWidth]).concat(t.breakpoints.unit)}})})),m=a.forwardRef((function(e,t){const a=n(e),{className:m,component:p="div",disableGutters:x=!1,fixed:g=!1,maxWidth:b="lg"}=a,v=(0,s.Z)(a,f),Z=(0,o.Z)({},a,{component:p,disableGutters:x,fixed:g,maxWidth:b}),w=((e,t)=>{const{classes:n,fixed:s,disableGutters:o,maxWidth:a}=e,r={root:["root",a&&"maxWidth".concat((0,i.Z)(String(a))),s&&"fixed",o&&"disableGutters"]};return(0,c.Z)(r,(e=>(0,l.Z)(t,e)),n)})(Z,d);return(0,h.jsx)(u,(0,o.Z)({as:p,ownerState:Z,className:(0,r.Z)(w.root,m),ref:t},v))}));return m}({createStyledComponent:(0,v.ZP)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["maxWidth".concat((0,b.Z)(String(n.maxWidth)))],n.fixed&&t.fixed,n.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,Z.Z)({props:e,name:"MuiContainer"})}),C=w}}]);
//# sourceMappingURL=6423.7f50a587.chunk.js.map