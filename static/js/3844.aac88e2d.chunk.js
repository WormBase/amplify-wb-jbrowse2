"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3844],{63844:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var a=o(41867),r=o(3762),n=o(90872),s=o(55022),i=o(35421),c=o(47409),l=o(81108),d=o(89170),h=o(51590),m=o(77573),p=o(3725),u=o(49133),w=o(27768),x=o(23801),f=o(59062),k=o(78155),Z=o(47192),j=o(93226),b=o(95460),g=o(42844),y=o(42408),v=o(97990),S=o(80838);const I=(0,Z.ZL)()((e=>{var t;return{flexItem:{margin:5},expandIcon:{color:(null===(t=e.palette.tertiary)||void 0===t?void 0:t.contrastText)||"#fff"}}}));const C=(0,r.observer)((function(e){let{onClose:t,model:o}=e;const{classes:r}=I(),[Z,C]=(0,a.useState)(),[N,A]=(0,a.useState)(),[D,L]=(0,a.useState)(""),P=(0,n.getSession)(o),{assemblyNames:R}=P,[B,T]=(0,a.useState)(R[0]),[E,U]=(0,a.useState)("shareLinkAccordion");return(0,S.jsxs)(i.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Import bookmarks",children:[(0,S.jsxs)(c.Z,{children:[(0,S.jsxs)(l.Z,{expanded:"shareLinkAccordion"===E,onChange:()=>U("shareLinkAccordion"),children:[(0,S.jsx)(d.Z,{expandIcon:(0,S.jsx)(b.Z,{className:r.expandIcon}),children:(0,S.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"5px"},children:["Import from share link"," ",(0,S.jsx)(m.Z,{title:"The appropriate share link for sharing bookmarks is one generated via the 'Share' button in the 'Bookmarked regions' drawer. Paste it below to import shared bookmarks.",children:(0,S.jsx)(g.Z,{})})]})}),(0,S.jsx)(p.Z,{children:(0,S.jsx)(u.Z,{label:"Enter URL",variant:"outlined",style:{width:"100%"},value:D,onChange:e=>L(e.target.value)})})]}),(0,S.jsxs)(l.Z,{expanded:"fileAccordion"===E,onChange:()=>U("fileAccordion"),children:[(0,S.jsx)(d.Z,{expandIcon:(0,S.jsx)(b.Z,{className:r.expandIcon}),children:(0,S.jsx)(h.Z,{children:"Import from file"})}),(0,S.jsxs)(p.Z,{children:[(0,S.jsx)(i.FileSelector,{location:Z,setLocation:C,name:"File",description:"Choose a BED or TSV format file to import."}),(0,S.jsx)(k.Z,{onChange:e=>T(e),helperText:"Select the assembly your bookmarks belong to (BED or TSV without assembly column).",session:P,selected:B})]})]}),N?(0,S.jsx)(h.Z,{color:"error",variant:"h6",children:"".concat(N)}):null]}),(0,S.jsxs)(w.Z,{children:[(0,S.jsx)(x.Z,{variant:"contained",color:"secondary",onClick:t,children:"Cancel"}),(0,S.jsx)(x.Z,{className:r.flexItem,"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!Z&&!D,startIcon:(0,S.jsx)(j.Z,{}),onClick:async()=>{try{Z?o.importBookmarks(await async function(e,t){return(await(0,f.openLocation)(e).readFile("utf8")).split(/\n|\r\n|\r/).filter((e=>!!e.trim())).filter((e=>!e.startsWith("#")&&!e.startsWith("track")&&!e.startsWith("browser"))).map((e=>{const[o,a,r,n,s]=e.split("\t");return{assemblyName:null!==s&&void 0!==s?s:t,refName:o,start:+a,end:+r,label:"."===n?void 0:n}}))}(Z,B)):D&&(0,s.gx)(P)&&o.importBookmarks(await async function(e,t){const o=new URL(e),a=o.searchParams.get("bookmarks"),r=o.searchParams.get("password"),n=await(0,v.h)("".concat(null!==t&&void 0!==t?t:"https://share.jbrowse.org/api/v1/","load"),a||"",r||"");return JSON.parse(await(0,y.cD)(n)).sharedBookmarks}(D,P.shareURL)),t()}catch(e){console.error(e),A(e)}},children:"Import"})]})]})}))},97990:(e,t,o)=>{o.d(t,{h:()=>c,p:()=>i});var a=o(42408);const r=async(e,t)=>(await Promise.all([o.e(7626),o.e(5607),o.e(633)]).then(o.t.bind(o,45607,23))).encrypt(e,t).toString(),n=async(e,t)=>{const a=await Promise.all([o.e(7626),o.e(5607),o.e(633)]).then(o.t.bind(o,45607,23)),r=await Promise.all([o.e(7626),o.e(6828)]).then(o.t.bind(o,87380,23));return a.decrypt(e,t).toString(r)};function s(e){try{return JSON.parse(e).message}catch(t){return e}}async function i(e,t,o){const n=await(0,a.JY)(JSON.stringify(e)),i=(c=5,window.btoa([...window.crypto.getRandomValues(new Uint8Array(2*c))].map((e=>String.fromCharCode(e))).join("")).replaceAll(/[+/]/g,"").slice(0,c));var c;const l=await r(n,i),d=new FormData;d.append("session",l),d.append("dateShared","".concat(Date.now())),d.append("referer",o);const h=await fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:d});if(!h.ok){const e=await h.text();throw new Error(s(e))}return{json:await h.json(),encryptedSession:l,password:i}}async function c(e,t,o,a){const r=t.split("share-")[1],i="".concat(e,"?sessionId=").concat(encodeURIComponent(r)),c=await fetch(i,{signal:a});if(!c.ok){const e=await c.text();throw new Error(s(e))}const l=await c.json();return n(l.session,o)}},3725:(e,t,o)=>{o.d(t,{Z:()=>u});var a=o(7896),r=o(31461),n=o(41867),s=o(66184),i=o(92705),c=o(75693),l=o(90293),d=o(31498),h=o(80838);const m=["className"],p=(0,c.ZP)("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{padding:t.spacing(1,2,2)}})),u=n.forwardRef((function(e,t){const o=(0,l.Z)({props:e,name:"MuiAccordionDetails"}),{className:n}=o,c=(0,r.Z)(o,m),u=o,w=(e=>{const{classes:t}=e;return(0,i.Z)({root:["root"]},d.s,t)})(u);return(0,h.jsx)(p,(0,a.Z)({className:(0,s.Z)(w.root,n),ref:t,ownerState:u},c))}))},31498:(e,t,o)=>{o.d(t,{Z:()=>s,s:()=>n});var a=o(70101),r=o(88498);function n(e){return(0,r.Z)("MuiAccordionDetails",e)}const s=(0,a.Z)("MuiAccordionDetails",["root"])}}]);
//# sourceMappingURL=3844.aac88e2d.chunk.js.map