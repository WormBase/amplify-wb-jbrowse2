"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[3327,6275],{43327:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var r=n(32723),a=n(34795),s=n(9249),u=n(87371),i=n(45754),c=n(13820),o=n(33528),f=n(42098),l=n(86275),p=n(41361),h="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function d(e){for(var t="",n="",r=0,a=0,s=0,u=0,i=0,c=0,o=[],f=0,l=0,d=!1,v=[],m=new RegExp(/^>(\S+)\s+(\S+)\s+(\d+)\s+(\d+)/),g=0,y=0;g<e.length;){var Z=e.indexOf("\n",g);if(-1===Z)break;var b=e.slice(g,Z),x=((null===h||void 0===h?void 0:h.decode(b))||b.toString()).trim();if(g=Z+1,y++,x){var k=m.exec(x);if(null!==k){t=k[1],n=k[2],d=!0;continue}if(!d)continue;var w=x.split(" ");if(7===w.length){var q=+w[0],N=+w[1],A=+w[2],M=+w[3];i=q<N&&A<M||q>N&&A>M?1:-1,s=+(q<N?q:N)-1,u=+(N>q?N:q),r=+(A<M?A:M)-1,a=+(M>A?M:A),f=l=0,c=+w[4],o=[]}else if(1===w.length){var C=+w[0];if(0===C){var D=0,S=[];if(u-s-f!==a-r-l)throw new Error("inconsistent alignment on line ".concat(y));o.push(u-s-f<<4);var I,L=(0,p.Z)(o);try{for(L.s();!(I=L.n()).done;){var O=I.value>>4;D+=O,S.push(O+"MID".charAt(15&o[y]))}}catch(F){L.e(F)}finally{L.f()}v.push({qname:n,qstart:r,qend:a,tname:t,tstart:s,tend:u,strand:i,extra:{numMatches:D-c,blockLen:D,mappingQual:0,NM:c,cg:S.join("")}})}else if(C>0){var R=C-1;f+=R+1,l+=R,R>0&&o.push(R<<4),o.length>0&&2===(15&o[o.length-1])?o[o.length-1]+=16:o.push(18)}else{var j=-C-1;f+=j,l+=j+1,j>0&&o.push(j<<4),o.length>0&&1===(15&o[o.length-1])?o[o.length-1]+=16:o.push(17)}}}}return v}function v(e){return 31===e[0]&&139===e[1]&&8===e[2]}var m=function(e,t){(0,i.Z)(l,e);var n=(0,c.Z)(l);function l(){return(0,s.Z)(this,l),n.apply(this,arguments)}return(0,u.Z)(l,[{key:"setupPre",value:function(e){return(t=t||(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.openLocation)(this.getConf("deltaLocation"),this.pluginManager),e.next=3,n.readFile(t);case 3:if(!v(a=e.sent)){e.next=10;break}return e.next=7,(0,f.unzip)(a);case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=a;case 11:return s=e.t0,e.abrupt("return",d(s));case 13:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}}]),l}(l.default)},86275:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(33028),a=n(59740),s=n(68079),u=n(41361),i=n(32723),c=n(34795),o=n(9249),f=n(87371),l=n(45754),p=n(13820),h=n(20783),d=n(37654),v=n(33528),m=n(26131),g=n(9077),y=n(42098),Z=n(9065),b=n(93069),x=n(95058),k=n(81073),w=Z.tr.getMismatches,q=function(e){(0,l.Z)(n,e);var t=(0,p.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,f.Z)(n,[{key:"get",value:function(e){return"mismatches"===e?w(this.get("CIGAR")):(0,b.Z)((0,x.Z)(n.prototype),"get",this).call(this,e)}}]),n}(k.SimpleFeature),N=n(74059),A=n(46840),M=n(96234);function C(e){var t,n={},r=(0,u.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,s=a.qname+"-"+a.tname;n[s]||(n[s]={quals:[],len:[]}),n[s].quals.push(a.extra.mappingQual),n[s].len.push(a.extra.blockLen||1)}}catch(x){r.e(x)}finally{r.f()}var i,c=Object.fromEntries(Object.entries(n).map((function(e){var t=(0,M.Z)(e,2),n=t[0],r=t[1];return[n,D((0,N.$R)(r.quals,r.len))]}))),o=(0,u.Z)(e);try{for(o.s();!(i=o.n()).done;){var f=i.value,l=f.qname+"-"+f.tname;f.extra.meanScore=c[l]}}catch(x){o.e(x)}finally{o.f()}var p,h=1e4,d=0,v=(0,u.Z)(e);try{for(v.s();!(p=v.n()).done;){var m=p.value;h=Math.min(m.extra.meanScore||0,h),d=Math.max(m.extra.meanScore||0,d)}}catch(x){v.e(x)}finally{v.f()}var g,y=(0,u.Z)(e);try{for(y.s();!(g=y.n()).done;){var Z=g.value,b=Z.extra.meanScore||0;Z.extra.meanScore=(b-h)/(d-h)}}catch(x){y.e(x)}finally{y.f()}return e}function D(e){var t=e.reduce((function(e,t){var n=(0,M.Z)(e,2),r=n[0],a=n[1],s=(0,M.Z)(t,2),u=s[0],i=s[1];return[r+u*i,a+i]}),[0,0]),n=(0,M.Z)(t,2);return n[0]/n[1]}function S(e){var t=e.split("\t"),n=(0,A.Z)(t),a=n[0],s=n[2],u=n[3],i=n[4],c=n[5],o=n[7],f=n[8],l=n[9],p=n[10],h=n[11],d=n.slice(12),v=Object.fromEntries(d.map((function(e){var t=e.indexOf(":");return[e.slice(0,t),e.slice(t+3)]})));return{tname:c,tstart:+o,tend:+f,qname:a,qstart:+s,qend:+u,strand:"-"===i?-1:1,extra:(0,r.Z)({numMatches:+l,blockLen:+p,mappingQual:+h},v)}}function I(e){for(var t=[],n=e.length-2;n>=0;n-=2){t.push(e[n]);var r=e[n+1];"D"===r?t.push("I"):"I"===r?t.push("D"):t.push(r)}return t}var L=["numMatches","blockLen","cg"],O=Z.tr.parseCigar,R=function(e,t,n,h,Z){(0,l.Z)(x,e);var b=(0,p.Z)(x);function x(){var e;(0,o.Z)(this,x);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=b.call.apply(b,[this].concat(n))).setupP=void 0,e}return(0,f.Z)(x,[{key:"setup",value:function(e){return(t=t||(0,c.Z)((0,i.Z)().mark((function e(t){var n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setupP||(this.setupP=this.setupPre(t).catch((function(e){throw n.setupP=void 0,e}))),e.abrupt("return",this.setupP);case 2:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"setupPre",value:function(e){return(n=n||(0,c.Z)((0,i.Z)().mark((function e(t){var n,r,a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.pluginManager,r=(0,v.openLocation)(this.getConf("pafLocation"),n),e.next=4,r.readFile(t);case 4:if(a=e.sent,!(0,N.lq)(a)){e.next=11;break}return e.next=8,(0,y.unzip)(a);case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=a;case 12:return s=e.t0,e.abrupt("return",(0,N.WU)(s,S));case 14:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"hasDataForRefName",value:function(){return(h=h||(0,c.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},{key:"getAssemblyNames",value:function(){var e=this.getConf("assemblyNames");return 0===e.length?[this.getConf("queryAssembly"),this.getConf("targetAssembly")]:e}},{key:"getRefNames",value:function(){return(Z=Z||(0,c.Z)((0,i.Z)().mark((function e(){var t,n,r,a,c,o,f,l,p,h=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(t=(n=h.length>0&&void 0!==h[0]?h[0]:{}).regions)||void 0===t?void 0:t[0].assemblyName,e.next=4,this.setup(n);case 4:if(a=e.sent,-1===(c=this.getAssemblyNames().indexOf(r))){e.next=11;break}o=new Set,f=(0,u.Z)(a);try{for(f.s();!(l=f.n()).done;)p=l.value,o.add(0===c?p.qname:p.tname)}catch(i){f.e(i)}finally{f.f()}return e.abrupt("return",(0,s.Z)(o));case 11:return console.warn("Unable to do ref renaming on adapter"),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}},{key:"getFeatures",value:function(e){var t,n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,m.ObservableCreate)((function(u){return(t=t||(0,c.Z)((0,i.Z)().mark((function t(u){var c,o,f,l,p,h,v,m,y,Z,b,x,k,w,N,A,M,D,S,R,j,F,P,T,E,Q;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.setup(s);case 2:for(c=t.sent,(o=s.config)&&"meanQueryIdentity"===(0,g.readConfObject)(o,"colorBy")&&(c=C(c)),f=n.getAssemblyNames(),l=f.indexOf(e.assemblyName),p=e.start,h=e.end,v=e.refName,m=e.assemblyName,-1===l&&(console.warn("".concat(m," not found in this adapter")),u.complete()),y=0;y<c.length;y++)Z=c[y],b=0,x=0,k="",w="",N=0,A=0,D=f[+!(M=0===l)],0===l?(b=Z.qstart,x=Z.qend,k=Z.qname,w=Z.tname,N=Z.tstart,A=Z.tend):(b=Z.tstart,x=Z.tend,k=Z.tname,w=Z.qname,N=Z.qstart,A=Z.qend),S=Z.extra,R=Z.strand,k===v&&(0,d.qY)(p,h,b,x)&&(j=S.numMatches,F=void 0===j?0:j,P=S.blockLen,T=void 0===P?1:P,S.cg,E=(0,a.Z)(S,L),Q=S.cg,S.cg&&(M&&-1===R?Q=I(O(S.cg)).join(""):M&&(i=S.cg,Q=i.replaceAll("D","K").replaceAll("I","D").replaceAll("K","I"))),u.next(new q((0,r.Z)((0,r.Z)({uniqueId:y+D,assemblyName:D,start:b,end:x,type:"match",refName:k,strand:R},E),{},{CIGAR:Q,syntenyId:y,identity:F/T,numMatches:F,blockLen:T,mate:{start:N,end:A,refName:w,assemblyName:f[+M]}}))));u.complete();case 11:case"end":return t.stop()}var i}),t)})))).apply(this,arguments)}))}},{key:"freeResources",value:function(){}}]),x}(h.BaseFeatureDataAdapter);R.capabilities=["getFeatures","getRefNames"]},74059:function(e,t,n){n.d(t,{$R:function(){return l},SN:function(){return o},WU:function(){return h},lq:function(){return c},pJ:function(){return f}});var r,a=n(32723),s=n(34795),u=n(96234),i=n(42098);function c(e){return 31===e[0]&&139===e[1]&&8===e[2]}function o(e){return new Map(e.split(/\n|\r\n|\r/).filter((function(e){return!!e||e.startsWith("#")})).map((function(e){var t=e.split("\t"),n=(0,u.Z)(t,6),r=n[0],a=n[1],s=n[2],i=n[3];return[i,{refName:r,start:+a,end:+s,score:+n[4],name:i,strand:"-"===n[5]?-1:1}]})))}function f(e,t){return(r=r||(0,s.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readFile(n);case 2:if(r=e.sent,e.t0=new TextDecoder("utf8",{fatal:!0}),!c(r)){e.next=10;break}return e.next=7,(0,i.unzip)(r);case 7:e.t1=e.sent,e.next=11;break;case 10:e.t1=r;case 11:return e.t2=e.t1,e.abrupt("return",e.t0.decode.call(e.t0,e.t2));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){return e.map((function(e,n){return[e,t[n]]}))}var p="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function h(e,t){for(var n=0,r=[];n<e.length;){var a=e.indexOf("\n",n);if(-1===a)break;var s=e.slice(n,a),u=((null===p||void 0===p?void 0:p.decode(s))||s.toString()).trim();u&&r.push(t(u)),n=a+1}return r}}}]);
//# sourceMappingURL=3327.01c75e78.chunk.js.map