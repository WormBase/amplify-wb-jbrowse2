"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[2419],{12419:function(e,n,t){t.r(n);var r=t(32723),a=t(96234),o=t(34795),s=t(30969),i=t(90550),c=t(81073),u=t(59767),d=t(59071),l=t(59313),p=t(80928),f=t(33359),m=t(50501),x=t(87006),h=t(96074),Z=t(72097),v=t(33528),b=t(84291),w=t(53276),k=t(32207),g=t(23038),y=t(38935),j=t(54299),S=t(37574),C=(0,w.ZL)()((function(e){var n;return{flexItem:{margin:5},expandIcon:{color:(null===(n=e.palette.tertiary)||void 0===n?void 0:n.contrastText)||"#fff"}}}));function I(e,n){return N.apply(this,arguments)}function N(){return(N=(0,o.Z)((0,r.Z)().mark((function e(n,t){var a,o,s,i,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://share.jbrowse.org/api/v1/",a=new URL(n),o=a.searchParams.get("bookmarks"),s=a.searchParams.get("password"),e.next=6,(0,j.h)("".concat(null!==t&&void 0!==t?t:"https://share.jbrowse.org/api/v1/","load"),o||"",s||"");case 6:return i=e.sent,e.t0=JSON,e.next=10,(0,y.cD)(i);case 10:return e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),e.abrupt("return",c.sharedBookmarks);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,n){return R.apply(this,arguments)}function R(){return(R=(0,o.Z)((0,r.Z)().mark((function e(n,t){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.openLocation)(n).readFile("utf8");case 2:return o=e.sent,e.abrupt("return",o.split(/\n|\r\n|\r/).filter((function(e){return!!e.trim()})).filter((function(e){return!e.startsWith("#")&&!e.startsWith("track")&&!e.startsWith("browser")})).map((function(e){var n=e.split("\t"),r=(0,a.Z)(n,5),o=r[0],s=r[1],i=r[2],c=r[3],u=r[4];return{assemblyName:null!==u&&void 0!==u?u:t,refName:o,start:+s,end:+i,label:"."===c?void 0:c}})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=(0,i.observer)((function(e){var n=e.onClose,t=e.model,i=C().classes,v=(0,s.useState)(),w=(0,a.Z)(v,2),y=w[0],j=w[1],N=(0,s.useState)(),R=(0,a.Z)(N,2),M=R[0],V=R[1],D=(0,s.useState)(""),W=(0,a.Z)(D,2),L=W[0],P=W[1],G=(0,c.getSession)(t),E=(0,c.getSession)(t),B=E.assemblyNames,O=E.shareURL,T=(0,s.useState)(B[0]),U=(0,a.Z)(T,2),F=U[0],J=U[1],_=(0,s.useState)("shareLinkAccordion"),H=(0,a.Z)(_,2),z=H[0],Y=H[1];return(0,S.jsxs)(u.Dialog,{open:!0,onClose:n,maxWidth:"xl",title:"Import bookmarks",children:[(0,S.jsxs)(d.Z,{children:[(0,S.jsxs)(l.Z,{expanded:"shareLinkAccordion"===z,onChange:function(){return Y("shareLinkAccordion")},children:[(0,S.jsx)(p.Z,{expandIcon:(0,S.jsx)(g.Z,{className:i.expandIcon}),children:(0,S.jsx)(f.Z,{children:"Import from share link"})}),(0,S.jsx)(m.Z,{children:(0,S.jsx)(x.Z,{label:"Enter URL",variant:"outlined",style:{width:"100%"},value:L,onChange:function(e){return P(e.target.value)}})})]}),(0,S.jsxs)(l.Z,{expanded:"fileAccordion"===z,onChange:function(){return Y("fileAccordion")},children:[(0,S.jsx)(p.Z,{expandIcon:(0,S.jsx)(g.Z,{className:i.expandIcon}),children:(0,S.jsx)(f.Z,{children:"Import from file"})}),(0,S.jsxs)(m.Z,{children:[(0,S.jsx)(u.FileSelector,{location:y,setLocation:j,name:"File",description:"Choose a BED or TSV format file to import."}),(0,S.jsx)(b.Z,{onChange:function(e){return J(e)},helperText:"Select the assembly your bookmarks belong to (BED or TSV without assembly column).",session:G,selected:F})]})]}),M?(0,S.jsx)(f.Z,{color:"error",variant:"h6",children:"".concat(M)}):null]}),(0,S.jsxs)(h.Z,{children:[(0,S.jsx)(Z.Z,{variant:"contained",color:"secondary",onClick:n,children:"Cancel"}),(0,S.jsx)(Z.Z,{className:i.flexItem,"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!y&&!L,startIcon:(0,S.jsx)(k.Z,{}),onClick:(0,o.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!y){e.next=9;break}return e.t0=t,e.next=5,A(y,F);case 5:e.t1=e.sent,e.t0.importBookmarks.call(e.t0,e.t1),e.next=15;break;case 9:if(!L){e.next=15;break}return e.t2=t,e.next=13,I(L,O);case 13:e.t3=e.sent,e.t2.importBookmarks.call(e.t2,e.t3);case 15:n(),e.next=22;break;case 18:e.prev=18,e.t4=e.catch(0),console.error(e.t4),V(e.t4);case 22:case"end":return e.stop()}}),e,null,[[0,18]])}))),children:"Import"})]})]})}));n.default=M},54299:function(e,n,t){t.d(n,{h:function(){return p},p:function(){return d}});var r=t(32723),a=t(34795),o=t(68079),s=t(38935);var i=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(7923),t.e(6277)]).then(t.t.bind(t,46277,23));case 2:return o=e.sent,e.abrupt("return",o.encrypt(n,a).toString());case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var o,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.e(7923),t.e(6277)]).then(t.t.bind(t,46277,23));case 2:return o=e.sent,e.next=5,t.e(3136).then(t.t.bind(t,33136,23));case 5:return s=e.sent,i=o.decrypt(n,a),e.abrupt("return",i.toString(s));case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();function u(e){try{return JSON.parse(e).message}catch(n){return e}}function d(e,n,t){return l.apply(this,arguments)}function l(){return(l=(0,a.Z)((0,r.Z)().mark((function e(n,t,a){var c,d,l,p,f,m,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.JY)(JSON.stringify(n));case 2:return c=e.sent,r=5,d=window.btoa((0,o.Z)(window.crypto.getRandomValues(new Uint8Array(2*r))).map((function(e){return String.fromCharCode(e)})).join("")).replaceAll(/[+/]/g,"").slice(0,r),e.next=6,i(c,d);case 6:return l=e.sent,(p=new FormData).append("session",l),p.append("dateShared","".concat(Date.now())),p.append("referer",a),e.next=13,fetch("".concat(t,"share"),{method:"POST",mode:"cors",body:p});case 13:if((f=e.sent).ok){e.next=19;break}return e.next=17,f.text();case 17:throw m=e.sent,new Error(u(m));case 19:return e.next=21,f.json();case 21:return x=e.sent,e.abrupt("return",{json:x,encryptedSession:l,password:d});case 23:case"end":return e.stop()}var r}),e)})))).apply(this,arguments)}function p(e,n,t,r){return f.apply(this,arguments)}function f(){return(f=(0,a.Z)((0,r.Z)().mark((function e(n,t,a,o){var s,i,d,l,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.split("share-")[1],i="".concat(n,"?sessionId=").concat(encodeURIComponent(s)),e.next=4,fetch(i,{signal:o});case 4:if((d=e.sent).ok){e.next=10;break}return e.next=8,d.text();case 8:throw l=e.sent,new Error(u(l));case 10:return e.next=12,d.json();case 12:return p=e.sent,e.abrupt("return",c(p.session,a));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},23038:function(e,n,t){var r=t(71600);n.Z=void 0;var a=r(t(48035)),o=t(37574),s=(0,a.default)((0,o.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");n.Z=s},50501:function(e,n,t){var r=t(7896),a=t(31461),o=t(30969),s=t(87023),i=t(26540),c=t(45971),u=t(17363),d=t(34096),l=t(37574),p=["className"],f=(0,c.ZP)("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(e){return{padding:e.theme.spacing(1,2,2)}})),m=o.forwardRef((function(e,n){var t=(0,u.Z)({props:e,name:"MuiAccordionDetails"}),o=t.className,c=(0,a.Z)(t,p),m=t,x=function(e){var n=e.classes;return(0,i.Z)({root:["root"]},d.s,n)}(m);return(0,l.jsx)(f,(0,r.Z)({className:(0,s.Z)(x.root,o),ref:n,ownerState:m},c))}));n.Z=m},34096:function(e,n,t){t.d(n,{s:function(){return o}});var r=t(62746),a=t(2975);function o(e){return(0,a.Z)("MuiAccordionDetails",e)}var s=(0,r.Z)("MuiAccordionDetails",["root"]);n.Z=s},80928:function(e,n,t){t.d(n,{Z:function(){return g}});var r=t(56666),a=t(31461),o=t(7896),s=t(30969),i=t(87023),c=t(26540),u=t(45971),d=t(17363),l=t(6596),p=t(56325),f=t(62746),m=t(2975);function x(e){return(0,m.Z)("MuiAccordionSummary",e)}var h=(0,f.Z)("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Z=t(37574),v=["children","className","expandIcon","focusVisibleClassName","onClick"],b=(0,u.ZP)(l.Z,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:function(e,n){return n.root}})((function(e){var n,t=e.theme,a=e.ownerState,s={duration:t.transitions.duration.shortest};return(0,o.Z)((n={display:"flex",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],s)},(0,r.Z)(n,"&.".concat(h.focusVisible),{backgroundColor:(t.vars||t).palette.action.focus}),(0,r.Z)(n,"&.".concat(h.disabled),{opacity:(t.vars||t).palette.action.disabledOpacity}),(0,r.Z)(n,"&:hover:not(.".concat(h.disabled,")"),{cursor:"pointer"}),n),!a.disableGutters&&(0,r.Z)({},"&.".concat(h.expanded),{minHeight:64}))})),w=(0,u.ZP)("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:function(e,n){return n.content}})((function(e){var n=e.theme,t=e.ownerState;return(0,o.Z)({display:"flex",flexGrow:1,margin:"12px 0"},!t.disableGutters&&(0,r.Z)({transition:n.transitions.create(["margin"],{duration:n.transitions.duration.shortest})},"&.".concat(h.expanded),{margin:"20px 0"}))})),k=(0,u.ZP)("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:function(e,n){return n.expandIconWrapper}})((function(e){var n=e.theme;return(0,r.Z)({display:"flex",color:(n.vars||n).palette.action.active,transform:"rotate(0deg)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shortest})},"&.".concat(h.expanded),{transform:"rotate(180deg)"})})),g=s.forwardRef((function(e,n){var t=(0,d.Z)({props:e,name:"MuiAccordionSummary"}),r=t.children,u=t.className,l=t.expandIcon,f=t.focusVisibleClassName,m=t.onClick,h=(0,a.Z)(t,v),g=s.useContext(p.Z),y=g.disabled,j=void 0!==y&&y,S=g.disableGutters,C=g.expanded,I=g.toggle,N=(0,o.Z)({},t,{expanded:C,disabled:j,disableGutters:S}),A=function(e){var n=e.classes,t=e.expanded,r=e.disabled,a=e.disableGutters,o={root:["root",t&&"expanded",r&&"disabled",!a&&"gutters"],focusVisible:["focusVisible"],content:["content",t&&"expanded",!a&&"contentGutters"],expandIconWrapper:["expandIconWrapper",t&&"expanded"]};return(0,c.Z)(o,x,n)}(N);return(0,Z.jsxs)(b,(0,o.Z)({focusRipple:!1,disableRipple:!0,disabled:j,component:"div","aria-expanded":C,className:(0,i.Z)(A.root,u),focusVisibleClassName:(0,i.Z)(A.focusVisible,f),onClick:function(e){I&&I(e),m&&m(e)},ref:n,ownerState:N},h,{children:[(0,Z.jsx)(w,{className:A.content,ownerState:N,children:r}),l&&(0,Z.jsx)(k,{className:A.expandIconWrapper,ownerState:N,children:l})]}))}))}}]);
//# sourceMappingURL=2419.ba1e8b7e.chunk.js.map