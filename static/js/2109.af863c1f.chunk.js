"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[2109],{62109:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Z});var o=t(41867),s=t(90552),r=t(36669),a=t(59231),c=t(23801),l=t(77573),i=t(51590),u=t(68367),d=t(47192),p=t(62877),m=t.n(p),f=t(90872),h=t(35421),x=t(51862),b=t(43800);const g=5e5;var w=t(80838);const j=(0,o.lazy)((()=>t.e(18).then(t.bind(t,20018)))),C=(0,o.lazy)((()=>t.e(6882).then(t.bind(t,16882)))),v=(0,d.ZL)()((e=>({button:{margin:e.spacing(1)},formControl:{margin:0},container2:{marginTop:e.spacing(1)}})));function Z(e){var n,t;let{model:u,feature:d}=e;const{classes:p}=v(),x=d,j=(0,o.useRef)(null),[Z,S]=(0,f.useLocalStorage)("intronBp",10),[B,N]=(0,f.useLocalStorage)("upDownBp",500),[q,_]=(0,o.useState)(!1),[k,D]=(0,o.useState)(!1),[L,G]=(0,o.useState)(!1),M=null===(n=x.subfeatures)||void 0===n?void 0:n.some((e=>"CDS"===e.type)),T=null===(t=x.subfeatures)||void 0===t?void 0:t.some((e=>"exon"===e.type)),F=T||M,{sequence:z,error:E}=function(e,n,t,s){const[r,a]=(0,o.useState)(),[c,l]=(0,o.useState)();return(0,o.useEffect)((()=>{var o;let r=!1;if(!e)return()=>{};const{assemblyManager:c,rpcManager:i}=(0,f.getSession)(e),[u]=(null===(o=e.view)||void 0===o?void 0:o.assemblyNames)||[];async function d(e,n,t){const o=await c.waitForAssembly(u);if(!o)throw new Error("assembly not found");const s="getSequence",r=await i.call(s,"CoreGetFeatures",{adapterConfig:(0,b.getConf)(o,["sequence","adapter"]),sessionId:s,regions:[{start:e,end:n,refName:o.getCanonicalRefName(t),assemblyName:u}]}),[a]=r;return(null===a||void 0===a?void 0:a.get("seq"))||""}return(async()=>{try{l(void 0);const{start:e,end:o,refName:c}=n;if(!s&&o-e>g)a({error:"Genomic sequence larger than ".concat(g,'bp, use "force load" button to display')});else{const n=e-t,s=o+t,l=await d(e,o,c),i=await d(Math.max(0,n),e,c),u=await d(o,s,c);r||a({seq:l,upstream:i,downstream:u})}}catch(e){console.error(e),l(e)}})(),()=>{r=!0}}),[n,e,t,s]),{sequence:r,error:c}}(u,d,B,L),[H,I]=(0,o.useState)(M?"cds":T?"cdna":"genomic"),A={...M?{cds:"CDS"}:{},...M?{protein:"Protein"}:{},...F?{cdna:"cDNA"}:{},...F?{gene:"Genomic w/ full introns"}:{},...F?{gene_updownstream:"Genomic w/ full introns +/- ".concat(B,"bp up+down stream")}:{},...F?{gene_collapsed_intron:"Genomic w/ ".concat(Z,"bp intron")}:{},...F?{gene_updownstream_collapsed_intron:"Genomic w/ ".concat(Z,"bp intron +/- ").concat(B,"bp up+down stream ")}:{},...F?{}:{genomic:"Genomic"},...F?{}:{genomic_sequence_updownstream:"Genomic +/- ".concat(B,"bp up+down stream")}};return(0,w.jsxs)("div",{className:p.container2,children:[(0,w.jsx)(s.Z,{className:p.formControl,children:(0,w.jsx)(r.Z,{value:H,onChange:e=>I(e.target.value),children:Object.entries(A).map((e=>{let[n,t]=e;return(0,w.jsx)(a.Z,{value:n,children:t},n)}))})}),(0,w.jsx)(s.Z,{className:p.formControl,children:(0,w.jsx)(c.Z,{className:p.button,variant:"contained",onClick:()=>{const e=j.current;e&&(m()(e.textContent||"",{format:"text/plain"}),_(!0),setTimeout((()=>_(!1)),1e3))},children:q?"Copied to clipboard!":"Copy plaintext"})}),(0,w.jsx)(s.Z,{className:p.formControl,children:(0,w.jsx)(l.Z,{title:"The 'Copy HTML' function retains the colors from the sequence panel but cannot be pasted into some programs like notepad that only expect plain text",children:(0,w.jsx)(c.Z,{className:p.button,variant:"contained",onClick:()=>{const e=j.current;e&&(m()(e.innerHTML,{format:"text/html"}),D(!0),setTimeout((()=>D(!1)),1e3))},children:k?"Copied to clipboard!":"Copy HTML"})})}),(0,w.jsx)(y,{upDownBp:B,intronBp:Z,setIntronBp:S,setUpDownBp:N}),(0,w.jsx)("br",{}),"gene"===x.type?(0,w.jsx)(i.Z,{children:"Note: inspect subfeature sequences for protein/CDS computations"}):null,E?(0,w.jsx)(i.Z,{color:"error",children:"".concat(E)}):z?z?"error"in z?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(i.Z,{color:"error",children:z.error}),(0,w.jsx)(c.Z,{variant:"contained",color:"inherit",onClick:()=>G(!0),children:"Force load"})]}):(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)(h.LoadingEllipses,{}),children:(0,w.jsx)(C,{ref:j,feature:x,mode:H,sequence:z,intronBp:Z})}):(0,w.jsx)(i.Z,{children:"No sequence found"}):(0,w.jsx)(h.LoadingEllipses,{})]})}function y(e){let{intronBp:n,upDownBp:t,setIntronBp:r,setUpDownBp:a}=e;const{classes:c}=v(),[l,i]=(0,o.useState)(!1);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{className:c.formControl,children:(0,w.jsx)(u.Z,{onClick:()=>i(!0),children:(0,w.jsx)(x.Z,{})})}),l?(0,w.jsx)(o.Suspense,{fallback:(0,w.jsx)("div",{}),children:(0,w.jsx)(j,{handleClose:e=>{if(e){const{upDownBp:n,intronBp:t}=e;r(t),a(n)}i(!1)},upDownBp:t,intronBp:n})}):null]})}},51862:(e,n,t)=>{var o=t(71600);n.Z=void 0;var s=o(t(80337)),r=t(80838),a=(0,s.default)((0,r.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings");n.Z=a}}]);
//# sourceMappingURL=2109.af863c1f.chunk.js.map